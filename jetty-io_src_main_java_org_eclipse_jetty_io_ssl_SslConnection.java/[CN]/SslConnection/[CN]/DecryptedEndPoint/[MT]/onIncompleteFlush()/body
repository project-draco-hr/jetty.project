{
  boolean flush=false;
synchronized (DecryptedEndPoint.this) {
    if (DEBUG)     LOG.debug("onIncompleteFlush {}",getEndPoint());
    if (BufferUtil.hasContent(_encryptedOutput)) {
      _cannotAcceptMoreAppDataToFlush=true;
      getEndPoint().write(_writeCallback,_encryptedOutput);
    }
 else     if (_sslEngine.getHandshakeStatus() == HandshakeStatus.NEED_UNWRAP) {
      _flushRequiresFillToProgress=true;
      SslConnection.this.fillInterested();
    }
 else {
      flush=true;
    }
  }
  if (flush) {
    if (isOutputShutdown()) {
      getWriteFlusher().onClose();
    }
 else {
      getWriteFlusher().completeWrite();
    }
  }
}
