{
switch (_state.get()) {
case NOT_COMPRESSING:
    superWrite(content,complete,callback);
  return;
case MIGHT_COMPRESS:
commit(content,complete,callback);
break;
case COMMITTING:
callback.failed(new WritePendingException());
break;
case COMPRESSING:
gzip(content,complete,callback);
break;
default :
callback.failed(new IllegalStateException("state=" + _state.get()));
break;
}
}
