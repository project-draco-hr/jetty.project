{
switch (_state.get()) {
case NOT_COMPRESSING:
    super.write(content,complete,callback);
  return;
case MIGHT_COMPRESS:
commit(content,complete,callback);
break;
case COMMITTING:
throw new WritePendingException();
case COMPRESSING:
gzip(content,complete,callback);
break;
case FINISHED:
throw new IllegalStateException();
}
}
