{
  fastCGIHeaders.put(FCGI.Headers.REMOTE_ADDR,(String)proxyRequest.getAttributes().get(REMOTE_ADDR_ATTRIBUTE));
  fastCGIHeaders.put(FCGI.Headers.REMOTE_PORT,(String)proxyRequest.getAttributes().get(REMOTE_PORT_ATTRIBUTE));
  fastCGIHeaders.put(FCGI.Headers.SERVER_NAME,(String)proxyRequest.getAttributes().get(SERVER_NAME_ATTRIBUTE));
  fastCGIHeaders.put(FCGI.Headers.SERVER_ADDR,(String)proxyRequest.getAttributes().get(SERVER_ADDR_ATTRIBUTE));
  fastCGIHeaders.put(FCGI.Headers.SERVER_PORT,(String)proxyRequest.getAttributes().get(SERVER_PORT_ATTRIBUTE));
  if (HttpScheme.HTTPS.is((String)proxyRequest.getAttributes().get(SCHEME_ATTRIBUTE)))   fastCGIHeaders.put(FCGI.Headers.HTTPS,"on");
  String root=fastCGIHeaders.get(FCGI.Headers.DOCUMENT_ROOT);
  String path=proxyRequest.getURI().getRawPath();
  Matcher matcher=scriptPattern.matcher(path);
  String scriptName=matcher.matches() ? matcher.group(1) : path;
  fastCGIHeaders.put(FCGI.Headers.SCRIPT_NAME,scriptName);
  fastCGIHeaders.put(FCGI.Headers.SCRIPT_FILENAME,root + scriptName);
}
