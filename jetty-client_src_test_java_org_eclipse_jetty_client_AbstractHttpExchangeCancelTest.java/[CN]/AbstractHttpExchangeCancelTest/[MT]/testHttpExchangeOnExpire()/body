{
  HttpClient httpClient=getHttpClient();
  httpClient.stop();
  httpClient.setTimeout(1000);
  httpClient.start();
  TestHttpExchange exchange=new TestHttpExchange();
  exchange.setAddress(newAddress());
  exchange.setURI("/?action=wait5000");
  long start=System.currentTimeMillis();
  httpClient.send(exchange);
  int status=exchange.waitForDone();
  long end=System.currentTimeMillis();
  assertTrue(HttpExchange.STATUS_EXPIRED == status || HttpExchange.STATUS_EXCEPTED == status);
  assertFalse(exchange.isResponseCompleted());
  assertTrue(end - start < 4000);
  assertTrue(exchange.isExpired());
  assertFalse(exchange.isFailed());
  assertFalse(exchange.isAssociated());
}
