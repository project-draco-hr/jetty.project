{
  if (scis == null || scis.isEmpty())   return parser;
  ServletContainerInitializerListener listener=new ServletContainerInitializerListener();
  listener.setWebAppContext(context);
  context.addEventListener(listener);
  ArrayList<ContainerInitializer> initializers=new ArrayList<ContainerInitializer>();
  context.setAttribute(CONTAINER_INITIALIZERS,initializers);
  for (  ServletContainerInitializer service : scis) {
    HandlesTypes annotation=service.getClass().getAnnotation(HandlesTypes.class);
    ContainerInitializer initializer=new ContainerInitializer();
    initializer.setTarget(service);
    initializers.add(initializer);
    if (annotation != null) {
      Class[] classes=annotation.value();
      if (classes != null) {
        initializer.setInterestedTypes(classes);
        if (parser == null)         parser=createAnnotationParser();
        if (context.getAttribute(CLASS_INHERITANCE_MAP) == null) {
          ClassInheritanceHandler classHandler=new ClassInheritanceHandler();
          context.setAttribute(CLASS_INHERITANCE_MAP,classHandler.getMap());
          parser.registerClassHandler(classHandler);
        }
        for (        Class c : classes) {
          if (c.isAnnotation()) {
            if (LOG.isDebugEnabled())             LOG.debug("Registering annotation handler for " + c.getName());
            parser.registerAnnotationHandler(c.getName(),new ContainerInitializerAnnotationHandler(initializer,c));
          }
        }
      }
 else       if (LOG.isDebugEnabled())       LOG.debug("No classes in HandlesTypes on initializer " + service.getClass());
    }
 else     if (LOG.isDebugEnabled())     LOG.debug("No annotation on initializer " + service.getClass());
  }
  return parser;
}
