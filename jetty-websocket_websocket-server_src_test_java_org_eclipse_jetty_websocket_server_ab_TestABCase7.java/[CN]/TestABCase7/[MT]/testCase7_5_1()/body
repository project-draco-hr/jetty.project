{
  ByteBuffer payload=ByteBuffer.allocate(256);
  BufferUtil.clearToFill(payload);
  payload.put((byte)0xE8);
  payload.put((byte)0x03);
  byte invalidUtf[]=Hex.asByteArray("CEBAE1BDB9CF83CEBCCEB5EDA080656469746564");
  payload.put(invalidUtf);
  BufferUtil.flipToFlush(payload,0);
  List<WebSocketFrame> send=new ArrayList<>();
  WebSocketFrame close=new WebSocketFrame();
  close.setPayload(payload);
  close.setOpCode(OpCode.CLOSE);
  send.add(close);
  List<WebSocketFrame> expect=new ArrayList<>();
  expect.add(new CloseInfo(StatusCode.PROTOCOL).asFrame());
  Fuzzer fuzzer=new Fuzzer(this);
  try {
    fuzzer.connect();
    fuzzer.setSendMode(Fuzzer.SendMode.BULK);
    fuzzer.send(send);
    fuzzer.expect(expect);
    fuzzer.expectNoMoreFrames();
  }
  finally {
    fuzzer.close();
  }
}
