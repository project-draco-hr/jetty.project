{
  Set<String> roles=new HashSet<String>();
  try {
    Set<String> existing=((ConstraintSecurityHandler)_wac.getSecurityHandler()).getRoles();
    roles.addAll(existing);
    if (values != null && values.size() == 1) {
      Value v=values.get(0);
      if (v instanceof SimpleValue) {
        roles.add((String)((SimpleValue)v).getValue());
      }
 else       if (v instanceof ListValue) {
        for (        Value vv : ((ListValue)v).getList()) {
          roles.add((String)((SimpleValue)vv).getValue());
        }
      }
    }
  }
 catch (  Exception e) {
    Log.warn(e);
  }
}
