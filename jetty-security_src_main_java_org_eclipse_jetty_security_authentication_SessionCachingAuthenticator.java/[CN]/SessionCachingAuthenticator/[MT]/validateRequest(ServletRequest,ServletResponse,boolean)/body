{
  HttpSession session=((HttpServletRequest)request).getSession(mandatory);
  if (session == null)   return Authentication.NOT_CHECKED;
  Authentication authentication=(Authentication)session.getAttribute(__J_AUTHENTICATED);
  if (authentication != null)   return authentication;
  authentication=_delegate.validateRequest(request,response,mandatory);
  if (authentication != null && authentication.isSuccess()) {
    Authentication cached=new FormAuthentication(_delegate,authentication.getUserIdentity());
    session.setAttribute(__J_AUTHENTICATED,cached);
  }
  return authentication;
}
