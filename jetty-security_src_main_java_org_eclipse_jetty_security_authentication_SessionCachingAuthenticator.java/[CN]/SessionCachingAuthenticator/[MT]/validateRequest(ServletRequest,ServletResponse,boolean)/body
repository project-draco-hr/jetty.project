{
  HttpSession session=((HttpServletRequest)request).getSession(mandatory);
  if (session == null)   return DefaultAuthentication.SUCCESS_UNAUTH_RESULTS;
  Authentication authentication=(Authentication)session.getAttribute(__J_AUTHENTICATED);
  if (authentication != null)   return authentication;
  authentication=_delegate.validateRequest(request,response,mandatory);
  if (authentication != null && authentication.getUserIdentity().getSubject() != null) {
    Authentication next=new DefaultAuthentication(Authentication.Status.SUCCESS,authentication.getAuthMethod(),authentication.getUserIdentity());
    session.setAttribute(__J_AUTHENTICATED,next);
  }
  return authentication;
}
