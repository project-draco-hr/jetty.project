{
  Assert.assertThat("Websocket URI scheme",destWebsocketURI.getScheme(),anyOf(is("ws"),is("wss")));
  this.destWebsocketURI=destWebsocketURI;
  String scheme="http";
  if (destWebsocketURI.getScheme().equals("wss")) {
    scheme="https";
  }
  this.destHttpURI=new URI(scheme,destWebsocketURI.getSchemeSpecificPart(),destWebsocketURI.getFragment());
  this.policy=policy;
  this.bufferPool=new StandardByteBufferPool(policy.getBufferSize());
  this.generator=new Generator(policy,bufferPool);
  this.parser=new Parser(policy);
  this.parseCount=new AtomicInteger(0);
  this.incomingFrames=new IncomingFramesCapture();
  this.extensionRegistry=new WebSocketExtensionRegistry(policy,bufferPool);
}
