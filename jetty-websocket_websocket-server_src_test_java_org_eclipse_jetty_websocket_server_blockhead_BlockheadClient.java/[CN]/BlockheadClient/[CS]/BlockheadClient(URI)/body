{
  Assert.assertThat("Websocket URI scheme",destWebsocketURI.getScheme(),anyOf(is("ws"),is("wss")));
  this.destWebsocketURI=destWebsocketURI;
  String scheme="http";
  if (destWebsocketURI.getScheme().equals("wss")) {
    scheme="https";
  }
  this.destHttpURI=new URI(scheme,destWebsocketURI.getSchemeSpecificPart(),destWebsocketURI.getFragment());
  policy=WebSocketPolicy.newClientPolicy();
  bufferPool=new StandardByteBufferPool(policy.getBufferSize());
  generator=new Generator(policy,bufferPool);
  parser=new Parser(policy);
  parseCount=new AtomicInteger(0);
  incomingFrameQueue=new IncomingFramesCapture();
  extensionRegistry=new WebSocketExtensionRegistry(policy,bufferPool);
}
