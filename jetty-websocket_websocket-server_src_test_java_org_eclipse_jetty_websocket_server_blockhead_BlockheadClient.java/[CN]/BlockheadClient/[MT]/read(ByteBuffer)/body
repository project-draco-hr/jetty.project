{
  if (eof) {
    throw new EOFException("Hit EOF");
  }
  int len=0;
  int b;
  while ((in.available() > 0) && (buf.remaining() > 0)) {
    b=in.read();
    if (b == (-1)) {
      eof=true;
      break;
    }
    buf.put((byte)b);
    len++;
  }
  return len;
}
