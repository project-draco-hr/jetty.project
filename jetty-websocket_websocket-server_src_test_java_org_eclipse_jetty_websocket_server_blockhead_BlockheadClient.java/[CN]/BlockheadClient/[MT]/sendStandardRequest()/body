{
  StringBuilder req=new StringBuilder();
  req.append("GET ");
  req.append(destHttpURI.getPath());
  if (StringUtil.isNotBlank(destHttpURI.getQuery())) {
    req.append('?').append(destHttpURI.getQuery());
  }
  req.append(" HTTP/1.1\r\n");
  req.append("Host: ").append(destHttpURI.getHost());
  if (destHttpURI.getPort() > 0) {
    req.append(':').append(destHttpURI.getPort());
  }
  req.append("\r\n");
  req.append("Upgrade: websocket\r\n");
  req.append("Connection: Upgrade\r\n");
  for (  String header : headers) {
    req.append(header);
  }
  req.append("Sec-WebSocket-Key: ").append(REQUEST_HASH_KEY).append("\r\n");
  req.append("Sec-WebSocket-Origin: ").append(destWebsocketURI.toASCIIString()).append("\r\n");
  if (StringUtil.isNotBlank(protocols)) {
    req.append("Sec-WebSocket-Protocol: ").append(protocols).append("\r\n");
  }
  for (  String xtension : extensions) {
    req.append("Sec-WebSocket-Extensions: ").append(xtension).append("\r\n");
  }
  req.append("Sec-WebSocket-Version: ").append(version).append("\r\n");
  req.append("\r\n");
  writeRaw(req.toString());
}
