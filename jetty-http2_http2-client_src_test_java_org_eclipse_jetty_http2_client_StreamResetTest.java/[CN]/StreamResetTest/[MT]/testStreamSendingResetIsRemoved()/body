{
  startServer(new ServerSessionListener.Adapter());
  Session client=newClient(new Session.Listener.Adapter());
  MetaData.Request request=newRequest("GET",new HttpFields());
  HeadersFrame requestFrame=new HeadersFrame(0,request,null,false);
  FuturePromise<Stream> promise=new FuturePromise<>();
  client.newStream(requestFrame,promise,new Stream.Listener.Adapter());
  Stream stream=promise.get(5,TimeUnit.SECONDS);
  ResetFrame resetFrame=new ResetFrame(stream.getId(),ErrorCodes.CANCEL_STREAM_ERROR);
  FutureCallback resetCallback=new FutureCallback();
  stream.getSession().reset(resetFrame,resetCallback);
  resetCallback.get(5,TimeUnit.SECONDS);
  Assert.assertEquals(0,client.getStreams().size());
}
