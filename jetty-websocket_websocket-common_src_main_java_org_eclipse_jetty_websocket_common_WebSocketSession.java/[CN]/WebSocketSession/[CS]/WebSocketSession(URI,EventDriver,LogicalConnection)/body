{
  if (requestURI == null) {
    throw new RuntimeException("Request URI cannot be null");
  }
  this.requestURI=requestURI;
  this.websocket=websocket;
  this.connection=connection;
  this.outgoingHandler=connection;
  this.incomingHandler=websocket;
  MultiMap<String> params=new MultiMap<>();
  String query=requestURI.getQuery();
  if (StringUtil.isNotBlank(query)) {
    UrlEncoded.decodeTo(query,params,StringUtil.__UTF8);
  }
  for (  String name : params.keySet()) {
    List<String> valueList=params.getValues(name);
    String valueArr[]=new String[valueList.size()];
    valueArr=valueList.toArray(valueArr);
    parameterMap.put(name,valueArr);
  }
}
