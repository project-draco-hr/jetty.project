{
  SSLSocketFactory factory=_context.getSocketFactory();
  SSLSocket socket=(SSLSocket)factory.createSocket();
  if (getWantClientAuth())   socket.setWantClientAuth(getWantClientAuth());
  if (getNeedClientAuth())   socket.setNeedClientAuth(getNeedClientAuth());
  socket.setEnabledCipherSuites(selectCipherSuites(socket.getEnabledCipherSuites(),socket.getSupportedCipherSuites()));
  socket.setEnabledProtocols(selectProtocols(socket.getEnabledProtocols(),socket.getSupportedProtocols()));
  return socket;
}
