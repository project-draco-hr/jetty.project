{
  if (LOG.isDebugEnabled())   LOG.debug("Customize {}",sslEngine);
  SSLParameters sslParams=sslEngine.getSSLParameters();
  sslParams.setEndpointIdentificationAlgorithm(_endpointIdentificationAlgorithm);
  sslParams.setUseCipherSuitesOrder(_useCipherSuitesOrder);
  if (!_certAliases.isEmpty() || !_certWilds.isEmpty()) {
    if (LOG.isDebugEnabled())     LOG.debug("Enable SNI matching {}",sslEngine);
    sslParams.setSNIMatchers(Collections.singletonList((SNIMatcher)new AliasSNIMatcher()));
  }
  if (getWantClientAuth())   sslEngine.setWantClientAuth(getWantClientAuth());
  if (getNeedClientAuth())   sslEngine.setNeedClientAuth(getNeedClientAuth());
  sslParams.setCipherSuites(_selectedCipherSuites);
  sslEngine.setEnabledCipherSuites(_selectedCipherSuites);
  sslEngine.setEnabledProtocols(_selectedProtocols);
  sslEngine.setSSLParameters(sslParams);
}
