{
  EndPoint endPoint=getEndPoint();
  while (true) {
    int filled=fill(endPoint,buffer);
    if (LOG.isDebugEnabled())     LOG.debug("Read {} bytes",filled);
    if (filled == 0) {
      return 0;
    }
 else     if (filled < 0) {
      session.onShutdown();
      return -1;
    }
 else {
      parser.parse(buffer);
    }
  }
}
