{
  if (constraintInfo == null) {
    return true;
  }
  RoleInfo roleInfo=(RoleInfo)constraintInfo;
  if (!roleInfo.isChecked()) {
    return true;
  }
  if (roleInfo.isAnyRole() && request.getAuthType() != null)   return true;
  String[] roles=roleInfo.getRoles();
  for (  String role : roles) {
    if (userIdentity.isUserInRole(role,null))     return true;
  }
  return false;
}
