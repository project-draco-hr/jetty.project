{
  if (x instanceof EofException) {
    LOG.warn("failed() - " + EofException.class);
  }
 else {
    LOG.warn("failed()",x);
  }
synchronized (queue) {
    state.set(FAILED);
    flushing=false;
    queue.fail(x);
  }
  failFrame(x);
}
