{
  super(endp,executor,EXECUTE_ONFILLABLE);
  this.policy=policy;
  this.bufferPool=bufferPool;
  this.generator=new Generator(policy,bufferPool);
  this.parser=new Parser(policy,bufferPool);
  this.scheduler=scheduler;
  this.extensions=new ArrayList<>();
  this.suspendToken=new AtomicBoolean(false);
  this.ioState=new IOState();
  this.ioState.addListener(this);
  this.writeBytes=new WriteBytesProvider(generator,new FlushCallback());
  this.setInputBufferSize(policy.getInputBufferSize());
}
