{
  List<ByteBuffer> buffers=null;
synchronized (writeBytes) {
    if (flushing) {
      return;
    }
    if (LOG.isDebugEnabled()) {
      LOG.debug(".flush() - flushing={} - writeBytes={}",flushing,writeBytes);
    }
    if (!isOpen()) {
      writeBytes.failAll(new WebSocketException("Connection closed"));
      return;
    }
    buffers=writeBytes.getByteBuffers();
    flushing=true;
  }
  write(buffers);
}
