{
  Stream receiverStream;
  DataInfoCallback dataInfoCallbackToFlush=null;
  DataInfoCallback dataInfoCallBackToQueue=new DataInfoCallback(dataInfo);
synchronized (queue) {
    queue.offer(dataInfoCallBackToQueue);
    receiverStream=this.receiverStream;
    if (receiverStream != null) {
      dataInfoCallbackToFlush=queue.peek();
      if (dataInfoCallbackToFlush.flushing) {
        if (LOG.isDebugEnabled())         LOG.debug("Queued {}, flushing {}, queue size {}",dataInfo,dataInfoCallbackToFlush.dataInfo,queue.size());
        receiverStream=null;
      }
 else {
        dataInfoCallbackToFlush.flushing=true;
        if (LOG.isDebugEnabled())         LOG.debug("Queued {}, queue size {}",dataInfo,queue.size());
      }
    }
 else {
      if (LOG.isDebugEnabled())       LOG.debug("Queued {}, SYN incomplete, queue size {}",dataInfo,queue.size());
    }
  }
  if (receiverStream != null)   flush(receiverStream,dataInfoCallbackToFlush);
}
