{
  LOG.debug("P -> S {} from {} to {}",info,clientStream,serverStream);
  serverStream.setAttribute(CLIENT_STREAM_ATTRIBUTE,clientStream);
  DataInfoHandler dataInfoHandler;
synchronized (queue) {
    this.serverStream=serverStream;
    dataInfoHandler=queue.peek();
    if (dataInfoHandler != null) {
      if (dataInfoHandler.flushing) {
        LOG.debug("SYN completed, flushing {}, queue size {}",dataInfoHandler.dataInfo,queue.size());
        dataInfoHandler=null;
      }
 else {
        dataInfoHandler.flushing=true;
        LOG.debug("SYN completed, queue size {}",queue.size());
      }
    }
 else {
      LOG.debug("SYN completed, queue empty");
    }
  }
  if (dataInfoHandler != null)   flush(serverStream,dataInfoHandler);
}
