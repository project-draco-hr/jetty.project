{
  int length=output.remaining();
  if (buffer.remaining() > length) {
    int limit=buffer.limit();
    buffer.limit(buffer.position() + length);
    output.put(buffer);
    buffer.limit(limit);
  }
 else {
    length=buffer.remaining();
    output.put(buffer);
  }
  setConsumed(!buffer.hasRemaining());
  return length;
}
