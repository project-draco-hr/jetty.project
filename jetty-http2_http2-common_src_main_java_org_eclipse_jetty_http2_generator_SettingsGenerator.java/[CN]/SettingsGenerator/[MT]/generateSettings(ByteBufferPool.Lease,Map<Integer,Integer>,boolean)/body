{
  int entryLength=1 + 4;
  int length=entryLength * settings.size();
  if (length > Frame.MAX_LENGTH)   throw new IllegalArgumentException("Invalid settings, too big");
  ByteBuffer header=generateHeader(lease,FrameType.SETTINGS,length,reply ? Flag.ACK : Flag.NONE,0);
  for (  Map.Entry<Integer,Integer> entry : settings.entrySet()) {
    header.put(entry.getKey().byteValue());
    header.putInt(entry.getValue());
  }
  BufferUtil.flipToFlush(header,0);
  lease.append(header,true);
}
