{
  server=new Server();
  ServerConnector connector=new ServerConnector(server);
  server.addConnector(connector);
  ServletContextHandler context=new ServletContextHandler();
  context.setContextPath("/");
  DefaultServlet servlet=new DefaultServlet();
  ServletHolder holder=new ServletHolder(servlet);
  holder.setInitParameter("resourceBase",MavenTestingUtils.getTestResourcesDir().getAbsolutePath());
  context.addServlet(holder,"/");
  FilterHolder filter=context.addFilter(GzipFilter.class,"/*",EnumSet.of(DispatcherType.REQUEST));
  filter.setInitParameter("mimeTypes","text/plain");
  server.setHandler(context);
  server.start();
  String host=connector.getHost();
  if (host == null) {
    host="localhost";
  }
  int port=connector.getLocalPort();
  serverUri=new URI(String.format("ws://%s:%d/",host,port));
}
