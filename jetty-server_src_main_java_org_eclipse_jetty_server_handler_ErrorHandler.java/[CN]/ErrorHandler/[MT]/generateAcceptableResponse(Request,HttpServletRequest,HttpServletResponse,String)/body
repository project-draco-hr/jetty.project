{
switch (mimeType) {
case "text/html":
case "text/html;charset=iso-8859-1":
case "*/*":
{
      baseRequest.setHandled(true);
      response.setContentType(MimeTypes.Type.TEXT_HTML_8859_1.asString());
      if (_cacheControl != null)       response.setHeader(HttpHeader.CACHE_CONTROL.asString(),_cacheControl);
      ByteArrayISO8859Writer writer=new ByteArrayISO8859Writer(4096);
      String reason=(response instanceof Response) ? ((Response)response).getReason() : null;
      handleErrorPage(request,writer,response.getStatus(),reason);
      writer.flush();
      response.setContentLength(writer.size());
      writer.writeTo(response.getOutputStream());
      writer.destroy();
      return;
    }
case "text/html;charset=utf-8":
{
    baseRequest.setHandled(true);
    response.setContentType(MimeTypes.Type.TEXT_HTML_UTF_8.asString());
    if (_cacheControl != null)     response.setHeader(HttpHeader.CACHE_CONTROL.asString(),_cacheControl);
    String reason=(response instanceof Response) ? ((Response)response).getReason() : null;
    handleErrorPage(request,response.getWriter(),response.getStatus(),reason);
    return;
  }
}
if (MimeTypes.Type.TEXT_HTML.is(MimeTypes.getContentTypeWithoutCharset(mimeType))) {
baseRequest.setHandled(true);
response.setContentType(mimeType);
if (_cacheControl != null) response.setHeader(HttpHeader.CACHE_CONTROL.asString(),_cacheControl);
String reason=(response instanceof Response) ? ((Response)response).getReason() : null;
handleErrorPage(request,response.getWriter(),response.getStatus(),reason);
return;
}
}
