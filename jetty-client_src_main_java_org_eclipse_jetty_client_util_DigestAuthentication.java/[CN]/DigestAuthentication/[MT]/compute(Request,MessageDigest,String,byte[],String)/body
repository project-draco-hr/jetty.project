{
  Charset charset=Charset.forName("ISO-8859-1");
  String A1=user + ":" + realm+ ":"+ password;
  String hashA1=TypeUtil.toHexString(digester.digest(A1.getBytes(charset)));
  String A2=request.method().asString() + ":" + request.uri();
  if ("auth-int".equals(qop))   A2+=":" + TypeUtil.toHexString(digester.digest(content));
  String hashA2=TypeUtil.toHexString(digester.digest(A2.getBytes(charset)));
  String A3;
  if (qop != null)   A3=hashA1 + ":" + serverNonce+ ":"+ nonceCount+ ":"+ clientNonce+ ":"+ qop+ ":"+ hashA2;
 else   A3=hashA1 + ":" + serverNonce+ ":"+ hashA2;
  return TypeUtil.toHexString(digester.digest(A3.getBytes(charset)));
}
