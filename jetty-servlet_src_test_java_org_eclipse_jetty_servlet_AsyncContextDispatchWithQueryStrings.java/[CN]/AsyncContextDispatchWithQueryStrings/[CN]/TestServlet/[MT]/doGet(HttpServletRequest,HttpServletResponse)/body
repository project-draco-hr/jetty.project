{
  String path=request.getRequestURI();
  String queryString=request.getQueryString();
  if ("/initialCall".equals(path)) {
    HttpChannelState continuation=(HttpChannelState)ContinuationSupport.getContinuation(request);
    continuation.suspend();
    continuation.dispatch("/firstDispatchWithNewQueryString?newQueryString=initialValue");
    assertEquals("initialParam=right",queryString);
  }
 else   if ("/firstDispatchWithNewQueryString".equals(path)) {
    HttpChannelState continuation=(HttpChannelState)ContinuationSupport.getContinuation(request);
    continuation.suspend();
    continuation.dispatch("/secondDispatchNewValueForExistingQueryString?newQueryString=newValue");
    assertEquals("newQueryString=initialValue&initialParam=right",queryString);
  }
 else {
    response.setContentType("text/html");
    response.setStatus(HttpServletResponse.SC_OK);
    response.getWriter().println("<h1>woohhooooo</h1>");
    assertEquals("newQueryString=newValue&initialParam=right",queryString);
  }
}
