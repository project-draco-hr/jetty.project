{
  SearchControls ctls=new SearchControls();
  ctls.setCountLimit(1);
  ctls.setDerefLinkFlag(true);
  ctls.setSearchScope(SearchControls.SUBTREE_SCOPE);
  String filter="(&(objectClass={0})({1}={2}))";
  LOG.info("Searching for users with filter: \'" + filter + "\'"+ " from base dn: "+ _userBaseDn);
  Object[] filterArguments=new Object[]{_userObjectClass,_userIdAttribute,username};
  NamingEnumeration<SearchResult> results=_rootContext.search(_userBaseDn,filter,filterArguments,ctls);
  LOG.info("Found user?: " + results.hasMoreElements());
  if (!results.hasMoreElements()) {
    throw new LoginException("User not found.");
  }
  return (SearchResult)results.nextElement();
}
