{
  UserIdentity user=_users.get(username);
  if (user == null)   user=loadUser(username);
  if (user != null) {
    UserPrincipal principal=(UserPrincipal)user.getUserPrincipal();
    if (principal.authenticate(credentials))     return user;
  }
  return null;
}
