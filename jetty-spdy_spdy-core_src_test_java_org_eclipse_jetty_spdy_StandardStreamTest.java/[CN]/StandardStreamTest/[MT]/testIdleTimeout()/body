{
  final CountDownLatch onFailCalledLatch=new CountDownLatch(1);
  IStream stream=new StandardStream(1,(byte)0,session,null,scheduler,null);
  stream.setIdleTimeout(500);
  stream.setStreamFrameListener(new StreamFrameListener.Adapter(){
    @Override public void onFailure(    Stream stream,    Throwable x){
      assertThat("exception is a TimeoutException",x,is(instanceOf(TimeoutException.class)));
      onFailCalledLatch.countDown();
    }
  }
);
  stream.process(new StringDataInfo("string",false));
  Thread.sleep(1000);
  assertThat("onFailure has been called",onFailCalledLatch.await(5,TimeUnit.SECONDS),is(true));
}
