{
  IStream stream=new StandardStream(synStreamFrame.getStreamId(),synStreamFrame.getPriority(),session,null,null);
  stream.updateCloseState(true,true);
  stream.updateCloseState(true,false);
  assertThat("stream expected to be closed",stream.isClosed(),is(true));
  final CountDownLatch failedLatch=new CountDownLatch(1);
  stream.syn(new SynInfo(1,TimeUnit.SECONDS,new Fields(),false,(byte)0),new Promise.Adapter<Stream>(){
    @Override public void failed(    Throwable x){
      failedLatch.countDown();
    }
  }
);
  assertThat("PushStream creation failed",failedLatch.getCount(),equalTo(0L));
}
