{
  _server=new Server();
  _connector=new SelectChannelConnector();
  _server.addConnector(_connector);
  WebSocketHandler wsHandler=new WebSocketHandler(){
    public WebSocket doWebSocketConnect(    HttpServletRequest request,    String protocol){
      _serverWebSocket=new TestWebSocket();
      _serverWebSocket.onConnect=("onConnect".equals(protocol));
      _serverWebSocket.echo=("echo".equals(protocol));
      _serverWebSocket.aggregate=("aggregate".equals(protocol));
      return _serverWebSocket;
    }
  }
;
  wsHandler.setBufferSize(8192);
  wsHandler.setMaxIdleTime(1000);
  wsHandler.setHandler(new DefaultHandler());
  _server.setHandler(wsHandler);
  _server.start();
}
