{
  byte invalid[]=Hex.asByteArray("CEBAE1BDB9CF83CEBCCEB5EDA080656469746564");
  List<WebSocketFrame> send=new ArrayList<>();
  int len=invalid.length;
  byte opcode=OpCode.TEXT;
  byte mini[];
  for (int i=0; i < len; i++) {
    WebSocketFrame frame=new WebSocketFrame(opcode);
    mini=new byte[1];
    mini[0]=invalid[i];
    frame.setPayload(mini);
    frame.setFin(!(i < (len - 1)));
    send.add(frame);
  }
  send.add(new CloseInfo(StatusCode.NORMAL).asFrame());
  List<WebSocketFrame> expect=new ArrayList<>();
  expect.add(new CloseInfo(StatusCode.BAD_PAYLOAD).asFrame());
  Fuzzer fuzzer=new Fuzzer(this);
  try {
    fuzzer.connect();
    fuzzer.setSendMode(Fuzzer.SendMode.BULK);
    fuzzer.send(send);
    fuzzer.expect(expect);
  }
  finally {
    fuzzer.close();
  }
}
