{
  boolean head=this.head=info.isHead();
  boolean shutdown=this.shutdown=info.getHttpFields().contains(HttpHeader.CONNECTION,HttpHeaderValue.CLOSE.asString());
  if (head) {
    if (lastContent) {
      Generator.Result headersResult=generator.generateResponseHeaders(request,info.getStatus(),info.getReason(),info.getHttpFields(),Callback.Adapter.INSTANCE);
      Generator.Result contentResult=generator.generateResponseContent(request,BufferUtil.EMPTY_BUFFER,lastContent,aborted,callback);
      flusher.flush(headersResult,contentResult);
    }
 else {
      Generator.Result headersResult=generator.generateResponseHeaders(request,info.getStatus(),info.getReason(),info.getHttpFields(),callback);
      flusher.flush(headersResult);
    }
  }
 else {
    Generator.Result headersResult=generator.generateResponseHeaders(request,info.getStatus(),info.getReason(),info.getHttpFields(),Callback.Adapter.INSTANCE);
    Generator.Result contentResult=generator.generateResponseContent(request,content,lastContent,aborted,callback);
    flusher.flush(headersResult,contentResult);
  }
  if (lastContent && shutdown)   flusher.shutdown();
}
