{
  if (head) {
    if (lastContent) {
      Generator.Result result=generator.generateResponseContent(request,BufferUtil.EMPTY_BUFFER,lastContent,aborted,callback);
      flusher.flush(result);
    }
 else {
      callback.succeeded();
    }
  }
 else {
    Generator.Result result=generator.generateResponseContent(request,content,lastContent,aborted,callback);
    flusher.flush(result);
  }
  if (lastContent && shutdown)   flusher.shutdown();
}
