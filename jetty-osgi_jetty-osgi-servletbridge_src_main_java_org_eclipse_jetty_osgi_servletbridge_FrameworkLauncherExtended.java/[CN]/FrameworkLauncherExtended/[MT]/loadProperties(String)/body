{
  Properties props=super.loadProperties(resource);
  if (resource.equals(resourceBase + LAUNCH_INI) && deployedInPlace) {
    String osgiInstall=props.getProperty(OSGI_INSTALL_AREA);
    if (osgiInstall == null) {
      props.put(OSGI_INSTALL_AREA,getPlatformDirectory().getAbsolutePath());
    }
    String osgiFramework=props.getProperty(OSGI_FRAMEWORK);
    if (osgiFramework == null && getPlatformDirectory() != null) {
      File osgiFrameworkF=findOsgiFramework(getPlatformDirectory());
      props.put(OSGI_FRAMEWORK,osgiFrameworkF.getAbsoluteFile().getAbsolutePath());
    }
    String jettyHome=System.getProperty("jetty.home");
    if (jettyHome == null) {
      System.setProperty("jetty.home",getPlatformDirectory().getAbsolutePath());
    }
    String etcJettyXml=System.getProperty("jetty.etc.config.urls");
    if (etcJettyXml == null && new File(jettyHome,"etc/jetty-osgi-nested.xml").exists()) {
      System.setProperty("jetty.etc.config.urls","etc/jetty-osgi-nested.xml");
    }
    System.setProperty("java.naming.factory.initial","org.eclipse.jetty.jndi.InitialContextFactory");
    System.setProperty("java.naming.factory.url.pkgs","org.eclipse.jetty.jndi");
  }
  return props;
}
