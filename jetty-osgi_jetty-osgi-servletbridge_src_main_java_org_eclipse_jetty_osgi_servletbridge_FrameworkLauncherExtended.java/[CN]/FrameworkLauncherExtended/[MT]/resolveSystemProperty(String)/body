{
  int ind=value.indexOf("${");
  if (ind == -1) {
    return value;
  }
  int ind2=value.indexOf('}',ind);
  if (ind2 == -1) {
    return value;
  }
  String sysprop=value.substring(ind + 2,ind2);
  String defaultValue=null;
  int comma=sysprop.indexOf(',');
  if (comma != -1 && comma + 1 != sysprop.length()) {
    defaultValue=sysprop.substring(comma + 1);
    defaultValue=resolveSystemProperty(defaultValue);
    sysprop=sysprop.substring(0,comma);
  }
 else {
    defaultValue="${" + sysprop + "}";
  }
  String v=System.getProperty(sysprop);
  String reminder=value.length() > ind2 + 1 ? value.substring(ind2 + 1) : "";
  reminder=resolveSystemProperty(reminder);
  if (v != null) {
    return value.substring(0,ind) + v + reminder;
  }
 else {
    return value.substring(0,ind) + defaultValue + reminder;
  }
}
