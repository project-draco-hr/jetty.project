{
  if (req.hasSubProtocol("fastclose")) {
    closeSocket=new FastCloseSocket();
    return closeSocket;
  }
  if (req.hasSubProtocol("fastfail")) {
    closeSocket=new FastFailSocket();
    return closeSocket;
  }
  return new RFCSocket();
}
