{
  try {
    int windowSize=stream == null ? getWindowSize() : stream.getWindowSize();
    int frameLength=frame.getFlowControlledLength();
    if (frameLength > 0)     this.length=Math.min(frameLength,windowSize);
    generator.generate(lease,frame,windowSize);
    LOG.debug("Generated {}, windowSize={}",frame,windowSize);
  }
 catch (  Throwable x) {
    LOG.debug("Frame generation failure",x);
    failed(x);
  }
}
