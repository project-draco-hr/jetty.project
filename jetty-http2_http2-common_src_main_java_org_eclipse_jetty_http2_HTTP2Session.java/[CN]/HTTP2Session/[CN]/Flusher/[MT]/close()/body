{
  Queue<FlusherEntry> queued;
synchronized (queue) {
    closed=true;
    queued=new ArrayDeque<>(queue);
  }
  while (true) {
    FlusherEntry item=queued.poll();
    if (item == null)     break;
    closed(item);
  }
}
