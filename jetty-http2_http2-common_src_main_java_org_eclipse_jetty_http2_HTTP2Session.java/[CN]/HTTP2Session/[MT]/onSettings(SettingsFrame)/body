{
  if (LOG.isDebugEnabled())   LOG.debug("Received {}",frame);
  if (frame.isReply())   return false;
  Map<Integer,Integer> settings=frame.getSettings();
  if (settings.containsKey(SettingsFrame.HEADER_TABLE_SIZE)) {
    int headerTableSize=settings.get(SettingsFrame.HEADER_TABLE_SIZE);
    if (LOG.isDebugEnabled())     LOG.debug("Updated HPACK header table size to {}",headerTableSize);
    generator.setHeaderTableSize(headerTableSize);
  }
  if (settings.containsKey(SettingsFrame.MAX_CONCURRENT_STREAMS)) {
    maxStreamCount=settings.get(SettingsFrame.MAX_CONCURRENT_STREAMS);
    if (LOG.isDebugEnabled())     LOG.debug("Updated max concurrent streams to {}",maxStreamCount);
  }
  if (settings.containsKey(SettingsFrame.INITIAL_WINDOW_SIZE)) {
    int windowSize=settings.get(SettingsFrame.INITIAL_WINDOW_SIZE);
    flowControl.updateInitialWindowSize(this,windowSize);
  }
  if (settings.containsKey(SettingsFrame.MAX_FRAME_SIZE)) {
    int maxFrameSize=settings.get(SettingsFrame.MAX_FRAME_SIZE);
    if (maxFrameSize < Frame.DEFAULT_MAX_LENGTH || maxFrameSize > Frame.MAX_MAX_LENGTH) {
      onConnectionFailure(ErrorCodes.PROTOCOL_ERROR,"invalid_settings_max_frame_size");
      return false;
    }
    if (LOG.isDebugEnabled())     LOG.debug("Updated max frame size to {}",maxFrameSize);
    generator.setMaxFrameSize(maxFrameSize);
  }
  notifySettings(this,frame);
  SettingsFrame reply=new SettingsFrame(Collections.<Integer,Integer>emptyMap(),true);
  settings(reply,disconnectOnFailure());
  return false;
}
