{
  HttpFields fields=_connection.getRequestFields();
  fields.add("User-Agent","Mozilla/4.0 (compatible; MSIE 5.0; Windows NT 6.0)");
  String result=_rule.matchAndApply(_request.getRequestURI(),_request,_response);
  assertEquals(_request.getRequestURI(),result);
  assertEquals(HttpHeaderValues.CLOSE,_response.getHeader(HttpHeaders.CONNECTION));
  fields.add("User-Agent","Mozilla/4.0 (compatible; MSIE 5.01; Windows NT 6.0)");
  result=_rule.matchAndApply(_request.getRequestURI(),_request,_response);
  assertEquals(_request.getRequestURI(),result);
  assertEquals(HttpHeaderValues.CLOSE,_response.getHeader(HttpHeaders.CONNECTION));
  fields.add("User-Agent","Mozilla/4.0 (compatible; MSIE 5.5; Windows NT 6.0)");
  result=_rule.matchAndApply(_request.getRequestURI(),_request,_response);
  assertEquals(_request.getRequestURI(),result);
  assertEquals(HttpHeaderValues.CLOSE,_response.getHeader(HttpHeaders.CONNECTION));
}
