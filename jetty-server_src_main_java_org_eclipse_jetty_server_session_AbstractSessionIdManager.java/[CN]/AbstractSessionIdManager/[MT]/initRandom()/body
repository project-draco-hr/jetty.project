{
  if (_random == null) {
    try {
      _random=SecureRandom.getInstance(SESSION_ID_RANDOM_ALGORITHM);
    }
 catch (    NoSuchAlgorithmException e) {
      try {
        _random=SecureRandom.getInstance(SESSION_ID_RANDOM_ALGORITHM_ALT);
        _weakRandom=false;
      }
 catch (      NoSuchAlgorithmException e_alt) {
        Log.warn("Could not generate SecureRandom for session-id randomness",e);
        _random=new Random();
        _weakRandom=true;
      }
    }
  }
  _random.setSeed(_random.nextLong() ^ System.currentTimeMillis() ^ hashCode()^ Runtime.getRuntime().freeMemory());
}
