{
  sendMainRequestAndCSSRequest();
  final CountDownLatch pushDataLatch=new CountDownLatch(1);
  final CountDownLatch pushSynHeadersValid=new CountDownLatch(1);
  Session session=startClient(version,serverAddress,new SessionFrameListener.Adapter(){
    @Override public StreamFrameListener onSyn(    Stream stream,    SynInfo synInfo){
      validateHeaders(synInfo.getHeaders(),pushSynHeadersValid);
      assertThat("Stream is unidirectional",stream.isUnidirectional(),is(true));
      assertThat("URI header ends with css",synInfo.getHeaders().get(HTTPSPDYHeader.URI.name(version)).value().endsWith("" + ".css"),is(true));
      stream.getSession().rst(new RstInfo(stream.getId(),StreamStatus.REFUSED_STREAM));
      return new StreamFrameListener.Adapter(){
        @Override public void onData(        Stream stream,        DataInfo dataInfo){
          dataInfo.consume(dataInfo.length());
          pushDataLatch.countDown();
        }
      }
;
    }
  }
);
  sendRequest(session,mainRequestHeaders);
  assertThat("No push data is received",pushDataLatch.await(1,TimeUnit.SECONDS),is(false));
  assertThat("Push syn headers valid",pushSynHeadersValid.await(5,TimeUnit.SECONDS),is(true));
  sendRequest(session,associatedCSSRequestHeaders);
}
