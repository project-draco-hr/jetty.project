{
  XmlConfiguration last=null;
  Object[] obj=new Object[this.xmlConfigurations.size()];
  for (int i=0; i < this.xmlConfigurations.size(); i++) {
    URL configURL=this.xmlConfigurations.get(i);
    XmlConfiguration configuration=new XmlConfiguration(configURL);
    if (last != null) {
      configuration.getIdMap().putAll(last.getIdMap());
    }
    configuration.setProperties(properties);
    obj[i]=configuration.configure();
    last=configuration;
  }
  Server foundServer=null;
  int serverCount=0;
  for (int i=0; i < this.xmlConfigurations.size(); i++) {
    if (obj[i] instanceof Server) {
      if (obj[i].equals(foundServer)) {
        break;
      }
      foundServer=(Server)obj[i];
      serverCount++;
    }
  }
  if (serverCount <= 0) {
    throw new Exception("Load failed to configure a " + Server.class.getName());
  }
  Assert.assertEquals("Server load count",1,serverCount);
  this.server=foundServer;
}
