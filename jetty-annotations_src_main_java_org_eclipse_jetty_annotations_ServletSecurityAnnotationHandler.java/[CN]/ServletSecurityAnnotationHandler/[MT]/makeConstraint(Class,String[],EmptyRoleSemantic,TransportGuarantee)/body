{
  Constraint constraint=new Constraint();
  if (rolesAllowed == null || rolesAllowed.length == 0) {
    if (permitOrDeny.equals(EmptyRoleSemantic.DENY)) {
      constraint.setName(servlet.getName() + "-Deny");
      constraint.setAuthenticate(true);
    }
 else {
      constraint.setAuthenticate(false);
      constraint.setName(servlet.getName() + "-Permit");
    }
  }
 else {
    constraint.setAuthenticate(true);
    constraint.setRoles(rolesAllowed);
    constraint.setName(servlet.getName() + "-RolesAllowed");
  }
  constraint.setDataConstraint((transport.equals(TransportGuarantee.CONFIDENTIAL) ? Constraint.DC_CONFIDENTIAL : Constraint.DC_NONE));
  return constraint;
}
