{
  SSLEngine engine=null;
  try {
    engine=_sslContextFactory.getSslContext().createSSLEngine();
    engine.setUseClientMode(false);
    if (_sslContextFactory.getWantClientAuth())     engine.setWantClientAuth(_sslContextFactory.getWantClientAuth());
    if (_sslContextFactory.getNeedClientAuth())     engine.setNeedClientAuth(_sslContextFactory.getNeedClientAuth());
    engine.setEnabledCipherSuites(_sslContextFactory.selectCipherSuites(engine.getEnabledCipherSuites(),engine.getSupportedCipherSuites()));
  }
 catch (  Exception e) {
    Log.warn("Error creating sslEngine -- closing this connector",e);
    close();
    throw new IllegalStateException(e);
  }
  return engine;
}
