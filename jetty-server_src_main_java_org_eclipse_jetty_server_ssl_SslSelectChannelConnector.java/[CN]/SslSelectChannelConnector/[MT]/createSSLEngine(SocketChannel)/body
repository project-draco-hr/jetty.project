{
  SSLEngine engine;
  if (channel != null) {
    String peerHost=channel.socket().getInetAddress().getHostAddress();
    int peerPort=channel.socket().getPort();
    engine=_sslContextFactory.newSslEngine(peerHost,peerPort);
  }
 else {
    engine=_sslContextFactory.newSslEngine();
  }
  engine.setUseClientMode(false);
  return engine;
}
