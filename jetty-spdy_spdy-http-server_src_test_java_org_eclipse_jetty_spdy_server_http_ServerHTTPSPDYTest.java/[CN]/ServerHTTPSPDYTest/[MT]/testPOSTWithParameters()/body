{
  final String path="/foo";
  final String data="a=1&b=2";
  final CountDownLatch handlerLatch=new CountDownLatch(1);
  Session session=startClient(version,startHTTPServer(version,new AbstractHandler(){
    @Override public void handle(    String target,    Request request,    HttpServletRequest httpRequest,    HttpServletResponse httpResponse) throws IOException, ServletException {
      request.setHandled(true);
      Assert.assertEquals("POST",httpRequest.getMethod());
      Assert.assertEquals("1",httpRequest.getParameter("a"));
      Assert.assertEquals("2",httpRequest.getParameter("b"));
      Assert.assertNotNull(httpRequest.getRemoteHost());
      Assert.assertNotNull(httpRequest.getRemotePort());
      Assert.assertNotNull(httpRequest.getRemoteAddr());
      Assert.assertNotNull(httpRequest.getLocalPort());
      Assert.assertNotNull(httpRequest.getLocalName());
      Assert.assertNotNull(httpRequest.getLocalAddr());
      Assert.assertNotNull(httpRequest.getServerPort());
      Assert.assertNotNull(httpRequest.getServerName());
      handlerLatch.countDown();
    }
  }
),null);
  Fields headers=SPDYTestUtils.createHeaders("localhost",connector.getPort(),version,"POST",path);
  headers.put("content-type","application/x-www-form-urlencoded");
  final CountDownLatch replyLatch=new CountDownLatch(1);
  Stream stream=session.syn(new SynInfo(5,TimeUnit.SECONDS,headers,false,(byte)0),new StreamFrameListener.Adapter(){
    @Override public void onReply(    Stream stream,    ReplyInfo replyInfo){
      Assert.assertTrue(replyInfo.isClose());
      Fields replyHeaders=replyInfo.getHeaders();
      Assert.assertTrue(replyHeaders.get(HTTPSPDYHeader.STATUS.name(version)).value().contains("200"));
      replyLatch.countDown();
    }
  }
);
  stream.data(new StringDataInfo(data,true));
  Assert.assertTrue(handlerLatch.await(5,TimeUnit.SECONDS));
  Assert.assertTrue(replyLatch.await(5,TimeUnit.SECONDS));
}
