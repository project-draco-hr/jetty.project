{
  if (_closed)   throw new IOException("CLOSED");
  if (_growOutput && buffer.remaining() > _out.remaining()) {
    _out.compact();
    if (buffer.remaining() > _out.remaining()) {
      ByteBuffer n=ByteBuffer.allocate(_out.capacity() + buffer.remaining() * 2);
      n.put(_out);
      _out=n;
    }
  }
  int put=buffer.remaining();
  _out.put(buffer);
  return put;
}
