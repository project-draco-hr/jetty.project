{
  if (_closed)   throw new IOException("CLOSED");
  int flushed=0;
  if (header != null && header.remaining() > 0)   flushed=flush(header);
  if (header == null || header.remaining() == 0) {
    if (buffer != null && buffer.remaining() > 0)     flushed+=flush(buffer);
  }
  return flushed;
}
