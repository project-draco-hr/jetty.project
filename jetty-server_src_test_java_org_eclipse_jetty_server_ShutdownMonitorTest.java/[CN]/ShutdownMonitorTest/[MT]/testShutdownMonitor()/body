{
  ShutdownMonitor.getInstance().setPort(0);
  ShutdownMonitor.getInstance().setExitVm(false);
  ShutdownMonitor.getInstance().start();
  String key=ShutdownMonitor.getInstance().getKey();
  int port=ShutdownMonitor.getInstance().getPort();
  ShutdownMonitor.getInstance().start();
  stop("stop",port,key,true);
  assertTrue(!ShutdownMonitor.getInstance().isAlive());
  ShutdownMonitor.getInstance().setPort(0);
  ShutdownMonitor.getInstance().setKey("foo");
  ShutdownMonitor.getInstance().start();
  key=ShutdownMonitor.getInstance().getKey();
  port=ShutdownMonitor.getInstance().getPort();
  assertTrue(ShutdownMonitor.getInstance().isAlive());
  stop("stop",port,key,true);
  assertTrue(!ShutdownMonitor.getInstance().isAlive());
}
