{
  try {
    if (LOG.isDebugEnabled())     LOG.debug("Parsing {}",buffer);
    while (true) {
switch (state) {
case PREFACE:
{
          if (!prefaceParser.parse(buffer))           return false;
          if (onPreface())           return true;
          state=State.FRAMES;
          break;
        }
case FRAMES:
{
        return super.parse(buffer);
      }
default :
{
      throw new IllegalStateException();
    }
}
}
}
 catch (Throwable x) {
LOG.debug(x);
notifyConnectionFailure(ErrorCodes.PROTOCOL_ERROR,"parser_error");
return false;
}
}
