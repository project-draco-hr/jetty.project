{
  C connection=this.connection=(C)result;
  if (connect.compareAndSet(ConnectState.CONNECTING,ConnectState.CONNECTED)) {
    process(connection);
  }
 else {
    connection.close();
    failed(new IllegalStateException("Invalid connection state " + connect));
  }
}
