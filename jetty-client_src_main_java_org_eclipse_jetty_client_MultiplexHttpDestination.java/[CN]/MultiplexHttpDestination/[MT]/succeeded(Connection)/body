{
  C connection=this.connection=(C)result;
  if (connect.compareAndSet(ConnectState.CONNECTING,ConnectState.CONNECTED)) {
    process(connection,true);
  }
 else {
    connection.close();
    failed(new IllegalStateException());
  }
}
