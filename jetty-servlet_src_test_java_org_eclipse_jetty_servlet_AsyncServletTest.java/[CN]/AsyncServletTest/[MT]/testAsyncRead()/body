{
  _expectedLogs=2;
  String header="GET /ctx/path/info?start=2000&dispatch=1500 HTTP/1.1\r\n" + "Host: localhost\r\n" + "Content-Length: 10\r\n"+ "\r\n";
  String body="12345678\r\n";
  String close="GET /ctx/path/info HTTP/1.1\r\n" + "Host: localhost\r\n" + "Connection: close\r\n"+ "\r\n";
  try (Socket socket=new Socket("localhost",_port)){
    socket.setSoTimeout(10000);
    socket.getOutputStream().write(header.getBytes(StandardCharsets.ISO_8859_1));
    Thread.sleep(500);
    socket.getOutputStream().write(body.getBytes(StandardCharsets.ISO_8859_1),0,2);
    Thread.sleep(500);
    socket.getOutputStream().write(body.getBytes(StandardCharsets.ISO_8859_1),2,8);
    socket.getOutputStream().write(close.getBytes(StandardCharsets.ISO_8859_1));
    String response=IO.toString(socket.getInputStream());
    assertThat(response,startsWith("HTTP/1.1 200 OK"));
    assertThat(__history,contains("REQUEST /ctx/path/info","initial","start","async-read=10","dispatch","ASYNC /ctx/path/info","!initial","onComplete"));
  }
 }
