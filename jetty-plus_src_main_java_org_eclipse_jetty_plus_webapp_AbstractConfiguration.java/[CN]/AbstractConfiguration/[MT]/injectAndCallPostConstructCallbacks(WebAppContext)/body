{
  InjectionCollection injections=(InjectionCollection)context.getAttribute(InjectionCollection.INJECTION_COLLECTION);
  RunAsCollection runAsCollection=(RunAsCollection)context.getAttribute(RunAsCollection.RUNAS_COLLECTION);
  LifeCycleCallbackCollection callbacks=(LifeCycleCallbackCollection)context.getAttribute(LifeCycleCallbackCollection.LIFECYCLE_CALLBACK_COLLECTION);
  SecurityHandler securityHandler=context.getSecurityHandler();
  if (runAsCollection != null) {
    ServletHolder[] holders=context.getServletHandler().getServlets();
    for (int i=0; holders != null && i < holders.length; i++) {
      runAsCollection.setRunAs(holders[i],securityHandler);
    }
  }
  EventListener[] listeners=context.getEventListeners();
  for (int i=0; listeners != null && i < listeners.length; i++) {
    if (injections != null)     injections.inject(listeners[i]);
    if (callbacks != null)     callbacks.callPostConstructCallback(listeners[i]);
  }
}
