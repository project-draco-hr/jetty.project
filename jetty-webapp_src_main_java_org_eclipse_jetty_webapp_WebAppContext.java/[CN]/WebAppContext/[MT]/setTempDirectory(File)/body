{
  if (isStarted())   throw new IllegalStateException("Started");
  if (dir != null) {
    try {
      dir=new File(dir.getCanonicalPath());
    }
 catch (    IOException e) {
      Log.warn(Log.EXCEPTION,e);
    }
  }
  if (dir != null && !dir.exists()) {
    dir.mkdir();
    dir.deleteOnExit();
  }
  if (dir != null && (!dir.exists() || !dir.isDirectory() || !dir.canWrite()))   throw new IllegalArgumentException("Bad temp directory: " + dir);
  try {
    if (dir != null)     dir=dir.getCanonicalFile();
  }
 catch (  Exception e) {
    Log.warn(e);
  }
  _tmpDir=dir;
  setAttribute(TEMPDIR,_tmpDir);
}
