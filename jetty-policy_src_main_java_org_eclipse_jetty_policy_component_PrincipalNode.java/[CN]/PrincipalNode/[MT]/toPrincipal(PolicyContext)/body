{
  if (principal != null && !isDirty()) {
    return principal;
  }
  if (context.getKeystore() == null) {
    return null;
  }
  try {
    Certificate certificate=context.getKeystore().getCertificate(name);
    if (certificate instanceof X509Certificate) {
      principal=((X509Certificate)certificate).getSubjectX500Principal();
      return principal;
    }
 else {
      throw new PolicyException("Unknown Certificate, unable to obtain Principal: " + certificate.getType());
    }
  }
 catch (  KeyStoreException kse) {
    throw new PolicyException(kse);
  }
}
