{
  String auth=configuration.getAuthMethod();
  Authenticator authenticator=null;
  if (auth == null || Constraint.__BASIC_AUTH.equalsIgnoreCase(auth))   authenticator=new BasicAuthenticator();
 else   if (Constraint.__DIGEST_AUTH.equalsIgnoreCase(auth))   authenticator=new DigestAuthenticator();
 else   if (Constraint.__FORM_AUTH.equalsIgnoreCase(auth))   authenticator=new SessionCachingAuthenticator(new FormAuthenticator());
  if (Constraint.__CERT_AUTH.equalsIgnoreCase(auth) || Constraint.__CERT_AUTH2.equalsIgnoreCase(auth))   authenticator=new ClientCertAuthenticator();
  if (configuration.isLazy() && authenticator != null)   authenticator=new DeferredAuthenticator(authenticator);
  return authenticator;
}
