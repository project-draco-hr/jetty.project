{
  HttpClient httpClient=new HttpClient();
  httpClient.setConnectorType(HttpClient.CONNECTOR_SELECT_CHANNEL);
  httpClient.start();
  try {
    String requestUrl="http://localhost:" + _port + "/header";
    ContentExchange exchange=new ContentExchange();
    exchange.setURL(requestUrl);
    exchange.setMethod(HttpMethod.GET);
    exchange.addRequestHeader("User-Agent","Jetty-Client/7.0");
    httpClient.send(exchange);
    int state=exchange.waitForDone();
    assertEquals(HttpExchange.STATUS_COMPLETED,state);
    int responseStatus=exchange.getResponseStatus();
    assertEquals(HttpStatus.OK_200,responseStatus);
    String content=exchange.getResponseContent();
    assertEquals(HttpHeadersTest.CONTENT,content);
    assertEquals("Jetty-Client/7.0",_handler.headers.get("User-Agent"));
  }
  finally {
    httpClient.stop();
  }
}
