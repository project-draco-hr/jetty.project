{
  try {
    if (Equinox_BundleHost_getBundleLoader_method == null) {
      Equinox_BundleHost_getBundleLoader_method=bundle.getClass().getClassLoader().loadClass("org.eclipse.osgi.framework.internal.core.BundleHost").getDeclaredMethod("getBundleLoader",new Class[]{});
      Equinox_BundleHost_getBundleLoader_method.setAccessible(true);
    }
    Object bundleLoader=Equinox_BundleHost_getBundleLoader_method.invoke(bundle,new Object[]{});
    if (Equinox_BundleLoader_createClassLoader_method == null && bundleLoader != null) {
      Equinox_BundleLoader_createClassLoader_method=bundleLoader.getClass().getClassLoader().loadClass("org.eclipse.osgi.internal.loader.BundleLoader").getDeclaredMethod("createClassLoader",new Class[]{});
      Equinox_BundleLoader_createClassLoader_method.setAccessible(true);
    }
    return (ClassLoader)Equinox_BundleLoader_createClassLoader_method.invoke(bundleLoader,new Object[]{});
  }
 catch (  Throwable t) {
    LOG.warn(t);
  }
  LOG.warn("No classloader for equinox platform for bundle " + bundle.getSymbolicName());
  return null;
}
