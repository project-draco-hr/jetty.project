{
  HttpChannelOverHTTP2 channel=channels.poll();
  if (channel != null) {
    channel.getHttpTransport().setStream(stream);
    if (LOG.isDebugEnabled())     LOG.debug("Recycling channel {} for {}",channel,this);
  }
 else {
    HttpTransportOverHTTP2 transport=new HttpTransportOverHTTP2(connector,this);
    transport.setStream(stream);
    channel=new HttpChannelOverHTTP2(connector,httpConfig,getEndPoint(),transport){
      @Override public void onCompleted(){
        super.onCompleted();
        recycle();
        channels.offer(this);
      }
    }
;
    if (LOG.isDebugEnabled())     LOG.debug("Creating channel {} for {}",channel,this);
  }
  stream.setAttribute(IStream.CHANNEL_ATTRIBUTE,channel);
  return channel;
}
