{
  if (_writer == null) {
    if (_compressedStream != null)     throw new IllegalStateException("getOutputStream() called");
    if (getResponse().isCommitted() || _noCompression)     return getResponse().getWriter();
    _compressedStream=newCompressedStream(_request,(HttpServletResponse)getResponse());
    _writer=newWriter(_compressedStream,getCharacterEncoding());
  }
  return _writer;
}
