{
  if (LOG.isDebugEnabled())   LOG.debug("{} close={} local={}",this,close,local);
  if (close) {
switch (closeState) {
case OPENED:
{
        closeState=local ? CloseState.LOCALLY_CLOSED : CloseState.REMOTELY_CLOSED;
        break;
      }
case LOCALLY_CLOSED:
{
      if (local)       throw new IllegalStateException();
 else       close();
      break;
    }
case REMOTELY_CLOSED:
{
    if (local)     close();
 else     throw new IllegalStateException();
    break;
  }
default :
{
  LOG.warn("Already CLOSED! {} local={}",this,local);
}
}
}
}
