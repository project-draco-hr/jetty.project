{
  AbstractHttpConnection connection=null;
  while ((connection == null) && (connection=getIdleConnection()) == null && timeout > 0) {
    boolean startConnection=false;
synchronized (this) {
      int totalConnections=_connections.size() + _pendingConnections;
      if (totalConnections < _maxConnections) {
        _newConnection++;
        startConnection=true;
      }
    }
    if (startConnection) {
      startNewConnection();
      try {
        Object o=_newQueue.take();
        if (o instanceof AbstractHttpConnection) {
          connection=(AbstractHttpConnection)o;
        }
 else         throw (IOException)o;
      }
 catch (      InterruptedException e) {
        LOG.ignore(e);
      }
    }
 else {
      try {
        Thread.currentThread();
        Thread.sleep(200);
        timeout-=200;
      }
 catch (      InterruptedException e) {
        LOG.ignore(e);
      }
    }
  }
  return connection;
}
