{
  LOG.debug("ClosedIn {} {} {}",this,code,message);
  final boolean closed_out;
  final boolean tell_app;
synchronized (this) {
    closed_out=_closedOut;
    _closedIn=true;
    tell_app=_closeCode == 0;
    if (tell_app) {
      _closeCode=code;
      _closeMessage=message;
    }
  }
  try {
    if (!closed_out)     closeOut(code,message);
  }
  finally {
    if (tell_app)     _webSocket.onClose(code,message);
  }
}
