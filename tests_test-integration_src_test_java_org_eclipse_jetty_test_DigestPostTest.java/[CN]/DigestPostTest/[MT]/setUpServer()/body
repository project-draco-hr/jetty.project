{
  try {
    _server=new Server();
    _server.setConnectors(new Connector[]{new SelectChannelConnector()});
    ServletContextHandler context=new ServletContextHandler(ServletContextHandler.SECURITY);
    context.setContextPath("/test");
    context.addServlet(PostServlet.class,"/");
    HashLoginService realm=new HashLoginService("test");
    realm.putUser("testuser",new Password("password"),new String[]{"test"});
    _server.addBean(realm);
    ConstraintSecurityHandler security=(ConstraintSecurityHandler)context.getSecurityHandler();
    security.setAuthenticator(new DigestAuthenticator());
    security.setLoginService(realm);
    Constraint constraint=new Constraint("SecureTest","test");
    constraint.setAuthenticate(true);
    ConstraintMapping mapping=new ConstraintMapping();
    mapping.setConstraint(constraint);
    mapping.setPathSpec("/*");
    security.setConstraintMappings(new ConstraintMapping[]{mapping});
    HandlerCollection handlers=new HandlerCollection();
    handlers.setHandlers(new Handler[]{context,new DefaultHandler()});
    _server.setHandler(handlers);
    _server.start();
  }
 catch (  final Exception e) {
    e.printStackTrace();
  }
}
