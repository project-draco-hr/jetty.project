{
  try {
    final int filled=connectHandler.read(getEndPoint(),buffer,getContext());
    LOG.debug("{} filled {} bytes",this,filled);
    if (filled > 0) {
      write(buffer,new Callback<Void>(){
        @Override public void completed(        Void context){
          LOG.debug("{} wrote {} bytes",this,filled);
          buffer.clear();
          invoker.invoke(buffer);
        }
        @Override public void failed(        Void context,        Throwable x){
          LOG.debug(this + " failed to write " + filled+ " bytes",x);
          bufferPool.release(buffer);
          connection.close();
        }
      }
);
    }
 else     if (filled == 0) {
      bufferPool.release(buffer);
      fillInterested();
    }
 else {
      bufferPool.release(buffer);
      connection.getEndPoint().shutdownOutput();
    }
  }
 catch (  IOException x) {
    LOG.debug(this + " could not fill",x);
    bufferPool.release(buffer);
    close();
    connection.close();
  }
}
