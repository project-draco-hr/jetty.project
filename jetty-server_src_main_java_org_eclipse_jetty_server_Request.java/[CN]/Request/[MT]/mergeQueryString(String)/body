{
  MultiMap<String> parameters=new MultiMap<>();
  UrlEncoded.decodeTo(query,parameters,getCharacterEncoding());
  boolean merge_old_query=false;
  if (!_paramsExtracted)   extractParameters();
  if (_parameters != null && _parameters.size() > 0) {
    merge_old_query=parameters.addAllValues(_parameters);
  }
  if (_queryString != null && _queryString.length() > 0) {
    if (merge_old_query) {
      StringBuilder overridden_query_string=new StringBuilder();
      MultiMap<String> overridden_old_query=new MultiMap<>();
      UrlEncoded.decodeTo(_queryString,overridden_old_query,getCharacterEncoding());
      MultiMap<String> overridden_new_query=new MultiMap<>();
      UrlEncoded.decodeTo(query,overridden_new_query,getCharacterEncoding());
      for (      String name : overridden_old_query.keySet()) {
        if (!overridden_new_query.containsKey(name)) {
          List<String> values=overridden_old_query.get(name);
          for (          String v : values) {
            overridden_query_string.append("&").append(name).append("=").append(v);
          }
        }
      }
      query=query + overridden_query_string;
    }
 else {
      query=query + "&" + _queryString;
    }
  }
  setParameters(parameters);
  setQueryString(query);
}
