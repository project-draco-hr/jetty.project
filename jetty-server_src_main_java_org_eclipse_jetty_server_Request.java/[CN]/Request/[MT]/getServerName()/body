{
  if (_serverName != null)   return _serverName;
  _serverName=_uri.getHost();
  _port=_uri.getPort();
  if (_serverName != null)   return _serverName;
  Buffer hostPort=_connection.getRequestFields().get(HttpHeaders.HOST_BUFFER);
  if (hostPort != null) {
    loop:     for (int i=hostPort.putIndex(); i-- > hostPort.getIndex(); ) {
      char ch=(char)(0xff & hostPort.peek(i));
switch (ch) {
case ']':
        break loop;
case ':':
      _serverName=BufferUtil.to8859_1_String(hostPort.peek(hostPort.getIndex(),i - hostPort.getIndex()));
    _port=BufferUtil.toInt(hostPort.peek(i + 1,hostPort.putIndex() - i - 1));
  return _serverName;
}
}
if (_serverName == null || _port < 0) {
_serverName=BufferUtil.to8859_1_String(hostPort);
_port=0;
}
return _serverName;
}
if (_connection != null) {
_serverName=getLocalName();
_port=getLocalPort();
if (_serverName != null && !StringUtil.ALL_INTERFACES.equals(_serverName)) return _serverName;
}
try {
_serverName=InetAddress.getLocalHost().getHostAddress();
}
 catch (java.net.UnknownHostException e) {
Log.ignore(e);
}
return _serverName;
}
