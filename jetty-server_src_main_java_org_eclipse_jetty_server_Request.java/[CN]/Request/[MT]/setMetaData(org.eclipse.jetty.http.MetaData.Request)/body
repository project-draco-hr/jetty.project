{
  _metadata=request;
  setMethod(request.getMethod());
  setScheme(request.getScheme().asString());
  HttpURI uri=new HttpURI(request.getURI());
  String uriHost=uri.getHost();
  if (uriHost != null) {
    setServerName(uriHost);
    setServerPort(uri.getPort());
  }
 else {
    setServerName(request.getHost());
    setServerPort(request.getPort());
  }
  setUri(uri);
  String path=uri.getDecodedPath();
  String info=URIUtil.canonicalPath(path);
  if (info == null) {
    if (path == null && uri.getScheme() != null && uri.getHost() != null) {
      info="/";
      setRequestURI("");
    }
 else     throw new BadMessageException(400,"Bad URI");
  }
  setPathInfo(info);
}
