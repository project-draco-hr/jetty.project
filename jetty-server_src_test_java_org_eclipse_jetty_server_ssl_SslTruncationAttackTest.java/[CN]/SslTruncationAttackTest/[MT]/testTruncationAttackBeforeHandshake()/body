{
  Socket socket=new Socket("localhost",connector.getLocalPort());
  SSLSocket sslSocket=(SSLSocket)sslContext.getSocketFactory().createSocket(socket,socket.getInetAddress().getHostName(),socket.getPort(),true);
  sslSocket.setUseClientMode(true);
  TimeUnit.SECONDS.sleep(1);
  handleCount.set(0);
  socket.close();
  TimeUnit.SECONDS.sleep(1);
  Assert.assertEquals("handle() invocations",1,handleCount.get());
  Assert.assertTrue("endpoint not closed",endPointClosed.get());
}
