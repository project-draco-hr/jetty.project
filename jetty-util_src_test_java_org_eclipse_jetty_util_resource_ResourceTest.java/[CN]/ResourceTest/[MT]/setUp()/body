{
  if (data != null)   return;
  File file=new File(__userDir);
  file=new File(file.getCanonicalPath());
  URI uri=file.toURI();
  __userURL=uri.toURL();
  __userURL=new URL(__userURL.toString() + "src/test/java/org/eclipse/jetty/util/resource/");
  FilePermission perm=(FilePermission)__userURL.openConnection().getPermission();
  __userDir=new File(perm.getName()).getCanonicalPath() + File.separatorChar;
  __relDir="src/test/java/org/eclipse/jetty/util/resource/".replace('/',File.separatorChar);
  System.err.println("User Dir=" + __userDir);
  System.err.println("Rel  Dir=" + __relDir);
  System.err.println("User URL=" + __userURL);
  tmpFile=File.createTempFile("test",null).getCanonicalFile();
  tmpFile.deleteOnExit();
  data=new Data[50];
  int i=0;
  data[i++]=new Data(tmpFile.toString(),EXISTS,!DIR);
  int rt=i;
  data[i++]=new Data(__userURL,EXISTS,DIR);
  data[i++]=new Data(__userDir,EXISTS,DIR);
  data[i++]=new Data(__relDir,EXISTS,DIR);
  data[i++]=new Data(__userURL + "ResourceTest.java",EXISTS,!DIR);
  data[i++]=new Data(__userDir + "ResourceTest.java",EXISTS,!DIR);
  data[i++]=new Data(__relDir + "ResourceTest.java",EXISTS,!DIR);
  data[i++]=new Data(__userURL + "NoName.txt",!EXISTS,!DIR);
  data[i++]=new Data(__userDir + "NoName.txt",!EXISTS,!DIR);
  data[i++]=new Data(__relDir + "NoName.txt",!EXISTS,!DIR);
  data[i++]=new Data(data[rt],"ResourceTest.java",EXISTS,!DIR);
  data[i++]=new Data(data[rt],"/ResourceTest.java",EXISTS,!DIR);
  data[i++]=new Data(data[rt],"NoName.txt",!EXISTS,!DIR);
  data[i++]=new Data(data[rt],"/NoName.txt",!EXISTS,!DIR);
  int td=i;
  data[i++]=new Data(data[rt],"TestData",EXISTS,DIR);
  data[i++]=new Data(data[rt],"TestData/",EXISTS,DIR);
  data[i++]=new Data(data[td],"alphabet.txt",EXISTS,!DIR,"ABCDEFGHIJKLMNOPQRSTUVWXYZ");
  data[i++]=new Data("jar:file:/somejar.jar!/content/",!EXISTS,DIR);
  data[i++]=new Data("jar:file:/somejar.jar!/",!EXISTS,DIR);
  int tj=i;
  data[i++]=new Data("jar:" + __userURL + "TestData/test.zip!/",EXISTS,DIR);
  data[i++]=new Data(data[tj],"Unkown",!EXISTS,!DIR);
  data[i++]=new Data(data[tj],"/Unkown/",!EXISTS,DIR);
  data[i++]=new Data(data[tj],"subdir",EXISTS,DIR);
  data[i++]=new Data(data[tj],"/subdir/",EXISTS,DIR);
  data[i++]=new Data(data[tj],"alphabet",EXISTS,!DIR,"ABCDEFGHIJKLMNOPQRSTUVWXYZ");
  data[i++]=new Data(data[tj],"/subdir/alphabet",EXISTS,!DIR,"ABCDEFGHIJKLMNOPQRSTUVWXYZ");
  Resource base=Resource.newResource(__userDir);
  Resource dir0=base.addPath("TestData");
  assertTrue(dir0.isDirectory());
  assertTrue(dir0.toString().endsWith("/"));
  assertTrue(dir0.getAlias() == null);
  Resource dir1=base.addPath("TestData/");
  assertTrue(dir1.isDirectory());
  assertTrue(dir1.toString().endsWith("/"));
  assertTrue(dir1.getAlias() == null);
}
