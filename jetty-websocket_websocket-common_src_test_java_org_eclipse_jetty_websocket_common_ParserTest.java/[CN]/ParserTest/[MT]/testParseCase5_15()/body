{
  List<WebSocketFrame> send=new ArrayList<>();
  send.add(new TextFrame().setPayload("fragment1").setFin(false));
  send.add(new ContinuationFrame("fragment2").setFin(true));
  send.add(new ContinuationFrame("fragment3").setFin(false));
  send.add(new TextFrame().setPayload("fragment4").setFin(true));
  send.add(new CloseInfo(StatusCode.NORMAL).asFrame());
  ByteBuffer completeBuf=UnitGenerator.generate(send);
  UnitParser parser=new UnitParser();
  IncomingFramesCapture capture=new IncomingFramesCapture();
  parser.setIncomingFramesHandler(capture);
  parser.parseQuietly(completeBuf);
  capture.assertErrorCount(1);
  capture.assertHasFrame(OpCode.TEXT,1);
  capture.assertHasFrame(OpCode.CONTINUATION,1);
}
