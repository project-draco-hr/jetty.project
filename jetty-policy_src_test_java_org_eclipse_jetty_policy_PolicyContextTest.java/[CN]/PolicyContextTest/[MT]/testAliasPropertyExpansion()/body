{
  PolicyContext context=new PolicyContext();
  PolicyFileScanner loader=new PolicyFileScanner();
  List<GrantEntry> grantEntries=new ArrayList<GrantEntry>();
  List<KeystoreEntry> keystoreEntries=new ArrayList<KeystoreEntry>();
  File policyFile=MavenTestingUtils.getTestResourceFile("context/jetty-certificate-alias.policy");
  loader.scanStream(new InputStreamReader(new FileInputStream(policyFile)),grantEntries,keystoreEntries);
  if (!OS.IS_WINDOWS) {
    for (    KeystoreEntry node : keystoreEntries) {
      node.expand(context);
      context.setKeystore(node.toKeyStore());
    }
    GrantEntry grant=grantEntries.get(0);
    grant.expand(context);
    Permission perm=grant.getPermissions().elements().nextElement();
    assertEquals(__PRINCIPAL,perm.getName());
  }
}
