{
  try {
    updateCloseState(headersInfo.isClose());
    HeadersFrame frame=new HeadersFrame(session.getVersion(),headersInfo.getFlags(),getId(),headersInfo.getHeaders());
    session.control(this,frame,timeout,unit,handler,null);
  }
 catch (  StreamException x) {
    logger.debug("Could not send headers on stream " + this,x);
    handler.failed(x);
    session.rst(new RstInfo(getId(),x.getStreamStatus()));
  }
}
