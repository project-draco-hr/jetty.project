{
synchronized (queue) {
    if (dispatched)     return;
    final Runnable task=queue.poll();
    if (task != null) {
      dispatched=true;
      logger.debug("Dispatching task {}",task);
      session.execute(new Runnable(){
        @Override public void run(){
          try {
            logger.debug("Executing task {}",task);
            task.run();
          }
  finally {
            logger.debug("Completing task {}",task);
            dispatched=false;
            dispatch();
          }
        }
      }
);
    }
  }
}
