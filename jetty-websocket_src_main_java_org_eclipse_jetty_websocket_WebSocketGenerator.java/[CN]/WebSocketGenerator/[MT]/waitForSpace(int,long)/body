{
  int space=_buffer.space();
  if (space < needed) {
    _buffer.compact();
    space=_buffer.space();
    if (space < needed)     throw new IllegalStateException("no space");
  }
  return space;
}
