{
  testdir.ensureEmpty();
  File resBase=testdir.getFile("docroot");
  FS.ensureDirExists(resBase);
  File file0=new File(resBase,"data0.txt");
  createFile(file0,"Hello Text 0");
  String resBasePath=resBase.getAbsolutePath();
  ServletHolder defholder=context.addServlet(DefaultServlet.class,"/");
  defholder.setInitParameter("dirAllowed","false");
  defholder.setInitParameter("redirectWelcome","false");
  defholder.setInitParameter("welcomeServlets","false");
  defholder.setInitParameter("gzip","false");
  defholder.setInitParameter("resourceBase",resBasePath);
  String response=connector.getResponses("GET /context/data0.txt HTTP/1.1\r\nHost:localhost:8080\r\n\r\n");
  assertResponseContains("Content-Length: 12",response);
  assertResponseNotContains("Extra Info",response);
  context.addFilter(OutputFilter.class,"/*",EnumSet.of(DispatcherType.REQUEST));
  response=connector.getResponses("GET /context/data0.txt HTTP/1.1\r\nHost:localhost:8080\r\n\r\n");
  assertResponseContains("Content-Length: 2",response);
  assertResponseContains("Extra Info",response);
  assertResponseNotContains("Content-Length: 12",response);
  context.getServletHandler().setFilterMappings(new FilterMapping[]{});
  context.getServletHandler().setFilters(new FilterHolder[]{});
  context.addFilter(WriterFilter.class,"/*",EnumSet.of(DispatcherType.REQUEST));
  response=connector.getResponses("GET /context/data0.txt HTTP/1.1\r\nHost:localhost:8080\r\n\r\n");
  assertResponseContains("Content-Length: 2",response);
  assertResponseContains("Extra Info",response);
  assertResponseNotContains("Content-Length: 12",response);
}
