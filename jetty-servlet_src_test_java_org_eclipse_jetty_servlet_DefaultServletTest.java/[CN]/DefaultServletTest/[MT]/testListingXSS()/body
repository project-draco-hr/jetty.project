{
  ServletHolder defholder=context.addServlet(DefaultServlet.class,"/*");
  defholder.setInitParameter("dirAllowed","true");
  defholder.setInitParameter("redirectWelcome","false");
  defholder.setInitParameter("gzip","false");
  File testDir=new File("target/tests/" + getName());
  prepareEmptyTestDir(testDir);
  File resBase=new File(testDir,"docroot");
  resBase.mkdirs();
  new File(resBase,"one").mkdir();
  new File(resBase,"two").mkdir();
  new File(resBase,"three").mkdir();
  if (!_runningOnWindows) {
    assertTrue("Creating dir 'f??r' (Might not work in Windows)",new File(resBase,"f??r").mkdir());
    String resBasePath=resBase.getAbsolutePath();
    defholder.setInitParameter("resourceBase",resBasePath);
    StringBuffer req1=new StringBuffer();
    req1.append("GET /context/;<script>window.alert(\"hi\");</script> HTTP/1.1\n");
    req1.append("Host: localhost\n");
    req1.append("\n");
    String response=connector.getResponses(req1.toString());
    assertResponseContains("/one/",response);
    assertResponseContains("/two/",response);
    assertResponseContains("/three/",response);
    assertResponseContains("/f%3F%3Fr",response);
    assertResponseNotContains("<script>",response);
  }
}
