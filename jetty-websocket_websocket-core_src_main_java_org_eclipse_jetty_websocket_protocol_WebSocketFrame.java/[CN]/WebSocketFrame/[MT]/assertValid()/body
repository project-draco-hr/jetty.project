{
  if (OpCode.isControlFrame(opcode)) {
    if (getPayloadLength() > WebSocketFrame.MAX_CONTROL_PAYLOAD) {
      throw new ProtocolException("Desired payload length [" + getPayloadLength() + "] exceeds maximum control payload length ["+ MAX_CONTROL_PAYLOAD+ "]");
    }
    if (fin == false) {
      throw new ProtocolException("Cannot have FIN==false on Control frames");
    }
    if (rsv1 == true) {
      throw new ProtocolException("Cannot have RSV1==true on Control frames");
    }
    if (rsv2 == true) {
      throw new ProtocolException("Cannot have RSV2==true on Control frames");
    }
    if (rsv3 == true) {
      throw new ProtocolException("Cannot have RSV3==true on Control frames");
    }
    if (isContinuation()) {
      throw new ProtocolException("Control frames cannot be Continuations");
    }
  }
}
