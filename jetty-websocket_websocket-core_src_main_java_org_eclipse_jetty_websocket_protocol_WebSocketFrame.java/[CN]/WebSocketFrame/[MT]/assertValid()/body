{
  if (opcode.isControlFrame()) {
    if (getPayloadLength() > WebSocketFrame.MAX_CONTROL_PAYLOAD) {
      throw new ProtocolException("Desired payload length [" + getPayloadLength() + "] exceeds maximum control payload length ["+ MAX_CONTROL_PAYLOAD+ "]");
    }
    if (fin == false) {
      throw new ProtocolException("Cannot have FIN==false on Control frames");
    }
    if (rsv1 == false) {
      throw new ProtocolException("Cannot have RSV1==false on Control frames");
    }
    if (rsv2 == false) {
      throw new ProtocolException("Cannot have RSV2==false on Control frames");
    }
    if (rsv3 == false) {
      throw new ProtocolException("Cannot have RSV3==false on Control frames");
    }
    if (isContinuation()) {
      throw new ProtocolException("Control frames cannot be Continuations");
    }
  }
}
