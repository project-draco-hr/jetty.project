{
  if (buffer instanceof ByteArrayBuffer)   return new BytesDataInfo(buffer.array(),buffer.getIndex(),buffer.length(),close);
  if (buffer instanceof NIOBuffer) {
    ByteBuffer byteBuffer=((NIOBuffer)buffer).getByteBuffer();
    byteBuffer.limit(buffer.putIndex());
    byteBuffer.position(buffer.getIndex());
    return new ByteBufferDataInfo(byteBuffer,close);
  }
  return new BytesDataInfo(buffer.asArray(),close);
}
