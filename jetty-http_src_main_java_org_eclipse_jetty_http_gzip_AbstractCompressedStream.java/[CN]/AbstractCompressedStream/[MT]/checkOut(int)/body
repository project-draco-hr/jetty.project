{
  if (_closed)   throw new IOException("CLOSED");
  if (_out == null) {
    if (_response.isCommitted() || (_contentLength >= 0 && _contentLength < _minCompressSize))     doNotCompress();
 else     if (length > _minCompressSize)     doCompress();
 else     _out=_bOut=new ByteArrayOutputStream2(_bufferSize);
  }
 else   if (_bOut != null) {
    if (_response.isCommitted() || (_contentLength >= 0 && _contentLength < _minCompressSize))     doNotCompress();
 else     if (length >= (_bOut.getBuf().length - _bOut.getCount()))     doCompress();
  }
}
