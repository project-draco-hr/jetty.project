{
  _availability=Availability.UNAVAILABLE;
  ClassLoader old_classloader=null;
  Thread current_thread=null;
  Context old_context=__context.get();
  __context.set(_scontext);
  try {
    if (_classLoader != null) {
      current_thread=Thread.currentThread();
      old_classloader=current_thread.getContextClassLoader();
      current_thread.setContextClassLoader(_classLoader);
    }
    stopContext();
    setEventListeners(_durableListeners.toArray(new EventListener[_durableListeners.size()]));
    _durableListeners.clear();
    if (_errorHandler != null)     _errorHandler.stop();
    for (    EventListener l : _programmaticListeners)     removeEventListener(l);
    _programmaticListeners.clear();
  }
  finally {
    LOG.info("Stopped {}",this);
    __context.set(old_context);
    if (_classLoader != null && current_thread != null)     current_thread.setContextClassLoader(old_classloader);
  }
  _scontext.clearAttributes();
}
