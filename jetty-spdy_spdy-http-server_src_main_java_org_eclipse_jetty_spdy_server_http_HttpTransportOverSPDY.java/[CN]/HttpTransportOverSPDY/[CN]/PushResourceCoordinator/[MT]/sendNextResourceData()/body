{
  if (LOG.isDebugEnabled())   LOG.debug("{} sendNextResourceData active: {}",hashCode(),active.get());
  if (active.compareAndSet(false,true)) {
    PushResource resource=queue.poll();
    if (resource != null) {
      if (LOG.isDebugEnabled())       LOG.debug("Opening new push channel for: {}",resource);
      HttpChannelOverSPDY pushChannel=newHttpChannelOverSPDY(resource.getPushStream(),resource.getPushRequestHeaders());
      pushChannel.requestStart(resource.getPushRequestHeaders(),true);
      return;
    }
    if (active.compareAndSet(true,false)) {
      if (queue.peek() != null)       sendNextResourceData();
    }
 else {
      throw new IllegalStateException("active must not be false here! Concurrency bug!");
    }
  }
}
