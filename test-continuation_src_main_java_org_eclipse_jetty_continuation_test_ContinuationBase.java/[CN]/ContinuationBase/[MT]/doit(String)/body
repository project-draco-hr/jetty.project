{
  String response;
  response=process(null,null);
  assertContains(type,response);
  assertContains("NORMAL",response);
  assertNotContains("history: onTimeout",response);
  assertNotContains("history: onComplete",response);
  response=process("sleep=200",null);
  assertContains("SLEPT",response);
  assertNotContains("history: onTimeout",response);
  assertNotContains("history: onComplete",response);
  response=process("suspend=200",null);
  assertContains("TIMEOUT",response);
  assertContains("history: onTimeout",response);
  assertContains("history: onComplete",response);
  response=process("suspend=200&resume=10",null);
  assertContains("RESUMED",response);
  assertNotContains("history: onTimeout",response);
  assertContains("history: onComplete",response);
  response=process("suspend=200&resume=0",null);
  assertContains("RESUMED",response);
  assertNotContains("history: onTimeout",response);
  assertContains("history: onComplete",response);
  response=process("suspend=200&complete=10",null);
  assertContains("COMPLETED",response);
  assertNotContains("history: onTimeout",response);
  assertContains("history: onComplete",response);
  response=process("suspend=200&complete=0",null);
  assertContains("COMPLETED",response);
  assertNotContains("history: onTimeout",response);
  assertContains("history: onComplete",response);
  response=process("suspend=1000&resume=10&suspend2=1000&resume2=10",null);
  assertEquals(2,count(response,"history: suspend"));
  assertEquals(2,count(response,"history: resume"));
  assertEquals(0,count(response,"history: onTimeout"));
  assertEquals(1,count(response,"history: onComplete"));
  assertContains("RESUMED",response);
  response=process("suspend=1000&resume=10&suspend2=1000&resume2=10",null);
  assertEquals(2,count(response,"history: suspend"));
  assertEquals(2,count(response,"history: resume"));
  assertEquals(0,count(response,"history: onTimeout"));
  assertEquals(1,count(response,"history: onComplete"));
  assertContains("RESUMED",response);
  response=process("suspend=1000&resume=10&suspend2=1000&complete2=10",null);
  assertEquals(2,count(response,"history: suspend"));
  assertEquals(1,count(response,"history: resume"));
  assertEquals(0,count(response,"history: onTimeout"));
  assertEquals(1,count(response,"history: onComplete"));
  assertContains("COMPLETED",response);
  response=process("suspend=1000&resume=10&suspend2=10",null);
  assertEquals(2,count(response,"history: suspend"));
  assertEquals(1,count(response,"history: resume"));
  assertEquals(1,count(response,"history: onTimeout"));
  assertEquals(1,count(response,"history: onComplete"));
  assertContains("TIMEOUT",response);
  response=process("suspend=10&suspend2=1000&resume2=10",null);
  assertEquals(2,count(response,"history: suspend"));
  assertEquals(1,count(response,"history: resume"));
  assertEquals(1,count(response,"history: onTimeout"));
  assertEquals(1,count(response,"history: onComplete"));
  assertContains("RESUMED",response);
  response=process("suspend=10&suspend2=1000&resume2=10",null);
  assertEquals(2,count(response,"history: suspend"));
  assertEquals(1,count(response,"history: resume"));
  assertEquals(1,count(response,"history: onTimeout"));
  assertEquals(1,count(response,"history: onComplete"));
  assertContains("RESUMED",response);
  response=process("suspend=10&suspend2=1000&complete2=10",null);
  assertEquals(2,count(response,"history: suspend"));
  assertEquals(0,count(response,"history: resume"));
  assertEquals(1,count(response,"history: onTimeout"));
  assertEquals(1,count(response,"history: onComplete"));
  assertContains("COMPLETED",response);
  response=process("suspend=10&suspend2=10",null);
  assertEquals(2,count(response,"history: suspend"));
  assertEquals(0,count(response,"history: resume"));
  assertEquals(2,count(response,"history: onTimeout"));
  assertEquals(1,count(response,"history: onComplete"));
  assertContains("TIMEOUT",response);
}
