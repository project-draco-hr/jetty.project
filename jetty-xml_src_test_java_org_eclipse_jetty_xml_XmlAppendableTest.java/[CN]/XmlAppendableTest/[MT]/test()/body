{
  StringBuilder b=new StringBuilder();
  XmlAppendable out=new XmlAppendable(b);
  Map<String,String> attr=new LinkedHashMap<>();
  out.open("test");
  attr.put("name","attr value");
  attr.put("noval",null);
  attr.put("quotes","'\"");
  out.tag("tag");
  out.tag("tag",attr);
  out.tag("tag",attr,"content");
  out.open("level1").tag("tag","content").tag("tag","content").close();
  out.open("level1",attr).open("level2").tag("tag","content").tag("tag","content").close().close();
  out.close();
  String expected="" + "<?xml version=\"1.0\" encoding=\"UTF-8\"?>\n" + "<test>\n"+ "  <tag/>\n"+ "  <tag name=\"attr value\" noval=\"\" quotes=\"&apos;&quot;\"/>\n"+ "  <tag name=\"attr value\" noval=\"\" quotes=\"&apos;&quot;\">content</tag>\n"+ "  <level1>\n"+ "    <tag>content</tag>\n"+ "    <tag>content</tag>\n"+ "  </level1>\n"+ "  <level1 name=\"attr value\" noval=\"\" quotes=\"&apos;&quot;\">\n"+ "    <level2>\n"+ "      <tag>content</tag>\n"+ "      <tag>content</tag>\n"+ "    </level2>\n"+ "  </level1>\n"+ "</test>\n";
  Assert.assertEquals(expected,b.toString());
}
