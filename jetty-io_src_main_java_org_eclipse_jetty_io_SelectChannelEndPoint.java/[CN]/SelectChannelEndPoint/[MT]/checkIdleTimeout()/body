{
  if (isOpen()) {
    long idleTimestamp=getIdleTimestamp();
    long idleTimeout=getIdleTimeout();
    long idleElapsed=System.currentTimeMillis() - idleTimestamp;
    long idleLeft=idleTimeout - idleElapsed;
    LOG.debug("{} idle timeout check, elapsed: {} ms, remaining: {} ms",this,idleElapsed,idleLeft);
    if (isOutputShutdown() || _readInterest.isInterested() || _writeFlusher.isWriting()) {
      if (idleTimestamp != 0 && idleTimeout > 0) {
        if (idleLeft <= 0) {
          LOG.debug("{} idle timeout expired",this);
          if (isOutputShutdown())           close();
          notIdle();
          TimeoutException timeout=new TimeoutException("Idle timeout expired: " + idleElapsed + "/"+ idleTimeout+ " ms");
          _readInterest.failed(timeout);
          _writeFlusher.failed(timeout);
        }
      }
    }
    scheduleIdleTimeout(idleLeft > 0 ? idleLeft : idleTimeout);
  }
}
