{
  int oldInterestOps=_interestOps;
  int newInterestOps;
  if (add)   newInterestOps=oldInterestOps | operation;
 else   newInterestOps=oldInterestOps & ~operation;
  if (isInputShutdown())   newInterestOps&=~SelectionKey.OP_READ;
  if (isOutputShutdown())   newInterestOps&=~SelectionKey.OP_WRITE;
  if (newInterestOps != oldInterestOps) {
    _interestOps=newInterestOps;
    LOG.debug("Local interests updated {} -> {} for {}",oldInterestOps,newInterestOps,this);
    _selector.submit(_updateTask);
  }
 else {
    LOG.debug("Ignoring local interests update {} -> {} for {}",oldInterestOps,newInterestOps,this);
  }
}
