{
  enableStacks(EventDriver.class,false);
  BlockheadClient client=new BlockheadClient(server.getServerUri());
  try {
    client.connect();
    client.sendStandardRequest();
    client.expectUpgradeResponse();
    try (StacklessLogging context=new StacklessLogging(EventDriver.class)){
      client.write(new TextFrame().setPayload("CRASH"));
      EventQueue<WebSocketFrame> frames=client.readFrames(1,500,TimeUnit.MILLISECONDS);
      Frame cf=frames.poll();
      CloseInfo close=new CloseInfo(cf);
      Assert.assertThat("Close Frame.status code",close.getStatusCode(),is(StatusCode.SERVER_ERROR));
    }
   }
  finally {
    enableStacks(EventDriver.class,true);
    client.close();
  }
}
