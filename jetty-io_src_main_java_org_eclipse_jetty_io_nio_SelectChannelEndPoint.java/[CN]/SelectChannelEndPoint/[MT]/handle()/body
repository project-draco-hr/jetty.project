{
  boolean dispatched=true;
  try {
    while (dispatched) {
      try {
        while (true) {
          final Connection next=_connection.handle();
          if (next != _connection) {
            LOG.debug("{} replaced {}",next,_connection);
            _connection=next;
            continue;
          }
          break;
        }
      }
 catch (      ClosedChannelException e) {
        LOG.ignore(e);
      }
catch (      EofException e) {
        LOG.debug("EOF",e);
        try {
          getChannel().close();
        }
 catch (        IOException e2) {
          LOG.ignore(e2);
        }
      }
catch (      IOException e) {
        LOG.warn(e.toString());
        LOG.debug(e);
        try {
          getChannel().close();
        }
 catch (        IOException e2) {
          LOG.ignore(e2);
        }
      }
catch (      Throwable e) {
        LOG.warn("handle failed",e);
        try {
          getChannel().close();
        }
 catch (        IOException e2) {
          LOG.ignore(e2);
        }
      }
      dispatched=!undispatch();
    }
  }
  finally {
    if (dispatched) {
      dispatched=!undispatch();
      while (dispatched) {
        LOG.warn("SCEP.run() finally DISPATCHED");
        dispatched=!undispatch();
      }
    }
  }
}
