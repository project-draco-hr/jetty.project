{
  final boolean can_read;
  final boolean can_write;
synchronized (this) {
    if (_key == null || !_key.isValid()) {
      this.notifyAll();
      return;
    }
    can_read=(_key.isReadable() && (_key.interestOps() | SelectionKey.OP_READ) != 0);
    can_write=(_key.isWritable() && (_key.interestOps() | SelectionKey.OP_WRITE) != 0);
    _interestOps=0;
    _key.interestOps(0);
  }
  if (can_read)   getConnection().canRead();
  if (can_write)   getConnection().canWrite();
}
