{
  SslSelectChannelConnector connector=new SslSelectChannelConnector(){
    @Override protected SslConnection newSslConnection(    AsyncEndPoint endPoint,    SSLEngine engine){
      return new SslConnection(engine,endPoint){
        @Override public Connection handle() throws IOException {
          _handlecount.incrementAndGet();
          return super.handle();
        }
      }
;
    }
  }
;
  String keystorePath=System.getProperty("basedir",".") + "/src/test/resources/keystore";
  SslContextFactory cf=connector.getSslContextFactory();
  cf.setKeyStorePath(keystorePath);
  cf.setKeyStorePassword("storepwd");
  cf.setKeyManagerPassword("keypwd");
  cf.setTrustStore(keystorePath);
  cf.setTrustStorePassword("storepwd");
  connector.setUseDirectBuffers(true);
  startServer(connector);
  KeyStore keystore=KeyStore.getInstance(KeyStore.getDefaultType());
  keystore.load(new FileInputStream(connector.getKeystore()),"storepwd".toCharArray());
  TrustManagerFactory trustManagerFactory=TrustManagerFactory.getInstance(TrustManagerFactory.getDefaultAlgorithm());
  trustManagerFactory.init(keystore);
  __sslContext=SSLContext.getInstance("TLS");
  __sslContext.init(null,trustManagerFactory.getTrustManagers(),null);
  try {
    HttpsURLConnection.setDefaultHostnameVerifier(__hostnameverifier);
    SSLContext sc=SSLContext.getInstance("TLS");
    sc.init(null,SslContextFactory.TRUST_ALL_CERTS,new java.security.SecureRandom());
    HttpsURLConnection.setDefaultSSLSocketFactory(sc.getSocketFactory());
  }
 catch (  Exception e) {
    e.printStackTrace();
    throw new RuntimeException(e);
  }
}
