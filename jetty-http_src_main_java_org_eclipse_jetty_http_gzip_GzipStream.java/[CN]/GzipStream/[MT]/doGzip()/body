{
  if (_gzOut == null) {
    if (_response.isCommitted())     throw new IllegalStateException();
    if (setContentEncodingGzip()) {
      _out=_gzOut=new GZIPOutputStream(_response.getOutputStream(),_bufferSize);
      if (_bOut != null) {
        _out.write(_bOut.getBuf(),0,_bOut.getCount());
        _bOut=null;
      }
    }
 else     doNotGzip();
  }
}
