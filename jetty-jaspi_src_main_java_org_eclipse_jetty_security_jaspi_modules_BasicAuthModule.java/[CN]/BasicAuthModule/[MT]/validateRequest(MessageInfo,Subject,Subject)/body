{
  HttpServletRequest request=(HttpServletRequest)messageInfo.getRequestMessage();
  HttpServletResponse response=(HttpServletResponse)messageInfo.getResponseMessage();
  String credentials=request.getHeader(HttpHeaders.AUTHORIZATION);
  try {
    if (credentials != null) {
      if (Log.isDebugEnabled())       Log.debug("Credentials: " + credentials);
      if (login(clientSubject,credentials,Constraint.__BASIC_AUTH,messageInfo)) {
        return AuthStatus.SUCCESS;
      }
    }
    if (!isMandatory(messageInfo)) {
      return AuthStatus.SUCCESS;
    }
    response.setHeader(HttpHeaders.WWW_AUTHENTICATE,"basic realm=\"" + realmName + '"');
    response.sendError(HttpServletResponse.SC_UNAUTHORIZED);
    return AuthStatus.SEND_CONTINUE;
  }
 catch (  IOException e) {
    throw new AuthException(e.getMessage());
  }
catch (  UnsupportedCallbackException e) {
    throw new AuthException(e.getMessage());
  }
}
