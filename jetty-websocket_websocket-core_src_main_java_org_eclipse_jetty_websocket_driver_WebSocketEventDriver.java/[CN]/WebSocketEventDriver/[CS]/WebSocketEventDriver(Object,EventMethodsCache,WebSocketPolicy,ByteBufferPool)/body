{
  this.policy=policy;
  this.websocket=websocket;
  this.events=methodsCache.getMethods(websocket.getClass());
  this.bufferPool=bufferPool;
  this.socketLog=Log.getLogger(websocket.getClass());
  if (events.isAnnotated()) {
    WebSocket anno=websocket.getClass().getAnnotation(WebSocket.class);
    if (anno.maxBufferSize() > 0) {
      this.policy.setBufferSize(anno.maxBufferSize());
    }
    if (anno.maxBinarySize() > 0) {
      this.policy.setMaxBinaryMessageSize(anno.maxBinarySize());
    }
    if (anno.maxTextSize() > 0) {
      this.policy.setMaxTextMessageSize(anno.maxTextSize());
    }
    if (anno.maxIdleTime() > 0) {
      this.policy.setIdleTimeout(anno.maxIdleTime());
    }
  }
}
