{
  if (frame instanceof WebSocketFrame) {
    WebSocketFrame wsf=(WebSocketFrame)frame;
    copy(wsf,wsf.data);
  }
 else {
    fin=frame.isFin();
    rsv1=frame.isRsv1();
    rsv2=frame.isRsv2();
    rsv3=frame.isRsv3();
    opcode=frame.getType().getOpCode();
    type=frame.getType();
    masked=frame.isMasked();
    mask=null;
    byte maskCopy[]=frame.getMask();
    if (maskCopy != null) {
      mask=new byte[maskCopy.length];
      System.arraycopy(maskCopy,0,mask,0,mask.length);
    }
    setPayload(frame.getPayload());
  }
}
