{
  if (buf == null) {
    data=null;
    return this;
  }
  if (OpCode.isControlFrame(opcode)) {
    if (buf.length > WebSocketFrame.MAX_CONTROL_PAYLOAD) {
      throw new ProtocolException("Control Payloads can not exceed 125 bytes in length.");
    }
  }
  data=BufferUtil.toBuffer(buf);
  payloadStart=data.position();
  payloadLength=data.remaining();
  return this;
}
