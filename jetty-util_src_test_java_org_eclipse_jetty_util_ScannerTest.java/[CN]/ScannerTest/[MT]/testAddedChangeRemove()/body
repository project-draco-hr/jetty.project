{
  assumeNotWindows();
  touch("a0");
  _scanner.scan();
  _scanner.scan();
  Event event=_queue.poll();
  Assert.assertTrue(event != null);
  Assert.assertEquals(_directory + "/a0",event._filename);
  Assert.assertEquals(Notification.ADDED,event._notification);
  Thread.sleep(1100);
  touch("a1");
  touch("a2");
  touch("a3");
  _scanner.scan();
  event=_queue.poll();
  Assert.assertTrue(event == null);
  Thread.sleep(1100);
  touch("a2");
  delete("a3");
  _scanner.scan();
  event=_queue.poll();
  Assert.assertTrue(event != null);
  Assert.assertEquals(_directory + "/a1",event._filename);
  Assert.assertEquals(Notification.ADDED,event._notification);
  Assert.assertTrue(_queue.isEmpty());
  _scanner.scan();
  event=_queue.poll();
  Assert.assertTrue(event != null);
  Assert.assertEquals(_directory + "/a2",event._filename);
  Assert.assertEquals(Notification.ADDED,event._notification);
  Assert.assertTrue(_queue.isEmpty());
  Thread.sleep(1100);
  touch("a1");
  touch("a2");
  _scanner.scan();
  event=_queue.poll();
  Assert.assertTrue(event == null);
  Thread.sleep(1100);
  touch("a2");
  _scanner.scan();
  event=_queue.poll();
  Assert.assertTrue(event != null);
  Assert.assertEquals(_directory + "/a1",event._filename);
  Assert.assertEquals(Notification.CHANGED,event._notification);
  Assert.assertTrue(_queue.isEmpty());
  _scanner.scan();
  event=_queue.poll();
  Assert.assertTrue(event != null);
  Assert.assertEquals(_directory + "/a2",event._filename);
  Assert.assertEquals(Notification.CHANGED,event._notification);
  Assert.assertTrue(_queue.isEmpty());
  delete("a1");
  delete("a2");
  _scanner.scan();
  event=_queue.poll();
  Assert.assertTrue(event == null);
  touch("a2");
  _scanner.scan();
  event=_queue.poll();
  Assert.assertTrue(event != null);
  Assert.assertEquals(_directory + "/a1",event._filename);
  Assert.assertEquals(Notification.REMOVED,event._notification);
  Assert.assertTrue(_queue.isEmpty());
  _scanner.scan();
  event=_queue.poll();
  Assert.assertTrue(event != null);
  Assert.assertEquals(_directory + "/a2",event._filename);
  Assert.assertEquals(Notification.CHANGED,event._notification);
  Assert.assertTrue(_queue.isEmpty());
}
