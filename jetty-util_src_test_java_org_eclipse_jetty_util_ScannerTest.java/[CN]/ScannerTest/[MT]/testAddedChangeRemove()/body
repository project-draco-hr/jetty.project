{
  assumeNotWindows();
  touch("a0");
  Event event=_queue.poll(10000,TimeUnit.MILLISECONDS);
  Assert.assertTrue(event != null);
  Assert.assertEquals(_directory + "/a0",event._filename);
  Assert.assertEquals(Notification.ADDED,event._notification);
  touch("a1");
  touch("a2");
  touch("a3");
  event=_queue.poll(1100,TimeUnit.MILLISECONDS);
  Assert.assertTrue(event == null);
  touch("a2");
  delete("a3");
  event=_queue.poll(1900,TimeUnit.MILLISECONDS);
  Assert.assertTrue(event != null);
  Assert.assertEquals(_directory + "/a1",event._filename);
  Assert.assertEquals(Notification.ADDED,event._notification);
  Assert.assertTrue(_queue.isEmpty());
  event=_queue.poll(1900,TimeUnit.MILLISECONDS);
  Assert.assertTrue(event != null);
  Assert.assertEquals(_directory + "/a2",event._filename);
  Assert.assertEquals(Notification.ADDED,event._notification);
  Assert.assertTrue(_queue.isEmpty());
  touch("a1");
  touch("a2");
  event=_queue.poll(1100,TimeUnit.MILLISECONDS);
  Assert.assertTrue(event == null);
  touch("a2");
  event=_queue.poll(1900,TimeUnit.MILLISECONDS);
  Assert.assertTrue(event != null);
  Assert.assertEquals(_directory + "/a1",event._filename);
  Assert.assertEquals(Notification.CHANGED,event._notification);
  Assert.assertTrue(_queue.isEmpty());
  event=_queue.poll(1900,TimeUnit.MILLISECONDS);
  Assert.assertTrue(event != null);
  Assert.assertEquals(_directory + "/a2",event._filename);
  Assert.assertEquals(Notification.CHANGED,event._notification);
  Assert.assertTrue(_queue.isEmpty());
  delete("a1");
  delete("a2");
  event=_queue.poll(1100,TimeUnit.MILLISECONDS);
  Assert.assertTrue(event == null);
  touch("a2");
  event=_queue.poll(1900,TimeUnit.MILLISECONDS);
  Assert.assertTrue(event != null);
  Assert.assertEquals(_directory + "/a1",event._filename);
  Assert.assertEquals(Notification.REMOVED,event._notification);
  Assert.assertTrue(_queue.isEmpty());
  event=_queue.poll(1900,TimeUnit.MILLISECONDS);
  Assert.assertTrue(event != null);
  Assert.assertEquals(_directory + "/a2",event._filename);
  Assert.assertEquals(Notification.CHANGED,event._notification);
  Assert.assertTrue(_queue.isEmpty());
}
