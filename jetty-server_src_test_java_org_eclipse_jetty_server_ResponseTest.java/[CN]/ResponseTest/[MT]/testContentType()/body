{
  Response response=newResponse();
  assertEquals(null,response.getContentType());
  response.setHeader("Content-Type","text/something");
  assertEquals("text/something",response.getContentType());
  response.setContentType("foo/bar");
  assertEquals("foo/bar",response.getContentType());
  response.getWriter();
  assertEquals("foo/bar;charset=iso-8859-1",response.getContentType());
  response.setContentType("foo2/bar2");
  assertEquals("foo2/bar2;charset=iso-8859-1",response.getContentType());
  response.setHeader("name","foo");
  Iterator<String> en=response.getHeaders("name").iterator();
  assertEquals("foo",en.next());
  assertFalse(en.hasNext());
  response.addHeader("name","bar");
  en=response.getHeaders("name").iterator();
  assertEquals("foo",en.next());
  assertEquals("bar",en.next());
  assertFalse(en.hasNext());
  response.recycle();
  response.setContentType("text/html");
  assertEquals("text/html",response.getContentType());
  response.getWriter();
  assertEquals("text/html;charset=iso-8859-1",response.getContentType());
  response.setContentType("foo2/bar2");
  assertEquals("foo2/bar2;charset=iso-8859-1",response.getContentType());
  response.recycle();
  response.setContentType("text/xml;charset=ISO-8859-7");
  response.getWriter();
  assertEquals("text/xml;charset=ISO-8859-7",response.getContentType());
  response.setContentType("text/html;charset=UTF-8");
  assertEquals("text/html;charset=ISO-8859-7",response.getContentType());
  response.recycle();
  response.setContentType("text/html;charset=US-ASCII");
  response.getWriter();
  assertEquals("text/html;charset=US-ASCII",response.getContentType());
  response.recycle();
  response.setContentType("text/html; charset=UTF-8");
  response.getWriter();
  assertEquals("text/html;charset=utf-8",response.getContentType());
  response.recycle();
  response.setContentType("text/json");
  response.getWriter();
  assertEquals("text/json",response.getContentType());
  response.recycle();
  response.setContentType("text/json");
  response.setCharacterEncoding("UTF-8");
  response.getWriter();
  assertEquals("text/json;charset=utf-8",response.getContentType());
  response.recycle();
  response.setCharacterEncoding("xyz");
  response.setContentType("foo/bar");
  assertEquals("foo/bar;charset=xyz",response.getContentType());
  response.recycle();
  response.setContentType("foo/bar");
  response.setCharacterEncoding("xyz");
  assertEquals("foo/bar;charset=xyz",response.getContentType());
  response.recycle();
  response.setCharacterEncoding("xyz");
  response.setContentType("foo/bar;charset=abc");
  assertEquals("foo/bar;charset=abc",response.getContentType());
  response.recycle();
  response.setContentType("foo/bar;charset=abc");
  response.setCharacterEncoding("xyz");
  assertEquals("foo/bar;charset=xyz",response.getContentType());
  response.recycle();
  response.setCharacterEncoding("xyz");
  response.setContentType("foo/bar");
  response.setCharacterEncoding(null);
  assertEquals("foo/bar",response.getContentType());
  response.recycle();
  response.setCharacterEncoding("xyz");
  response.setCharacterEncoding(null);
  response.setContentType("foo/bar");
  assertEquals("foo/bar",response.getContentType());
  response.recycle();
  response.addHeader("Content-Type","text/something");
  assertEquals("text/something",response.getContentType());
  response.recycle();
  response.addHeader("Content-Type","application/json");
  response.getWriter();
  assertEquals("application/json",response.getContentType());
}
