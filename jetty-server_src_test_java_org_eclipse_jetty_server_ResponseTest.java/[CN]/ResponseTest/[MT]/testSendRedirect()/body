{
  String[][] tests={{"/other/location?name=value","http://myhost:8888/other/location;jsessionid=12345?name=value"},{"../locati%C3%abn","http://myhost:8888/locati%C3%ABn"}};
  for (int i=1; i < tests.length; i++) {
    Response response=newResponse();
    Request request=response.getHttpChannel().getRequest();
    request.setServerName("myhost");
    request.setServerPort(8888);
    request.setUri(new HttpURI("/path/info;param;jsessionid=12345?query=0&more=1#target"));
    request.setContextPath("/path");
    request.setRequestedSessionId("12345");
    request.setRequestedSessionIdFromCookie(i > 0);
    HashSessionManager manager=new HashSessionManager();
    manager.setSessionIdManager(new HashSessionIdManager());
    request.setSessionManager(manager);
    request.setSession(new TestSession(manager,"12345"));
    manager.setCheckingRemoteSessionIdEncoding(false);
    response.sendRedirect(tests[i][0]);
    String location=response.getHeader("Location");
    assertEquals(tests[i][0],tests[i][1],location);
  }
}
