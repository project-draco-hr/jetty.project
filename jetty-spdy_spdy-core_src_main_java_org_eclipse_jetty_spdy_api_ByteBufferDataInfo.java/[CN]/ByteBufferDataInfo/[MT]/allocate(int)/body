{
  return buffer.isDirect() ? ByteBuffer.allocateDirect(size) : super.allocate(size);
}
