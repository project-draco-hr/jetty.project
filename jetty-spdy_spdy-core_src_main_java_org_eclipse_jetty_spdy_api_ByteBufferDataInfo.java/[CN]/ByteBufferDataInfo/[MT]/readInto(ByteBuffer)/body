{
  int space=output.remaining();
  if (available() > space) {
    int limit=buffer.limit();
    buffer.limit(buffer.position() + space);
    output.put(buffer);
    buffer.limit(limit);
  }
 else {
    space=buffer.remaining();
    output.put(buffer);
  }
  return space;
}
