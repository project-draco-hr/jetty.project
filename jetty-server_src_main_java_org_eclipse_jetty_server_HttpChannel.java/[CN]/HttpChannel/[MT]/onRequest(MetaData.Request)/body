{
  _requests.incrementAndGet();
  _request.setTimeStamp(System.currentTimeMillis());
  _request.setHttpVersion(_version=request.getHttpVersion());
  _request.setMethod(request.getMethod());
  _request.setScheme(request.getScheme().asString());
  HttpURI uri=request.getURI();
  String uriHost=uri.getHost();
  if (uriHost != null) {
    _request.setServerName(uriHost);
    _request.setServerPort(uri.getPort());
  }
 else {
    _request.setServerName(request.getHost());
    _request.setServerPort(request.getPort());
  }
  _request.setUri(request.getURI());
  String path;
  try {
    path=uri.getDecodedPath();
  }
 catch (  Exception e) {
    LOG.warn("Failed UTF-8 decode for request path, trying ISO-8859-1");
    LOG.ignore(e);
    path=uri.getDecodedPath(StandardCharsets.ISO_8859_1);
  }
  String info=URIUtil.canonicalPath(path);
  if (info == null) {
    if (path == null && uri.getScheme() != null && uri.getHost() != null) {
      info="/";
      _request.setRequestURI("");
    }
 else     throw new BadMessageException(400,"Bad URI");
  }
  _request.setPathInfo(info);
  _request.getHttpFields().addAll(request.getFields());
  if (_configuration.getSendDateHeader())   _response.getHttpFields().put(_connector.getServer().getDateField());
}
