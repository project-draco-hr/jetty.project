{
  int status=info.getStatus();
  try {
    String reason=info.getReason();
    if (reason == null)     reason=HttpStatus.getMessage(status);
    if (status != Response.SC_NO_CONTENT && status != Response.SC_NOT_MODIFIED && status != Response.SC_PARTIAL_CONTENT && status >= Response.SC_OK) {
      ErrorHandler errorHandler=null;
      ContextHandler.Context context=_request.getContext();
      if (context != null)       errorHandler=context.getContextHandler().getErrorHandler();
      if (errorHandler == null)       errorHandler=getServer().getBean(ErrorHandler.class);
      if (errorHandler != null) {
        _request.setAttribute(RequestDispatcher.ERROR_STATUS_CODE,new Integer(status));
        _request.setAttribute(RequestDispatcher.ERROR_MESSAGE,reason);
        _request.setAttribute(RequestDispatcher.ERROR_REQUEST_URI,_request.getRequestURI());
        _request.setAttribute(RequestDispatcher.ERROR_SERVLET_NAME,_request.getServletName());
        errorHandler.handle(null,_request,_request,_response);
      }
 else {
        HttpFields fields=info.getHttpFields();
        fields.put(HttpHeader.CACHE_CONTROL,"must-revalidate,no-cache,no-store");
        fields.put(HttpHeader.CONTENT_TYPE,MimeTypes.Type.TEXT_HTML_8859_1.toString());
        reason=escape(reason);
        String uri=escape(_request.getRequestURI());
        extraContent=escape(extraContent);
        StringBuilder writer=new StringBuilder(2048);
        writer.append("<html>\n");
        writer.append("<head>\n");
        writer.append("<meta http-equiv=\"Content-Type\" content=\"text/html;charset=ISO-8859-1\"/>\n");
        writer.append("<title>Error ").append(Integer.toString(status)).append(' ').append(reason).append("</title>\n");
        writer.append("</head>\n");
        writer.append("<body>\n");
        writer.append("<h2>HTTP ERROR: ").append(Integer.toString(status)).append("</h2>\n");
        writer.append("<p>Problem accessing ").append(uri).append(". Reason:\n");
        writer.append("<pre>").append(reason).append("</pre></p>");
        if (extraContent != null)         writer.append("<p>").append(extraContent).append("</p>");
        writer.append("<hr /><i><small>Powered by Jetty://</small></i>\n");
        writer.append("</body>\n");
        writer.append("</html>");
        byte[] bytes=writer.toString().getBytes(StringUtil.__ISO_8859_1);
        fields.put(HttpHeader.CONTENT_LENGTH,String.valueOf(bytes.length));
        _response.getOutputStream().write(bytes);
      }
    }
 else     if (status != Response.SC_PARTIAL_CONTENT) {
    }
    complete();
    if (_state.isIdle())     _state.complete();
    _request.getHttpInput().shutdown();
  }
 catch (  IOException x) {
    LOG.debug("Could not write error response " + status,x);
  }
}
