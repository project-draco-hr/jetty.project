{
  getOutputStream();
  if (_writer == null) {
    _writer=new HttpWriter(_out);
    if (_server.isUncheckedPrintWriter())     _printWriter=new UncheckedPrintWriter(_writer);
 else     _printWriter=new PrintWriter(_writer){
      public void close(){
synchronized (lock) {
          try {
            out.close();
          }
 catch (          IOException e) {
            setError();
          }
        }
      }
    }
;
  }
  _writer.setCharacterEncoding(charset);
  return _printWriter;
}
