{
  LOG.debug("{} sendError {} {}",this,status,reason);
  if (_response.isCommitted())   return false;
  try {
    _response.setStatus(status,reason);
    _response.getHttpFields().add(HttpHeader.CONNECTION,HttpHeaderValue.CLOSE);
    ByteBuffer buffer=null;
    if (content != null) {
      buffer=BufferUtil.toBuffer(content,StringUtil.__UTF8_CHARSET);
      _response.setContentLength(buffer.remaining());
    }
    HttpGenerator.ResponseInfo info=_handler.commit();
    try {
      write(info,buffer).get();
    }
 catch (    final InterruptedException e) {
      throw new InterruptedIOException(){
{
          this.initCause(e);
        }
      }
;
    }
catch (    final ExecutionException e) {
      throw new IOException(){
{
          this.initCause(e);
        }
      }
;
    }
    return true;
  }
 catch (  Exception e) {
    e.printStackTrace();
    LOG.debug("failed to sendError {} {}",status,reason,e);
  }
 finally {
    if (_state.isIdle())     _state.complete();
    _request.getHttpInput().shutdownInput();
  }
  return false;
}
