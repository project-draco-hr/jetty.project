{
  if (x instanceof EofException || x instanceof ClosedChannelException) {
    LOG.debug(x);
    _callback.failed(x);
    _response.getHttpOutput().closed();
  }
 else {
    LOG.warn("Commit failed",x);
    _transport.send(HttpGenerator.RESPONSE_500_INFO,null,true,new Callback(){
      @Override public void succeeded(){
        _callback.failed(x);
        _response.getHttpOutput().closed();
      }
      @Override public void failed(      Throwable th){
        LOG.ignore(th);
        _callback.failed(x);
        _response.getHttpOutput().closed();
      }
    }
);
  }
}
