{
  final String target=connection.getRequest().getPathInfo();
  final Request request=connection.getRequest();
  final Response response=connection.getResponse();
  if (LOG.isDebugEnabled())   LOG.debug("{} on {}{}",request.getDispatcherType(),connection,"\n" + request.getMethod() + " "+ request.getHttpURI()+ "\n"+ request.getHttpFields());
  if (HttpMethod.OPTIONS.is(request.getMethod()) || "*".equals(target)) {
    if (!HttpMethod.OPTIONS.is(request.getMethod()))     response.sendError(HttpStatus.BAD_REQUEST_400);
    handleOptions(request,response);
    if (!request.isHandled())     handle(target,request,request,response);
  }
 else   handle(target,request,request,response);
  if (LOG.isDebugEnabled())   LOG.debug("RESPONSE for {} h={}{}",target,request.isHandled(),"\n" + response.getStatus() + " "+ response.getReason()+ "\n"+ response.getHttpFields());
}
