{
  LOG.debug(_session + " flush");
  if (isBufferingOutput()) {
    int flushed=super.flush(_outNIOBuffer);
    if (_debug)     LOG.debug(_session + " flushed " + flushed+ " left="+ _outNIOBuffer.length());
  }
 else   if (_engine.isOutboundDone() && !super.isOutputShutdown()) {
    if (_debug)     LOG.debug(_session + " flush shutdownOutput");
    super.shutdownOutput();
  }
}
