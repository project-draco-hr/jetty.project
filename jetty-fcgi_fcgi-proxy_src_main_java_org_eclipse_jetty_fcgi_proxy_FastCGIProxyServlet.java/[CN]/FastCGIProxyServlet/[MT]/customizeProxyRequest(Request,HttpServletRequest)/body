{
  proxyRequest.attribute(REMOTE_ADDR_ATTRIBUTE,request.getRemoteAddr());
  proxyRequest.attribute(REMOTE_PORT_ATTRIBUTE,String.valueOf(request.getRemotePort()));
  proxyRequest.attribute(SERVER_NAME_ATTRIBUTE,request.getServerName());
  proxyRequest.attribute(SERVER_ADDR_ATTRIBUTE,request.getLocalAddr());
  proxyRequest.attribute(SERVER_PORT_ATTRIBUTE,String.valueOf(request.getLocalPort()));
  proxyRequest.attribute(SCHEME_ATTRIBUTE,request.getScheme());
  String originalPath=(String)request.getAttribute(RequestDispatcher.FORWARD_REQUEST_URI);
  String originalQuery=(String)request.getAttribute(RequestDispatcher.FORWARD_QUERY_STRING);
  if (originalPath == null) {
    originalPath=(String)request.getAttribute(RequestDispatcher.INCLUDE_REQUEST_URI);
    originalQuery=(String)request.getAttribute(RequestDispatcher.INCLUDE_QUERY_STRING);
  }
  if (originalPath != null) {
    String originalURI=originalPath;
    if (originalQuery != null)     originalURI+="?" + originalQuery;
    proxyRequest.attribute(REQUEST_URI_ATTRIBUTE,originalURI);
  }
  super.customizeProxyRequest(proxyRequest,request);
}
