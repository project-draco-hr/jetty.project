{
  SelectChannelConnector connector=(SelectChannelConnector)_connector;
  Socket socket=new Socket((String)null,connector.getLocalPort());
  socket.getOutputStream().write(request.getBytes("UTF-8"));
  InputStream inputStream=socket.getInputStream();
  String response=IO.toString(inputStream);
  Thread.sleep(500);
  assertEquals("Socket should be closed and return -1 on reading",-1,socket.getInputStream().read());
  return response;
}
