{
  Server server=new Server();
  ServerConnector connector=new ServerConnector(server);
  connector.setPort(8080);
  server.addConnector(connector);
  String root="/home/simon/programs/wordpress-3.6.1";
  ServletContextHandler context=new ServletContextHandler(server,"/");
  context.setResourceBase(root);
  context.setWelcomeFiles(new String[]{"index.php"});
  ServletHolder defaultServlet=new ServletHolder(DefaultServlet.class);
  defaultServlet.setName("default");
  context.addServlet(defaultServlet,"/");
  context.addFilter(WordPressFilter.class,"/index.php/*",EnumSet.of(DispatcherType.REQUEST));
  ServletHolder fcgiServlet=new ServletHolder(FastCGIProxyServlet.class);
  fcgiServlet.setInitParameter(FastCGIProxyServlet.SCRIPT_ROOT_INIT_PARAM,root);
  fcgiServlet.setInitParameter("proxyTo","http://localhost:9000");
  fcgiServlet.setInitParameter("prefix","/");
  fcgiServlet.setInitParameter(FastCGIProxyServlet.SCRIPT_PATTERN_INIT_PARAM,"/index\\.php(.+\\.php)");
  context.addServlet(fcgiServlet,"*.php");
  server.start();
}
