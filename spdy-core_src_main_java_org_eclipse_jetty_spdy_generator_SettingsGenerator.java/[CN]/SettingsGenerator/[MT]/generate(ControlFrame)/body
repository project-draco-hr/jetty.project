{
  SettingsFrame settings=(SettingsFrame)frame;
  Map<SettingsInfo.Key,Integer> pairs=settings.getSettings();
  int size=pairs.size();
  int frameBodyLength=4 + 8 * size;
  int totalLength=ControlFrame.HEADER_LENGTH + frameBodyLength;
  ByteBuffer buffer=ByteBuffer.allocate(totalLength);
  generateControlFrameHeader(settings,frameBodyLength,buffer);
  buffer.putInt(size);
  for (  Map.Entry<SettingsInfo.Key,Integer> entry : pairs.entrySet()) {
    int idAndFlags=convertIdAndFlags(frame.getVersion(),entry.getKey().getKey());
    buffer.putInt(idAndFlags);
    buffer.putInt(entry.getValue());
  }
  buffer.flip();
  return buffer;
}
