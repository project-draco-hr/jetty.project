{
  StringBuffer req1=new StringBuffer();
  req1.append("GET /tests/R1 HTTP/1.1\n");
  req1.append("Host: localhost\n");
  req1.append("Transfer-Encoding: chunked,identity\n");
  req1.append("Content-Type: text/plain\n");
  req1.append("Connection: close\n");
  req1.append("\r\n");
  req1.append("5;\r\n");
  req1.append("123\r\n\r\n");
  req1.append("0;\r\n\r\n");
  response=http.request(req1);
  response.assertStatus("3.6 Transfer Coding / Bad 400",HttpStatus.BAD_REQUEST_400);
  StringBuffer req2=new StringBuffer();
  req2.append("GET /echo/R1 HTTP/1.1\n");
  req2.append("Host: localhost\n");
  req2.append("Transfer-Encoding: chunked\n");
  req2.append("Content-Type: text/plain\n");
  req2.append("\n");
  req2.append("2;\n");
  req2.append("12\n");
  req2.append("3;\n");
  req2.append("345\n");
  req2.append("0;\n\n");
  req2.append("GET /echo/R2 HTTP/1.1\n");
  req2.append("Host: localhost\n");
  req2.append("Transfer-Encoding: chunked\n");
  req2.append("Content-Type: text/plain\n");
  req2.append("\n");
  req2.append("4;\n");
  req2.append("6789\n");
  req2.append("5;\n");
  req2.append("abcde\n");
  req2.append("0;\n\n");
  req2.append("GET /echo/R3 HTTP/1.1\n");
  req2.append("Host: localhost\n");
  req2.append("Connection: close\n");
  req2.append("\n");
  responses=http.requests(req2);
  Assert.assertEquals("Response Count",3,responses.size());
  response=responses.get(0);
  response.assertStatusOK("3.6.1 Transfer Codings / Response 1 Code");
  response.assertBody("3.6.1 Transfer Codings / Chunked String","12345\n");
  response=responses.get(1);
  response.assertStatusOK("3.6.1 Transfer Codings / Response 2 Code");
  response.assertBody("3.6.1 Transfer Codings / Chunked String","6789abcde\n");
  response=responses.get(2);
  response.assertStatusOK("3.6.1 Transfer Codings / Response 3 Code");
  response.assertNoBody("3.6.1 Transfer Codings / No Body");
  StringBuffer req3=new StringBuffer();
  req3.append("POST /echo/R1 HTTP/1.1\n");
  req3.append("Host: localhost\n");
  req3.append("Transfer-Encoding: chunked\n");
  req3.append("Content-Type: text/plain\n");
  req3.append("\n");
  req3.append("3;\n");
  req3.append("fgh\n");
  req3.append("3;\n");
  req3.append("Ijk\n");
  req3.append("0;\n\n");
  req3.append("POST /echo/R2 HTTP/1.1\n");
  req3.append("Host: localhost\n");
  req3.append("Transfer-Encoding: chunked\n");
  req3.append("Content-Type: text/plain\n");
  req3.append("\n");
  req3.append("4;\n");
  req3.append("lmno\n");
  req3.append("5;\n");
  req3.append("Pqrst\n");
  req3.append("0;\n\n");
  req3.append("GET /echo/R3 HTTP/1.1\n");
  req3.append("Host: localhost\n");
  req3.append("Connection: close\n");
  req3.append("\n");
  responses=http.requests(req3);
  Assert.assertEquals("Response Count",3,responses.size());
  response=responses.get(0);
  response.assertStatusOK("3.6.1 Transfer Codings / Response 1 Code");
  response.assertBody("3.6.1 Transfer Codings / Chunked String","fghIjk\n");
  response=responses.get(1);
  response.assertStatusOK("3.6.1 Transfer Codings / Response 2 Code");
  response.assertBody("3.6.1 Transfer Codings / Chunked String","lmnoPqrst\n");
  response=responses.get(2);
  response.assertStatusOK("3.6.1 Transfer Codings / Response 3 Code");
  response.assertNoBody("3.6.1 Transfer Codings / No Body");
  StringBuffer req4=new StringBuffer();
  req4.append("GET /echo/R1 HTTP/1.1\n");
  req4.append("Host: localhost\n");
  req4.append("Transfer-Encoding: chunked\n");
  req4.append("Content-Type: text/plain\n");
  req4.append("Connection: keep-alive\n");
  req4.append("\n");
  req4.append("3;\n");
  req4.append("123\n");
  req4.append("3;\n");
  req4.append("456\n");
  req4.append("0;\n\n");
  req4.append("GET /echo/R2 HTTP/1.1\n");
  req4.append("Host: localhost\n");
  req4.append("Connection: close\n");
  req4.append("\n");
  responses=http.requests(req4);
  Assert.assertEquals("Response Count",2,responses.size());
  response=responses.get(0);
  response.assertStatusOK("3.6.1 Transfer Codings / Response 1 Code");
  response.assertBody("3.6.1 Transfer Codings / Chunked String","123456\n");
  response=responses.get(1);
  response.assertStatusOK("3.6.1 Transfer Codings / Response 2 Code");
  response.assertNoBody("3.6.1 Transfer Codings / No Body");
}
