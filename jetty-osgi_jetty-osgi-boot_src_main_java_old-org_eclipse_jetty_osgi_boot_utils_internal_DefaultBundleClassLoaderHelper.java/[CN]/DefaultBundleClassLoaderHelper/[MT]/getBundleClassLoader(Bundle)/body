{
  String bundleActivator=(String)bundle.getHeaders().get("Bundle-Activator");
  if (bundleActivator == null) {
    bundleActivator=(String)bundle.getHeaders().get("Jetty-ClassInBundle");
  }
  if (bundleActivator != null) {
    try {
      return bundle.loadClass(bundleActivator).getClassLoader();
    }
 catch (    ClassNotFoundException e) {
      e.printStackTrace();
    }
  }
  if (!identifiedOsgiImpl) {
    init(bundle);
  }
  if (BundleClass_adapt_method != null && BundleWiringClass_getClassLoader_method != null) {
    try {
      Object bundleWiring=BundleClass_adapt_method.invoke(bundle,BundleWiringClass);
      return (ClassLoader)BundleWiringClass_getClassLoader_method.invoke(bundleWiring,new Object[]{});
    }
 catch (    Throwable t) {
      t.printStackTrace();
      return null;
    }
  }
  if (isEquinox) {
    return internalGetEquinoxBundleClassLoader(bundle);
  }
 else   if (isFelix) {
    return internalGetFelixBundleClassLoader(bundle);
  }
  return null;
}
