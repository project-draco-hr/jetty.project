{
switch (_state) {
case START:
    return Result.NEED_COMMIT;
case COMMITTED:
  if (isChunking()) {
    if (chunk == null)     return Result.NEED_CHUNK;
    if (BufferUtil.hasContent(buffer)) {
      BufferUtil.clearToFill(chunk);
      prepareChunk(chunk,buffer.remaining());
      BufferUtil.flipToFlush(chunk,0);
    }
  }
}
return Result.FLUSH;
}
