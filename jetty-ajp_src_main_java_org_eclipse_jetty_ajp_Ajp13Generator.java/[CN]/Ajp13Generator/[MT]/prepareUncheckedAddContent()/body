{
  if (_noContent)   return -1;
  if (_last || _state == STATE_END)   throw new IllegalStateException("Closed");
  if (!_endp.isOpen()) {
    _state=STATE_END;
    return -1;
  }
  Buffer content=_content;
  if (content != null && content.length() > 0) {
    flushBuffer();
    if (content != null && content.length() > 0)     throw new IllegalStateException("FULL");
  }
  initContent();
  _contentWritten-=_buffer.length();
  if (_head)   return Integer.MAX_VALUE;
  return _buffer.space() - 1;
}
