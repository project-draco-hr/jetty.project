{
  HttpExchange exchange=getHttpExchange();
  if (exchange == null)   return;
  Request request=exchange.getRequest();
  if (!headersToCommit(request))   return;
  HttpContent content=HttpSender.this.content;
  if (!content.hasContent()) {
    someToSuccess(exchange);
  }
 else {
    ByteBuffer contentBuffer=content.getContent();
    if (contentBuffer != null) {
      if (!someToContent(request,contentBuffer))       return;
    }
    while (true) {
      SenderState current=senderState.get();
switch (current) {
case SENDING:
{
          contentCallback.iterate();
          return;
        }
case SENDING_WITH_CONTENT:
{
        updateSenderState(current,SenderState.SENDING);
        break;
      }
case EXPECTING:
{
      if (updateSenderState(current,SenderState.WAITING))       return;
      break;
    }
case EXPECTING_WITH_CONTENT:
{
    if (updateSenderState(current,SenderState.WAITING))     return;
    break;
  }
case PROCEEDING:
{
  if (updateSenderState(current,SenderState.IDLE))   return;
  break;
}
case PROCEEDING_WITH_CONTENT:
{
updateSenderState(current,SenderState.SENDING);
break;
}
default :
{
throw illegalSenderState(current);
}
}
}
}
}
