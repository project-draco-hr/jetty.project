{
  generator.abort();
  failed=true;
  HttpExchange exchange=connection.getExchange();
  Request request=exchange.request();
  LOG.debug("Failed {} {}",request,failure);
  Result result=exchange.requestComplete(failure);
  if (result == null && !committed)   result=exchange.responseComplete(null);
  if (result == null)   connection.getEndPoint().shutdownOutput();
  requestNotifier.notifyFailure(request,failure);
  if (result != null) {
    HttpConversation conversation=exchange.conversation();
    responseNotifier.notifyComplete(conversation.listener(),result);
  }
}
