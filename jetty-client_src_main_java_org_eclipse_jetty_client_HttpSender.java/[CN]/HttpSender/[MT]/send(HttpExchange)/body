{
  Request request=exchange.getRequest();
  if (!queuedToBegin(request))   return;
  ContentProvider contentProvider=request.getContent();
  HttpContent content=this.content=new HttpContent(contentProvider);
  SenderState newSenderState=SenderState.SENDING;
  if (expects100Continue(request))   newSenderState=content.hasContent() ? SenderState.EXPECTING_WITH_CONTENT : SenderState.EXPECTING;
  if (!updateSenderState(SenderState.IDLE,newSenderState))   throw illegalSenderState(SenderState.IDLE);
  if (contentProvider instanceof AsyncContentProvider)   ((AsyncContentProvider)contentProvider).setListener(this);
  if (!beginToHeaders(request))   return;
  sendHeaders(exchange,content,commitCallback);
}
