{
  firstResourceAdded.compareAndSet(-1,System.nanoTime());
  long delay=TimeUnit.NANOSECONDS.toMillis(System.nanoTime() - firstResourceAdded.get());
  if (!referrer.startsWith(origin) && !isPushOriginAllowed(origin)) {
    if (LOG.isDebugEnabled())     LOG.debug("Skipped store of push metadata {} for {}: Origin: {} doesn't match or origin not allowed",url,name,origin);
    return false;
  }
  if (resources.size() >= maxAssociatedResources) {
    if (LOG.isDebugEnabled())     LOG.debug("Skipped store of push metadata {} for {}: max associated resources ({}) reached",url,name,maxAssociatedResources);
    return false;
  }
  if (delay > referrerPushPeriod) {
    if (LOG.isDebugEnabled())     LOG.debug("Delay: {}ms longer than referrerPushPeriod ({}ms). Not adding resource: {} for: {}",delay,referrerPushPeriod,url,name);
    return false;
  }
  if (LOG.isDebugEnabled())   LOG.debug("Adding: {} to: {} with delay: {}ms.",url,this,delay);
  resources.add(url);
  return true;
}
