{
  Log.debug("ClosedIn {} {}",this,message);
  final boolean closedOut;
  final boolean closed;
synchronized (this) {
    closedOut=_closedOut;
    _closedIn=true;
    closed=_closeCode == 0;
    if (closed) {
      _closeCode=code;
      _closeMessage=message;
    }
  }
  try {
    if (closed)     _webSocket.onClose(code,message);
  }
  finally {
    try {
      if (closedOut)       _endp.close();
 else       closeOut(code,message);
    }
 catch (    IOException e) {
      Log.ignore(e);
    }
  }
}
