{
  endpointClientMetadataCache=new ConcurrentHashMap<>();
  decoderFactory=new DecoderFactory(PrimitiveDecoderMetadataSet.INSTANCE);
  encoderFactory=new EncoderFactory(PrimitiveEncoderMetadataSet.INSTANCE);
  EmptyClientEndpointConfig empty=new EmptyClientEndpointConfig();
  decoderFactory.init(empty);
  encoderFactory.init(empty);
  client=new WebSocketClient(executor);
  client.setEventDriverFactory(new JsrEventDriverFactory(client.getPolicy()));
  client.setSessionFactory(new JsrSessionFactory(this,this,client));
  addBean(client);
  ShutdownThread.register(this);
}
