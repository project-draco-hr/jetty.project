{
  List<WebSocketFrame> send1=new ArrayList<>();
  send1.add(new TextFrame("f1").setFin(false));
  send1.add(new ContinuationFrame(",f2").setFin(false));
  send1.add(new PingFrame("pong-1"));
  List<WebSocketFrame> send2=new ArrayList<>();
  send2.add(new ContinuationFrame(",f3").setFin(false));
  send2.add(new ContinuationFrame(",f4").setFin(false));
  send2.add(new PingFrame("pong-2"));
  send2.add(new ContinuationFrame(",f5").setFin(true));
  send2.add(new CloseInfo(StatusCode.NORMAL).asFrame());
  List<WebSocketFrame> expect1=new ArrayList<>();
  expect1.add(new PongFrame("pong-1"));
  List<WebSocketFrame> expect2=new ArrayList<>();
  expect2.add(new PongFrame("pong-2"));
  expect2.add(WebSocketFrame.text("f1,f2,f3,f4,f5"));
  expect2.add(new CloseInfo(StatusCode.NORMAL).asFrame());
  Fuzzer fuzzer=new Fuzzer(this);
  try (StacklessLogging supress=new StacklessLogging(Parser.class)){
    fuzzer.connect();
    fuzzer.setSendMode(Fuzzer.SendMode.SLOW);
    fuzzer.setSlowSendSegmentSize(1);
    fuzzer.send(send1);
    fuzzer.expect(expect1);
    TimeUnit.SECONDS.sleep(1);
    fuzzer.send(send2);
    fuzzer.expect(expect2);
  }
  finally {
    fuzzer.close();
  }
}
