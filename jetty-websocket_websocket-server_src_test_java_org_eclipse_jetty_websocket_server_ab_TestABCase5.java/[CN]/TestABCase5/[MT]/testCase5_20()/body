{
  List<WebSocketFrame> send1=new ArrayList<>();
  send1.add(new WebSocketFrame(OpCode.TEXT).setPayload("f1").setFin(false));
  send1.add(new WebSocketFrame(OpCode.CONTINUATION).setPayload(",f2").setFin(false));
  send1.add(new WebSocketFrame(OpCode.PING).setPayload("pong-1"));
  List<WebSocketFrame> send2=new ArrayList<>();
  send2.add(new WebSocketFrame(OpCode.CONTINUATION).setPayload(",f3").setFin(false));
  send2.add(new WebSocketFrame(OpCode.CONTINUATION).setPayload(",f4").setFin(false));
  send2.add(new WebSocketFrame(OpCode.PING).setPayload("pong-2"));
  send2.add(new WebSocketFrame(OpCode.CONTINUATION).setPayload(",f5").setFin(true));
  send2.add(new CloseInfo(StatusCode.NORMAL).asFrame());
  List<WebSocketFrame> expect1=new ArrayList<>();
  expect1.add(WebSocketFrame.pong().setPayload("pong-1"));
  List<WebSocketFrame> expect2=new ArrayList<>();
  expect2.add(WebSocketFrame.pong().setPayload("pong-2"));
  expect2.add(WebSocketFrame.text("f1,f2,f3,f4,f5"));
  expect2.add(new CloseInfo(StatusCode.NORMAL).asFrame());
  Fuzzer fuzzer=new Fuzzer(this);
  try {
    fuzzer.connect();
    fuzzer.setSendMode(Fuzzer.SendMode.PER_FRAME);
    fuzzer.send(send1);
    fuzzer.expect(expect1);
    TimeUnit.SECONDS.sleep(1);
    fuzzer.send(send2);
    fuzzer.expect(expect2);
  }
  finally {
    fuzzer.close();
  }
}
