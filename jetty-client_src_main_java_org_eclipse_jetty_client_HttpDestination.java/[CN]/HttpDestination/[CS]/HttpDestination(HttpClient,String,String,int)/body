{
  this.client=client;
  this.scheme=scheme;
  this.host=host;
  this.address=new Address(host,port);
  int maxRequestsQueued=client.getMaxRequestsQueuedPerDestination();
  int capacity=Math.min(32,maxRequestsQueued);
  this.exchanges=new BlockingArrayQueue<>(capacity,capacity,maxRequestsQueued);
  int maxConnections=client.getMaxConnectionsPerDestination();
  capacity=Math.min(8,maxConnections);
  this.idleConnections=new BlockingArrayQueue<>(capacity,capacity,maxConnections);
  this.activeConnections=new BlockingArrayQueue<>(capacity,capacity,maxConnections);
  this.requestNotifier=new RequestNotifier(client);
  this.responseNotifier=new ResponseNotifier(client);
  ProxyConfiguration proxyConfig=client.getProxyConfiguration();
  proxyAddress=proxyConfig != null && proxyConfig.matches(host,port) ? new Address(proxyConfig.getHost(),proxyConfig.getPort()) : null;
  hostField=new HttpField(HttpHeader.HOST,host + ":" + port);
}
