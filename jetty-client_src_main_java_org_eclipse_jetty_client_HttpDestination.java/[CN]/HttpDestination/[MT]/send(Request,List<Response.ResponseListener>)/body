{
  if (!scheme.equals(request.getScheme()))   throw new IllegalArgumentException("Invalid request scheme " + request.getScheme() + " for destination "+ this);
  if (!getHost().equals(request.getHost()))   throw new IllegalArgumentException("Invalid request host " + request.getHost() + " for destination "+ this);
  int port=request.getPort();
  if (port >= 0 && getPort() != port)   throw new IllegalArgumentException("Invalid request port " + port + " for destination "+ this);
  RequestContext requestContext=new RequestContext(request,listeners);
  if (client.isRunning()) {
    if (requests.offer(requestContext)) {
      if (!client.isRunning() && requests.remove(requestContext)) {
        throw new RejectedExecutionException(client + " is stopping");
      }
 else {
        LOG.debug("Queued {}",request);
        requestNotifier.notifyQueued(request);
        Connection connection=acquire();
        if (connection != null)         process(connection,false);
      }
    }
 else {
      throw new RejectedExecutionException("Max requests per destination " + client.getMaxRequestsQueuedPerDestination() + " exceeded");
    }
  }
 else {
    throw new RejectedExecutionException(client + " is stopped");
  }
}
