{
  if (!scheme.equals(request.getScheme()))   throw new IllegalArgumentException("Invalid request scheme " + request.getScheme() + " for destination "+ this);
  if (!host.equals(request.getHost()))   throw new IllegalArgumentException("Invalid request host " + request.getHost() + " for destination "+ this);
  int port=request.getPort();
  if (port >= 0 && this.port != port)   throw new IllegalArgumentException("Invalid request port " + port + " for destination "+ this);
  RequestPair requestPair=new RequestPair(request,listener);
  if (client.isRunning()) {
    if (requests.offer(requestPair)) {
      if (!client.isRunning() && requests.remove(requestPair)) {
        throw new RejectedExecutionException(client + " is stopping");
      }
 else {
        LOG.debug("Queued {}",request);
        requestNotifier.notifyQueued(request);
        Connection connection=acquire();
        if (connection != null)         process(connection,false);
      }
    }
 else {
      throw new RejectedExecutionException("Max requests per address " + client.getMaxQueueSizePerAddress() + " exceeded");
    }
  }
 else {
    throw new RejectedExecutionException(client + " is stopped");
  }
}
