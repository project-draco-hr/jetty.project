{
  if (!scheme.equals(request.scheme()))   throw new IllegalArgumentException("Invalid request scheme " + request.scheme() + " for destination "+ this);
  if (!host.equals(request.host()))   throw new IllegalArgumentException("Invalid request host " + request.host() + " for destination "+ this);
  if (request.port() > 0 && port != request.port())   throw new IllegalArgumentException("Invalid request port " + request.port() + " for destination "+ this);
  RequestPair requestPair=new RequestPair(request,listener);
  if (client.isRunning()) {
    if (requests.offer(requestPair)) {
      if (!client.isRunning() && requests.remove(requestPair)) {
        throw new RejectedExecutionException(client + " is stopping");
      }
 else {
        LOG.debug("Queued {}",request);
        requestNotifier.notifyQueued(request);
        Connection connection=acquire();
        if (connection != null)         process(connection,false);
      }
    }
 else {
      throw new RejectedExecutionException("Max requests per address " + client.getMaxQueueSizePerAddress() + " exceeded");
    }
  }
 else {
    throw new RejectedExecutionException(client + " is stopped");
  }
}
