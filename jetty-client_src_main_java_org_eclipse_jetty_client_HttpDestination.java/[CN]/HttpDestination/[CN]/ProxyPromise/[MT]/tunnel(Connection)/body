{
  String target=address.getHost() + ":" + address.getPort();
  Request connect=client.newRequest(proxyAddress.getHost(),proxyAddress.getPort()).scheme(HttpScheme.HTTP.asString()).method(HttpMethod.CONNECT).path(target).header(HttpHeader.HOST,target).timeout(client.getConnectTimeout(),TimeUnit.MILLISECONDS);
  connection.send(connect,new Response.CompleteListener(){
    @Override public void onComplete(    Result result){
      if (result.isFailed()) {
        failed(result.getFailure());
        connection.close();
      }
 else {
        Response response=result.getResponse();
        if (response.getStatus() == 200) {
          Connection tunnel=client.getTransport().tunnel(connection);
          delegate.succeeded(tunnel);
        }
 else {
          failed(new HttpResponseException("Received " + response + " for "+ result.getRequest(),response));
          connection.close();
        }
      }
    }
  }
);
}
