{
  int responseStatus=getResponseStatus();
  if (responseStatus == HttpStatus.OK_200) {
    proxyEndPoint.upgrade();
  }
 else   if (responseStatus == HttpStatus.GATEWAY_TIMEOUT_504) {
    onExpire();
  }
 else {
    onException(new ProtocolException("Proxy: " + proxyEndPoint.getRemoteAddr() + ":"+ proxyEndPoint.getRemotePort()+ " didn't return http return code 200, but "+ responseStatus+ " while trying to request: "+ exchange.getAddress().toString()));
  }
}
