{
  final CountDownLatch latch=new CountDownLatch(nb);
  long l0=System.currentTimeMillis();
  for (int i=0; i < nb; i++) {
    final int n=i;
    if (n % 1000 == 0) {
      Thread.sleep(200);
    }
    HttpExchange httpExchange=new HttpExchange(){
      @Override protected void onRequestCommitted(){
      }
      @Override protected void onResponseStatus(      ByteBuffer version,      int status,      ByteBuffer reason){
      }
      @Override protected void onResponseHeader(      ByteBuffer name,      ByteBuffer value){
      }
      @Override protected void onResponseContent(      ByteBuffer content){
      }
      @Override protected void onResponseComplete(){
        latch.countDown();
      }
    }
;
    httpExchange.setURL("http://localhost:" + _port + "/");
    httpExchange.addRequestHeader("arbitrary","value");
    _httpClient.send(httpExchange);
  }
  long last=latch.getCount();
  while (last > 0) {
    latch.await(5,TimeUnit.SECONDS);
    long next=latch.getCount();
    if (last == next)     break;
    last=next;
  }
  assertEquals(0,latch.getCount());
  long l1=System.currentTimeMillis();
}
