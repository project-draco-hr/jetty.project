{
  int remaining=buffer.remaining();
  AsyncEndPoint endPoint=getEndPoint();
  IOFuture write=endPoint.write(buffer);
  int written=remaining - buffer.remaining();
  if (write.isDone())   callback.completed(context);
 else   write.setCallback(callback,context);
  return written;
}
