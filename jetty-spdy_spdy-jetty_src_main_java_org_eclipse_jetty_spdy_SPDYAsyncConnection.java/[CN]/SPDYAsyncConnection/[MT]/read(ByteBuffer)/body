{
  AsyncEndPoint endPoint=getEndPoint();
  while (true) {
    int filled=fill(endPoint,buffer);
    if (filled == 0) {
      return 0;
    }
 else     if (filled < 0) {
      shutdown(session);
      return -1;
    }
 else {
      parser.parse(buffer);
    }
  }
}
