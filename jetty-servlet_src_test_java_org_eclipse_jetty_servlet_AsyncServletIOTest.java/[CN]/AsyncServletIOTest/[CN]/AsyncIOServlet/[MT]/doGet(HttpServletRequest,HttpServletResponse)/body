{
  final String[] writes=request.getParameterValues("w");
  final AsyncContext async=request.startAsync();
  final ServletOutputStream out=response.getOutputStream();
  out.setWriteListener(new WriteListener(){
    byte[] _owp="-\n".getBytes("ISO-8859-1");
    int _w=0;
    @Override public void onWritePossible() throws IOException {
      out.write(_owp);
      while (writes != null && _w < writes.length) {
        if (!out.isReady())         return;
        int write=Integer.valueOf(writes[_w++]);
        if (write == 0)         out.flush();
 else {
          byte[] buf=new byte[write + 1];
          Arrays.fill(buf,(byte)('0' + ((_w - 1) % 10)));
          buf[write]='\n';
          out.write(buf);
        }
        if (!out.isReady())         return;
      }
      if (!out.isReady())       return;
      async.complete();
    }
    @Override public void onError(    Throwable t){
      async.complete();
    }
  }
);
}
