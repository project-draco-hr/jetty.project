{
  if (keystore == null || collection == null) {
    Principal[] principals=null;
    return principals;
  }
  Set<Principal> principalSet=new HashSet<Principal>();
  for (Iterator<PrincipalEntry> i=collection.iterator(); i.hasNext(); ) {
    PrincipalEntry principal=i.next();
    try {
      Certificate certificate=keystore.getCertificate(principal.name);
      if (certificate instanceof X509Certificate) {
        principalSet.add(((X509Certificate)certificate).getSubjectX500Principal());
      }
    }
 catch (    KeyStoreException kse) {
      throw new PolicyException(kse);
    }
  }
  return principalSet.toArray(new Principal[principalSet.size()]);
}
