{
  try {
    BundleContext bc=JettyBootstrapActivator.getBundleContext();
    String location=file.toURI().toString();
    Bundle b=getBundle(bc,location);
    if (b == null) {
      b=bc.installBundle(location);
    }
    if (b == null) {
      Log.warn("The file " + location + " is not an OSGi bundle.");
      return null;
    }
    if (start && b.getHeaders().get(Constants.FRAGMENT_HOST) == null) {
      if (!PackageAdminServiceTracker.INSTANCE.frameworkHasCompletedAutostarts()) {
        if (_pendingBundlesToStart == null) {
          _pendingBundlesToStart=new HashSet<Bundle>();
        }
        _pendingBundlesToStart.add(b);
        return null;
      }
 else {
        b.start();
      }
    }
    return b;
  }
 catch (  BundleException e) {
    Log.warn("Unable to " + (start ? "start" : "install") + " the bundle "+ file.getAbsolutePath(),e);
  }
  return null;
}
