{
  try {
    ByteBuffer buf=ByteBuffer.wrap(new byte[]{0x00});
    BufferUtil.flipToFill(buf);
    int len=client.read(buf);
    Assert.assertThat("Server has not closed socket",len,lessThanOrEqualTo(0));
  }
 catch (  IOException e) {
  }
  IOState ios=client.getIOState();
  if (wasClean) {
    Assert.assertTrue(ios.wasRemoteCloseInitiated());
    Assert.assertTrue(ios.wasCleanClose());
  }
 else {
    Assert.assertTrue(ios.wasRemoteCloseInitiated());
  }
}
