{
  int buflen=0;
  for (  WebSocketFrame f : send) {
    buflen+=f.getPayloadLength() + Generator.OVERHEAD;
  }
  ByteBuffer buf=ByteBuffer.allocate(buflen);
  BufferUtil.clearToFill(buf);
  for (  WebSocketFrame f : send) {
    f.setMask(MASK);
    BufferUtil.put(generator.generate(f),buf);
  }
  BufferUtil.flipToFlush(buf,0);
  return buf;
}
