{
  AnnotatedBinaryStreamSocket socket=new AnnotatedBinaryStreamSocket();
  WebSocketEventDriver driver=newDriver(socket);
  LocalWebSocketConnection conn=new LocalWebSocketConnection(testname);
  driver.setConnection(conn);
  driver.onConnect();
  driver.incoming(makeBinaryFrame("Hello World",true));
  driver.incoming(new CloseInfo(StatusCode.NORMAL).asFrame());
  socket.capture.assertEventCount(3);
  socket.capture.assertEventStartsWith(0,"onConnect");
  socket.capture.assertEventRegex(1,"^onBinary\\(.*InputStream.*");
  socket.capture.assertEventStartsWith(2,"onClose(1000,");
}
