{
  HttpConfiguration httpConfig=HttpChannel.getCurrentHttpChannel().getHttpConfiguration();
  if (baseRequest.isSecure()) {
    return;
  }
  if (httpConfig.getSecurePort() > 0) {
    String scheme=httpConfig.getSecureScheme();
    int port=httpConfig.getSecurePort();
    String url=URIUtil.newURI(scheme,baseRequest.getServerName(),port,baseRequest.getRequestURI(),baseRequest.getQueryString());
    response.setContentLength(0);
    response.sendRedirect(url);
  }
 else {
    response.sendError(HttpStatus.FORBIDDEN_403,"Not Secure");
  }
  baseRequest.setHandled(true);
}
