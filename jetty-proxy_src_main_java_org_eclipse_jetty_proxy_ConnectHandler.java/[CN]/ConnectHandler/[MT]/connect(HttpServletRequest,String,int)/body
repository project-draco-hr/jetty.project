{
  SocketChannel channel=null;
  try {
    channel=SocketChannel.open();
    if (channel == null)     throw new IOException("Unable to connect to " + host + ":"+ port);
    LOG.debug("Establishing connection to {}:{}",host,port);
    channel.socket().setTcpNoDelay(true);
    channel.socket().connect(new InetSocketAddress(host,port),getConnectTimeout());
    LOG.debug("Established connection to {}:{}",host,port);
    return channel;
  }
 catch (  IOException x) {
    try {
      if (channel != null)       channel.close();
    }
 catch (    IOException xx) {
      LOG.ignore(xx);
    }
    LOG.debug("Failed to establish connection to " + host + ":"+ port,x);
    throw x;
  }
}
