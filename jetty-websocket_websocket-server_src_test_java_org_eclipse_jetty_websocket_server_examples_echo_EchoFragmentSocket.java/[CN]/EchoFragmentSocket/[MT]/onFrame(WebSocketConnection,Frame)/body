{
  if (frame.getType().isData()) {
    return;
  }
  ByteBuffer data=frame.getPayload();
  int half=data.remaining() / 2;
  ByteBuffer buf1=data.slice();
  ByteBuffer buf2=data.slice();
  buf1.limit(half);
  buf2.position(half);
  try {
switch (frame.getType()) {
case BINARY:
      conn.write(buf1);
    conn.write(buf2);
  break;
case TEXT:
conn.write(BufferUtil.toUTF8String(buf1));
conn.write(BufferUtil.toUTF8String(buf2));
break;
default :
throw new IOException("Unexpected frame type: " + frame.getType());
}
}
 catch (IOException e) {
e.printStackTrace(System.err);
}
}
