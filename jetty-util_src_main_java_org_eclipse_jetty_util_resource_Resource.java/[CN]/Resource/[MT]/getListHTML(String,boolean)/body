{
  if (!isDirectory())   return null;
  String[] ls=list();
  if (ls == null)   return null;
  Arrays.sort(ls);
  String decodedBase=URIUtil.decodePath(base);
  String title="Directory: " + deTag(decodedBase);
  StringBuilder buf=new StringBuilder(4096);
  buf.append("<HTML><HEAD><TITLE>");
  buf.append(title);
  buf.append("</TITLE></HEAD><BODY>\n<H1>");
  buf.append(title);
  buf.append("</H1><TABLE BORDER=0>");
  if (parent) {
    buf.append("<TR><TD><A HREF=\"");
    URIUtil.encodePath(buf,URIUtil.addPaths(base,"../"));
    buf.append("\">Parent Directory</A></TD><TD></TD><TD></TD></TR>\n");
  }
  DateFormat dfmt=DateFormat.getDateTimeInstance(DateFormat.MEDIUM,DateFormat.MEDIUM);
  for (int i=0; i < ls.length; i++) {
    String encoded=URIUtil.encodePath(ls[i]);
    Resource item=addPath(ls[i]);
    buf.append("<TR><TD><A HREF=\"");
    String path=URIUtil.addPaths(base,encoded);
    if (item.isDirectory() && !path.endsWith("/"))     path=URIUtil.addPaths(path,URIUtil.SLASH);
    URIUtil.encodePath(buf,path);
    buf.append("\">");
    buf.append(deTag(ls[i]));
    buf.append("&nbsp;");
    buf.append("</TD><TD ALIGN=right>");
    buf.append(item.length());
    buf.append(" bytes&nbsp;</TD><TD>");
    buf.append(dfmt.format(new Date(item.lastModified())));
    buf.append("</TD></TR>\n");
  }
  buf.append("</TABLE>\n");
  buf.append("</BODY></HTML>\n");
  return buf.toString();
}
