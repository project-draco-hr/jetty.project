{
  HttpSession httpSession=request.getSession(false);
synchronized (httpSession) {
    if (_renewSession && httpSession != null && httpSession.getAttribute(AbstractSessionManager.SESSION_KNOWN_ONLY_TO_AUTHENTICATED) != Boolean.TRUE) {
      HttpSession newSession=AbstractSessionManager.renewSession(request,httpSession,true);
      LOG.debug("renew {}->{}",httpSession.getId(),newSession.getId());
      httpSession=newSession;
    }
    return httpSession;
  }
}
