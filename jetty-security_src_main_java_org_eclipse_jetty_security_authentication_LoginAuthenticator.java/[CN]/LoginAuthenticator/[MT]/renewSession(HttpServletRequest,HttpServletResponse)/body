{
  HttpSession httpSession=request.getSession(false);
  if (_renewSession && httpSession != null) {
synchronized (httpSession) {
      if (httpSession.getAttribute(AbstractSessionManager.SESSION_KNOWN_ONLY_TO_AUTHENTICATED) != Boolean.TRUE) {
        HttpSession newSession=AbstractSessionManager.renewSession(request,httpSession,true);
        LOG.debug("renew {}->{}",httpSession.getId(),newSession.getId());
        httpSession=newSession;
      }
    }
  }
  return httpSession;
}
