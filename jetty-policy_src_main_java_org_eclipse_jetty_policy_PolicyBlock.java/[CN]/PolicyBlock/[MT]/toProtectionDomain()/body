{
  if (protectionDomain == null) {
    if (codesource == null) {
      protectionDomain=new ProtectionDomain(null,permissions);
    }
 else {
      protectionDomain=new ProtectionDomain(codesource,permissions,Thread.currentThread().getContextClassLoader(),principals);
    }
  }
  return protectionDomain;
}
