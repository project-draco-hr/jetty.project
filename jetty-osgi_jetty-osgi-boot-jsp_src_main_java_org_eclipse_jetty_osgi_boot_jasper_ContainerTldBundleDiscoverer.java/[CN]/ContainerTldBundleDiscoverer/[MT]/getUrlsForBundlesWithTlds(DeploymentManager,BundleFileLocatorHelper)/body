{
  Bundle[] bundles=FrameworkUtil.getBundle(ContainerTldBundleDiscoverer.class).getBundleContext().getBundles();
  HashSet<URL> urls=new HashSet<URL>();
  String tmp=System.getProperty(SYS_PROP_TLD_BUNDLES);
  List<String> sysNames=new ArrayList<String>();
  if (tmp != null) {
    StringTokenizer tokenizer=new StringTokenizer(tmp,", \n\r\t",false);
    while (tokenizer.hasMoreTokens())     sysNames.add(tokenizer.nextToken());
  }
  tmp=(String)deploymentManager.getContextAttribute(OSGiWebInfConfiguration.CONTAINER_BUNDLE_PATTERN);
  Pattern pattern=(tmp == null ? null : Pattern.compile(tmp));
  for (  Bundle bundle : bundles) {
    if (sysNames.contains(bundle.getSymbolicName()))     convertBundleLocationToURL(locatorHelper,bundle,urls);
    if (pattern != null && pattern.matcher(bundle.getSymbolicName()).matches())     convertBundleLocationToURL(locatorHelper,bundle,urls);
  }
  return urls.toArray(new URL[urls.size()]);
}
