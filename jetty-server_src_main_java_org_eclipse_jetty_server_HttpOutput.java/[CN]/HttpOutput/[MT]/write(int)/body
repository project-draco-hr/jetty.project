{
  if (_closed)   throw new IOException("Closed");
  if (!_generator.isOpen())   throw new EofException();
  while (_generator.isBufferFull()) {
    _generator.blockForOutput(getMaxIdleTime());
    if (_closed)     throw new IOException("Closed");
    if (!_generator.isOpen())     throw new EofException();
  }
  if (_generator.addContent((byte)b))   _connection.commitResponse(Generator.MORE);
  if (_generator.isAllContentWritten()) {
    flush();
    close();
  }
}
