{
  OutputState state=_state.get();
  while (state != OutputState.CLOSED) {
    if (_state.compareAndSet(state,OutputState.CLOSED)) {
      try {
        _channel.getResponse().closeOutput();
      }
 catch (      IOException e) {
        LOG.debug(e);
        _channel.failed();
      }
      releaseBuffer();
      return;
    }
    state=_state.get();
  }
}
