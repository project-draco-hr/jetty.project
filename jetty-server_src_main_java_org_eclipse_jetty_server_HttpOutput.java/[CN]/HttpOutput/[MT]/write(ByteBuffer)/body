{
  if (_closed)   throw new IOException("Closed");
  if (!_generator.isOpen())   throw new EofException();
  while (_generator.isBufferFull()) {
    _generator.blockForOutput(getMaxIdleTime());
    if (_closed)     throw new IOException("Closed");
    if (!_generator.isOpen())     throw new EofException();
  }
  _generator.addContent(buffer,Generator.MORE);
  if (_generator.isAllContentWritten()) {
    flush();
    close();
  }
 else   if (_generator.isBufferFull())   _connection.commitResponse(Generator.MORE);
  while (buffer.length() > 0 && _generator.isOpen()) {
    _generator.blockForOutput(getMaxIdleTime());
  }
}
