{
  if (args.length != 1) {
    System.err.println("Usage - java " + DemoServer.class + " webappdir|war");
    System.exit(1);
  }
  Server server=new Server();
  MBeanServer mbeanS=ManagementFactory.getPlatformMBeanServer();
  MBeanContainer mbeanC=new MBeanContainer(mbeanS);
  server.getContainer().addEventListener(mbeanC);
  server.addBean(mbeanC);
  SelectChannelConnector connector=new SelectChannelConnector();
  connector.setPort(8080);
  server.addConnector(connector);
  HashLoginService login=new HashLoginService();
  login.putUser("jetty",new Password("password"),new String[]{"user"});
  login.putUser("admin",new Password("password"),new String[]{"user","admin"});
  server.addBean(login);
  ContextHandlerCollection contexts=new ContextHandlerCollection();
  server.setHandler(contexts);
  WebAppContext context=new WebAppContext();
  context.setWar(args[0]);
  context.setDefaultsDescriptor("../jetty-webapp/src/main/config/etc/webdefault.xml");
  contexts.addHandler(context);
  server.start();
  System.err.println(server.dump());
  server.join();
}
