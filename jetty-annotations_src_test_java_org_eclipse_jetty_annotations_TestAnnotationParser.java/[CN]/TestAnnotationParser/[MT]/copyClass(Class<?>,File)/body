{
  String classname=clazz.getName().replace('.',File.separatorChar) + ".class";
  URL url=this.getClass().getResource('/' + classname);
  assertTrue(url != null);
  String classpath=classname.substring(0,classname.lastIndexOf(File.separatorChar));
  FS.ensureDirExists(new File(basedir,classpath));
  InputStream in=null;
  OutputStream out=null;
  try {
    in=url.openStream();
    out=new FileOutputStream(new File(basedir,classname));
    IO.copy(in,out);
  }
  finally {
    IO.close(out);
    IO.close(in);
  }
}
