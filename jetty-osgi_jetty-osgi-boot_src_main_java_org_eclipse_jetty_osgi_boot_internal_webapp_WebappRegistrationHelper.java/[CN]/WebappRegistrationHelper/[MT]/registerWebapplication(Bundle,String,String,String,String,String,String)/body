{
  File bundleInstall=overrideBundleInstallLocation == null ? BUNDLE_FILE_LOCATOR_HELPER.getBundleInstallLocation(bundle) : new File(overrideBundleInstallLocation);
  File webapp=null;
  if (webappFolderPath != null && webappFolderPath.length() != 0 && !webappFolderPath.equals(".")) {
    if (webappFolderPath.startsWith("/") || webappFolderPath.startsWith("file:/")) {
      webapp=new File(webappFolderPath);
    }
 else {
      webapp=new File(bundleInstall,webappFolderPath);
    }
  }
 else {
    webapp=bundleInstall;
  }
  if (!webapp.exists()) {
    throw new IllegalArgumentException("Unable to locate " + webappFolderPath + " inside "+ (bundleInstall != null ? bundleInstall.getAbsolutePath() : "unlocated bundle '" + bundle.getSymbolicName() + "'"));
  }
  return registerWebapplication(bundle,webappFolderPath,webapp,contextPath,extraClasspath,bundleInstall,webXmlPath,defaultWebXmlPath);
}
