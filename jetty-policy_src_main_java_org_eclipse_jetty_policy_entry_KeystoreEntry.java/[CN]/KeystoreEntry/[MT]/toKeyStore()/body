{
  if (keystore != null && !isDirty()) {
    return keystore;
  }
  try {
    keystore=KeyStore.getInstance(type);
    URL keyStoreLocation=new URL(url);
    Resource r=Resource.newResource(keyStoreLocation);
    InputStream istream=r.getInputStream();
    keystore.load(istream,null);
  }
 catch (  Exception e) {
    throw new PolicyException(e);
  }
  return keystore;
}
