{
  SPDYClient.SessionContext context=(SPDYClient.SessionContext)attachment;
  SPDYClient client=context.getSPDYClient();
  Factory factory=client.getFactory();
  ByteBufferPool bufferPool=factory.getByteBufferPool();
  CompressionFactory compressionFactory=new StandardCompressionFactory();
  Parser parser=new Parser(compressionFactory.newDecompressor());
  Generator generator=new Generator(bufferPool,compressionFactory.newCompressor());
  SPDYConnection connection=new ClientSPDYConnection(endPoint,bufferPool,parser,factory,client.isDispatchIO());
  FlowControlStrategy flowControlStrategy=client.newFlowControlStrategy();
  StandardSession session=new StandardSession(client.getVersion(),bufferPool,factory.getExecutor(),factory.getScheduler(),connection,endPoint,connection,1,context.getSessionFrameListener(),generator,flowControlStrategy);
  session.setWindowSize(client.getInitialWindowSize());
  parser.addListener(session);
  connection.setSession(session);
  context.succeeded(session);
  return connection;
}
