{
  Set<String> files=new HashSet<String>();
  files.add(MavenTestingUtils.getTestResourceFile("single-codebase-file-permission.policy").getAbsolutePath());
  files.add(MavenTestingUtils.getTestResourceFile("single-codebase-file-permission-2.policy").getAbsolutePath());
  files.add(MavenTestingUtils.getTestResourceFile("single-codebase-file-permission-3.policy").getAbsolutePath());
  JettyPolicy ap=new JettyPolicy(files,evaluator);
  ap.refresh();
  URL url=new URL("file:///bar.jar");
  CodeSource cs=new CodeSource(url,new Certificate[0]);
  PermissionCollection pc=ap.getPermissions(cs);
  assertNotNull(pc);
  Permission testPerm=new FilePermission("/tmp/*","read, write");
  Permission testPerm2=new FilePermission("/usr/*","write");
  assertTrue(pc.implies(testPerm));
  assertFalse(pc.implies(testPerm2));
}
