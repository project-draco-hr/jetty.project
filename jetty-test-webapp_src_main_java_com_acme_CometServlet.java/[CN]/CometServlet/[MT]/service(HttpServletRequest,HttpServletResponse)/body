{
synchronized (request) {
    Continuation continuation=ContinuationSupport.getContinuation(request,request);
    if (!continuation.isPending())     begin(request,response);
    Integer timeout=(Integer)request.getAttribute("org.apache.tomcat.comet.timeout");
    boolean resumed=continuation.suspend(timeout == null ? 60000 : timeout.intValue());
    if (!resumed)     error(request,response);
  }
}
