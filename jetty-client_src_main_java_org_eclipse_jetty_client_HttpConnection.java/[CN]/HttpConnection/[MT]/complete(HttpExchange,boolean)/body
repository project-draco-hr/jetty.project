{
  HttpExchange existing=this.exchange.getAndSet(null);
  if (existing == exchange) {
    exchange.awaitTermination();
    getEndPoint().setIdleTimeout(idleTimeout);
    LOG.debug("{} disassociated from {}",exchange,this);
    if (success) {
      HttpFields responseHeaders=exchange.getResponse().getHeaders();
      Enumeration<String> values=responseHeaders.getValues(HttpHeader.CONNECTION.asString(),",");
      if (values != null) {
        while (values.hasMoreElements()) {
          if ("close".equalsIgnoreCase(values.nextElement())) {
            close();
            return;
          }
        }
      }
      destination.release(this);
    }
 else {
      close();
    }
  }
 else   if (existing == null) {
  }
 else {
    throw new IllegalStateException();
  }
}
