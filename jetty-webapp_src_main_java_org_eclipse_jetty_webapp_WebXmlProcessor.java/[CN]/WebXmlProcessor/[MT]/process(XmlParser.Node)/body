{
  _servletHandler=_context.getServletHandler();
  _securityHandler=(SecurityHandler)_context.getSecurityHandler();
  _filters=LazyList.array2List(_servletHandler.getFilters());
  _filterMappings=LazyList.array2List(_servletHandler.getFilterMappings());
  _servlets=LazyList.array2List(_servletHandler.getServlets());
  _servletMappings=LazyList.array2List(_servletHandler.getServletMappings());
  _listeners=LazyList.array2List(_context.getEventListeners());
  _welcomeFiles=LazyList.array2List(_context.getWelcomeFiles());
  if (_securityHandler instanceof ConstraintAware) {
    _constraintMappings=LazyList.array2List(((ConstraintAware)_securityHandler).getConstraintMappings());
    if (((ConstraintAware)_securityHandler).getRoles() != null) {
      _roles.addAll(((ConstraintAware)_securityHandler).getRoles());
    }
  }
  _errorPages=_context.getErrorHandler() instanceof ErrorPageErrorHandler ? ((ErrorPageErrorHandler)_context.getErrorHandler()).getErrorPages() : null;
  Iterator iter=config.iterator();
  XmlParser.Node node=null;
  while (iter.hasNext()) {
    try {
      Object o=iter.next();
      if (!(o instanceof XmlParser.Node))       continue;
      node=(XmlParser.Node)o;
      String name=node.getTag();
      initWebXmlElement(name,node);
    }
 catch (    ClassNotFoundException e) {
      throw e;
    }
catch (    Exception e) {
      Log.warn("Configuration problem at " + node,e);
      throw new UnavailableException("Configuration problem");
    }
  }
  _servletHandler.setFilters((FilterHolder[])LazyList.toArray(_filters,FilterHolder.class));
  _servletHandler.setFilterMappings((FilterMapping[])LazyList.toArray(_filterMappings,FilterMapping.class));
  _servletHandler.setServlets((ServletHolder[])LazyList.toArray(_servlets,ServletHolder.class));
  _servletHandler.setServletMappings((ServletMapping[])LazyList.toArray(_servletMappings,ServletMapping.class));
  _context.setEventListeners((EventListener[])LazyList.toArray(_listeners,EventListener.class));
  _context.setWelcomeFiles((String[])LazyList.toArray(_welcomeFiles,String.class));
  if (_securityHandler instanceof ConstraintAware) {
    ((ConstraintAware)_securityHandler).setConstraintMappings((ConstraintMapping[])LazyList.toArray(_constraintMappings,ConstraintMapping.class),_roles);
  }
  if (_errorPages != null && _context.getErrorHandler() instanceof ErrorPageErrorHandler)   ((ErrorPageErrorHandler)_context.getErrorHandler()).setErrorPages(_errorPages);
}
