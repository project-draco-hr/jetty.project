{
  ByteArrayOutputStream out=new ByteArrayOutputStream();
  int capacity=1024 * 1024;
  byte[] bytes=new byte[capacity];
  Arrays.fill(bytes,(byte)'x');
  ByteBuffer buffer=BufferUtil.allocate(1024);
  BufferUtil.append(buffer,bytes,0,capacity);
  long start=System.nanoTime();
  for (int i=0; i < 30; i++) {
    long startRun=System.nanoTime();
    BufferUtil.writeTo(buffer,out);
    long elapsedRun=System.nanoTime() - startRun;
    LOG.warn("run elapsed={}ms",elapsedRun / 1000);
  }
  long elapsed=System.nanoTime() - start;
  LOG.warn("elapsed={}ms",elapsed / 1000);
}
