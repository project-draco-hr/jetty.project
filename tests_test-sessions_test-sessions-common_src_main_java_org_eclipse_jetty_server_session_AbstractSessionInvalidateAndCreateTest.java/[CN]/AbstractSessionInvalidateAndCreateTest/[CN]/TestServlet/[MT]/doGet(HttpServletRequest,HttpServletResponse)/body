{
  String action=request.getParameter("action");
  if ("init".equals(action)) {
    HttpSession session=request.getSession(true);
    session.setAttribute("identity","session1");
  }
 else   if ("test".equals(action)) {
    HttpSession session=request.getSession(false);
    if (session != null) {
      session.invalidate();
      session=request.getSession(true);
      session.setAttribute("identity","session2");
      session.setAttribute("listener",new HttpSessionBindingListener(){
        public void valueUnbound(        HttpSessionBindingEvent event){
          unbound=true;
        }
        public void valueBound(        HttpSessionBindingEvent event){
        }
      }
);
    }
  }
}
