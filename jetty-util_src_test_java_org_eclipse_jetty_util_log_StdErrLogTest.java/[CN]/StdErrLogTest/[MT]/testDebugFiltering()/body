{
  StdErrLog log=new StdErrLog(StdErrLogTest.class.getName());
  log.setHideStacks(true);
  ByteArrayOutputStream test=new ByteArrayOutputStream();
  PrintStream err=new PrintStream(test);
  log.setStdErrStream(err);
  log.debug("Tobacconist");
  log.setLevel(StdErrLog.LEVEL_DEBUG);
  log.debug("my hovercraft is");
  Assert.assertThat("log should report as debug enabled",log.isDebugEnabled(),is(true));
  log.setLevel(StdErrLog.LEVEL_ALL);
  log.debug("full of eels.");
  log.setLevel(StdErrLog.LEVEL_WARN);
  log.debug("what?");
  String output=new String(test.toByteArray(),"UTF-8");
  System.err.print(output);
  Assert.assertThat(output,not(containsString("Tobacconist")));
  Assert.assertThat(output,containsString("my hovercraft is"));
  Assert.assertThat(output,containsString("full of eels."));
  Assert.assertThat(output,not(containsString("what?")));
}
