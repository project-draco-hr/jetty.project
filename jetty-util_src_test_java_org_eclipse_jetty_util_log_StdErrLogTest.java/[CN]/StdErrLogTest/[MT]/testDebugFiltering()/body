{
  StdErrLog log=new StdErrLog(StdErrLogTest.class.getName());
  log.setHideStacks(true);
  ByteArrayOutputStream test=new ByteArrayOutputStream();
  PrintStream err=new PrintStream(test);
  log.setStdErrStream(err);
  log.debug("Tobacconist");
  log.debug("<spoken line>",new Throwable("on editing room floor"));
  log.setLevel(StdErrLog.LEVEL_DEBUG);
  log.debug("my hovercraft is");
  log.debug("<zoom>",new Throwable("out of focus"));
  log.debug(new Throwable("scene lost"));
  log.setLevel(StdErrLog.LEVEL_ALL);
  log.debug("full of eels.");
  log.setLevel(StdErrLog.LEVEL_WARN);
  log.debug("what?");
  String output=new String(test.toByteArray(),"UTF-8");
  Assert.assertThat(output,not(containsString("Tobacconist")));
  Assert.assertThat(output,containsString("my hovercraft is"));
  Assert.assertThat(output,containsString("full of eels."));
  Assert.assertThat(output,not(containsString("what?")));
  Assert.assertThat(output,not(containsString("<spoken line>")));
  Assert.assertThat(output,not(containsString("on editing room floor")));
  Assert.assertThat(output,containsString(".StdErrLogTest:<zoom>"));
  Assert.assertThat(output,containsString("java.lang.Throwable: out of focus"));
  Assert.assertThat(output,containsString("java.lang.Throwable: scene lost"));
}
