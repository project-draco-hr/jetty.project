{
  CompressionFactory compressionFactory=new StandardCompressionFactory();
  Parser parser=new Parser(compressionFactory.newDecompressor());
  Generator generator=new Generator(connector.getByteBufferPool(),compressionFactory.newCompressor());
  ServerSessionFrameListener listener=provideServerSessionFrameListener(connector,endPoint);
  SPDYConnection connection=new ServerSPDYConnection(connector,endPoint,parser,listener,getInputBufferSize());
  FlowControlStrategy flowControlStrategy=newFlowControlStrategy(version);
  StandardSession session=new StandardSession(getVersion(),connector.getByteBufferPool(),connector.getExecutor(),connector.getScheduler(),connection,connection,2,listener,generator,flowControlStrategy);
  session.setAttribute("org.eclipse.jetty.spdy.remoteAddress",endPoint.getRemoteAddress());
  session.setWindowSize(getInitialWindowSize());
  parser.addListener(session);
  connection.setSession(session);
  sessionOpened(session);
  return configure(connection,connector,endPoint);
}
