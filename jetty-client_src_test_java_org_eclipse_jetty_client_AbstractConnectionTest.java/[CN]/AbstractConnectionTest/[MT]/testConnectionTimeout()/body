{
  HttpClient httpClient=newHttpClient();
  int connectTimeout=5000;
  httpClient.setConnectTimeout(connectTimeout);
  httpClient.start();
  try {
    CountDownLatch latch=new CountDownLatch(1);
    HttpExchange exchange=new ConnectionExchange(latch);
    exchange.setAddress(new Address("127.0.0.1",1));
    exchange.setRequestURI("/");
    httpClient.send(exchange);
    boolean passed=latch.await(connectTimeout * 2L,TimeUnit.MILLISECONDS);
    assertTrue(passed);
    int status=exchange.waitForDone();
    assertEquals(HttpExchange.STATUS_EXCEPTED,status);
  }
  finally {
    httpClient.stop();
  }
}
