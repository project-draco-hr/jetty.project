{
synchronized (this) {
    if (_header != null && !_headerOut) {
      _headerOut=true;
      return _header;
    }
    if (_buffer != null && _header != null && _header.capacity() == _buffer.capacity() && !_bufferOut) {
      _bufferOut=true;
      return _buffer;
    }
    if (_header != null)     return ByteBuffer.allocate(_header.capacity());
    return ByteBuffer.allocate(4096);
  }
}
