{
  String allowedOriginsConfig=config.getInitParameter(ALLOWED_ORIGINS_PARAM);
  if (allowedOriginsConfig == null)   allowedOriginsConfig="*";
  String[] allowedOrigins=allowedOriginsConfig.split(",");
  for (  String allowedOrigin : allowedOrigins) {
    allowedOrigin=allowedOrigin.trim();
    if (allowedOrigin.length() > 0) {
      if (ANY_ORIGIN.equals(allowedOrigin)) {
        anyOriginAllowed=true;
        this.allowedOrigins.clear();
        break;
      }
 else {
        this.allowedOrigins.add(allowedOrigin);
      }
    }
  }
  String allowedMethodsConfig=config.getInitParameter(ALLOWED_METHODS_PARAM);
  if (allowedMethodsConfig == null)   allowedMethodsConfig="GET,POST,HEAD";
  allowedMethods.addAll(Arrays.asList(allowedMethodsConfig.split(",")));
  String allowedHeadersConfig=config.getInitParameter(ALLOWED_HEADERS_PARAM);
  if (allowedHeadersConfig == null)   allowedHeadersConfig="X-Requested-With,Content-Type,Accept,Origin";
  allowedHeaders.addAll(Arrays.asList(allowedHeadersConfig.split(",")));
  String preflightMaxAgeConfig=config.getInitParameter(PREFLIGHT_MAX_AGE_PARAM);
  if (preflightMaxAgeConfig == null)   preflightMaxAgeConfig="1800";
  try {
    preflightMaxAge=Integer.parseInt(preflightMaxAgeConfig);
  }
 catch (  NumberFormatException x) {
    LOG.info("Cross-origin filter, could not parse '{}' parameter as integer: {}",PREFLIGHT_MAX_AGE_PARAM,preflightMaxAgeConfig);
  }
  String allowedCredentialsConfig=config.getInitParameter(ALLOW_CREDENTIALS_PARAM);
  if (allowedCredentialsConfig == null)   allowedCredentialsConfig="true";
  allowCredentials=Boolean.parseBoolean(allowedCredentialsConfig);
  String exposedHeadersConfig=config.getInitParameter(EXPOSED_HEADERS_PARAM);
  if (exposedHeadersConfig == null)   exposedHeadersConfig="";
  exposedHeaders.addAll(Arrays.asList(exposedHeadersConfig.split(",")));
  String forwardPreflightConfig=config.getInitParameter(FORWARD_PREFLIGHT_PARAM);
  if (forwardPreflightConfig == null)   forwardPreflightConfig="true";
  forwardPreflight=Boolean.parseBoolean(forwardPreflightConfig);
  if (LOG.isDebugEnabled()) {
    LOG.debug("Cross-origin filter configuration: " + ALLOWED_ORIGINS_PARAM + " = "+ allowedOriginsConfig+ ", "+ ALLOWED_METHODS_PARAM+ " = "+ allowedMethodsConfig+ ", "+ ALLOWED_HEADERS_PARAM+ " = "+ allowedHeadersConfig+ ", "+ PREFLIGHT_MAX_AGE_PARAM+ " = "+ preflightMaxAgeConfig+ ", "+ ALLOW_CREDENTIALS_PARAM+ " = "+ allowedCredentialsConfig+ ","+ EXPOSED_HEADERS_PARAM+ " = "+ exposedHeadersConfig+ ","+ FORWARD_PREFLIGHT_PARAM+ " = "+ forwardPreflightConfig);
  }
}
