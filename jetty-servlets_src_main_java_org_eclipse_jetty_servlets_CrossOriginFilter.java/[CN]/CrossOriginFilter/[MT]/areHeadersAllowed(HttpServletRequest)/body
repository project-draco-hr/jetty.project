{
  String accessControlRequestHeaders=request.getHeader(ACCESS_CONTROL_REQUEST_HEADERS_HEADER);
  Log.debug("{} is {}",ACCESS_CONTROL_REQUEST_HEADERS_HEADER,accessControlRequestHeaders);
  boolean result=false;
  if (accessControlRequestHeaders != null) {
    result=true;
    String[] headers=accessControlRequestHeaders.split(",");
    for (    String header : headers) {
      boolean headerAllowed=false;
      for (      String allowedHeader : allowedHeaders) {
        if (header.trim().equalsIgnoreCase(allowedHeader.trim())) {
          headerAllowed=true;
          break;
        }
      }
      if (!headerAllowed) {
        result=false;
        break;
      }
    }
  }
  Log.debug("Headers [{}] are" + (result ? "" : " not") + " among allowed headers {}",accessControlRequestHeaders,allowedHeaders);
  return result;
}
