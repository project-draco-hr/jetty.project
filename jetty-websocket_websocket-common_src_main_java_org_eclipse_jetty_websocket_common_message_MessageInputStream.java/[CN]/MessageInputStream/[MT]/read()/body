{
  try {
    if (closed.get()) {
      return -1;
    }
    if (activeBuffer == null) {
      activeBuffer=buffers.take();
    }
    while (activeBuffer.remaining() <= 0) {
      if (buffersExhausted.get()) {
        closed.set(true);
        return -1;
      }
      activeBuffer=buffers.take();
    }
    return activeBuffer.get();
  }
 catch (  InterruptedException e) {
    throw new IOException(e);
  }
}
