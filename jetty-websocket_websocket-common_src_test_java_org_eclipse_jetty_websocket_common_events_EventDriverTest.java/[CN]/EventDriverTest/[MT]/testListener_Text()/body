{
  ListenerBasicSocket socket=new ListenerBasicSocket();
  EventDriver driver=wrap(socket);
  try (LocalWebSocketSession conn=new LocalWebSocketSession(testname,driver)){
    conn.start();
    conn.open();
    driver.incomingFrame(WebSocketFrame.text("Hello World"));
    driver.incomingFrame(new CloseInfo(StatusCode.NORMAL).asFrame());
    socket.capture.assertEventCount(3);
    socket.capture.pop().assertEventStartsWith("onWebSocketConnect");
    socket.capture.pop().assertEventStartsWith("onWebSocketText(\"Hello World\")");
    socket.capture.pop().assertEventStartsWith("onWebSocketClose(1000,");
  }
 }
