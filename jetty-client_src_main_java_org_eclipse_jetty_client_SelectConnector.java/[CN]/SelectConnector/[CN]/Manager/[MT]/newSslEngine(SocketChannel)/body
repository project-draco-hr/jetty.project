{
  SslContextFactory sslContextFactory=_httpClient.getSslContextFactory();
  SSLEngine sslEngine;
  if (channel != null) {
    String peerHost=channel.socket().getInetAddress().getHostAddress();
    int peerPort=channel.socket().getPort();
    sslEngine=sslContextFactory.newSslEngine(peerHost,peerPort);
  }
 else {
    sslEngine=sslContextFactory.newSslEngine();
  }
  sslEngine.setUseClientMode(true);
  sslEngine.beginHandshake();
  return sslEngine;
}
