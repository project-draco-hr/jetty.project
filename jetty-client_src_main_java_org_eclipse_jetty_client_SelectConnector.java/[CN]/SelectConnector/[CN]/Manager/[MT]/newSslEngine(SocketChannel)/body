{
  SslContextFactory sslContextFactory=_httpClient.getSslContextFactory();
  if (_sslContext == null)   _sslContext=sslContextFactory.getSslContext();
  SSLEngine sslEngine;
  if (channel != null && sslContextFactory.isSessionCachingEnabled()) {
    String peerHost=channel.socket().getInetAddress().getHostAddress();
    int peerPort=channel.socket().getPort();
    sslEngine=_sslContext.createSSLEngine(peerHost,peerPort);
  }
 else {
    sslEngine=_sslContext.createSSLEngine();
  }
  sslEngine.setUseClientMode(true);
  sslEngine.beginHandshake();
  return sslEngine;
}
