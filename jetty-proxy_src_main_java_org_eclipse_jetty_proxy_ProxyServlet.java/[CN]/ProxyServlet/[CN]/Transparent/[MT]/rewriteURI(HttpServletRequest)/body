{
  String path=request.getRequestURI();
  if (!path.startsWith(_prefix))   return null;
  StringBuilder uri=new StringBuilder(_proxyTo);
  if (_proxyTo.endsWith("/"))   uri.setLength(uri.length() - 1);
  String rest=path.substring(_prefix.length());
  if (!rest.startsWith("/"))   uri.append("/");
  uri.append(rest);
  String query=request.getQueryString();
  if (query != null)   uri.append("?").append(query);
  URI rewrittenURI=URI.create(uri.toString()).normalize();
  if (!validateDestination(rewrittenURI.getHost(),rewrittenURI.getPort()))   return null;
  return rewrittenURI;
}
