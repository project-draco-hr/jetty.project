{
  InnerBuffers buffers=new InnerBuffers();
  buffers.setHeaderSize(128);
  buffers.setBufferSize(128);
  Buffer h1=buffers.getHeader();
  Buffer h2=buffers.getHeader();
  Buffer b1=buffers.getBuffer();
  Buffer b2=buffers.getBuffer();
  Buffer b3=buffers.getBuffer(128);
  List<Buffer> known=new ArrayList<Buffer>();
  known.add(h1);
  known.add(h2);
  known.add(b1);
  known.add(b2);
  known.add(h1);
  buffers.returnBuffer(h1);
  buffers.returnBuffer(h2);
  buffers.returnBuffer(b1);
  buffers.returnBuffer(b2);
  buffers.returnBuffer(b3);
  assertTrue(h1 == buffers.getHeader());
  Buffer buffer=buffers.getHeader();
  for (  Buffer b : known)   assertTrue(b != buffer);
  assertTrue(h2 == buffers.getBuffer());
  assertTrue(b3 == buffers.getBuffer());
  buffer=buffers.getBuffer(128);
  for (  Buffer b : known)   assertTrue(b != buffer);
  buffers.returnBuffer(h1);
  buffers.returnBuffer(h2);
  buffers.returnBuffer(b1);
  assertTrue(h1 == buffers.getHeader());
  buffer=buffers.getHeader();
  for (  Buffer b : known)   assertTrue(b != buffer);
  assertTrue(h2 == buffers.getBuffer());
  assertTrue(b1 == buffers.getBuffer());
  buffers.returnBuffer(h1);
  buffers.returnBuffer(b1);
  buffers.returnBuffer(h2);
  assertTrue(h1 == buffers.getHeader());
  assertTrue(h2 == buffers.getHeader());
  buffer=buffers.getHeader();
  for (  Buffer b : known)   assertTrue(b != buffer);
  assertTrue(b1 == buffers.getBuffer());
  buffer=buffers.getBuffer();
  for (  Buffer b : known)   assertTrue(b != buffer);
}
