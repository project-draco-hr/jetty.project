{
  while (true) {
    long current=volatileGetLong(array,offset);
    long next=current + 1;
    if (compareAndSetLong(array,offset,current,next))     return current;
  }
}
