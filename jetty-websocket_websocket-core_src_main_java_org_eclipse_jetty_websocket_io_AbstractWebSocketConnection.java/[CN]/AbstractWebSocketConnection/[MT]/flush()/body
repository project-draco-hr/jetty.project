{
  FrameBytes<?> frameBytes=null;
  ByteBuffer buffer=null;
synchronized (queue) {
    if (flushing || queue.isEmpty()) {
      return;
    }
    frameBytes=queue.pop();
    if (!isOpen()) {
      queue.clear();
      return;
    }
    buffer=frameBytes.getByteBuffer();
    if (buffer == null) {
      return;
    }
    flushing=true;
    if (LOG.isDebugEnabled()) {
      LOG.debug("Flushing {}, {} frame(s) in queue",frameBytes,queue.size());
    }
  }
  write(buffer,frameBytes);
}
