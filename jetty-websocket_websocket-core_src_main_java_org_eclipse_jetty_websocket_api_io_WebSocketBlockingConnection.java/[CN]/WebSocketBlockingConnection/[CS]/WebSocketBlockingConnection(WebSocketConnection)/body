{
  if (conn instanceof RawConnection) {
    this.conn=(RawConnection)conn;
  }
 else {
    throw new IllegalArgumentException("Unsupported implementation of WebSocketConnection");
  }
  this.bufferPool=this.conn.getBufferPool();
  this.policy=conn.getPolicy();
  this.generator=new Generator(this.policy);
}
