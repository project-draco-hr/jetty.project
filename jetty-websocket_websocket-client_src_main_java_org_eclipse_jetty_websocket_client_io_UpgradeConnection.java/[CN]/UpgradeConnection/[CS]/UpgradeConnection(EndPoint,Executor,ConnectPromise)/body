{
  super(endp,executor);
  this.connectPromise=connectPromise;
  this.bufferPool=connectPromise.getClient().getBufferPool();
  this.parser=new HttpResponseHeaderParser();
  try {
    this.request=connectPromise.getRequest();
  }
 catch (  ClassCastException e) {
    connectPromise.failed(new RuntimeException("Invalid Upgrade Request structure",e));
  }
}
