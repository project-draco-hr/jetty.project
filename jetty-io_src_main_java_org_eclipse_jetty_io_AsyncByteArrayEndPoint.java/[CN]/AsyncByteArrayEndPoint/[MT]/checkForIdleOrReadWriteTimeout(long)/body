{
synchronized (this) {
    if (_checkForIdle || _readInterest.isInterested() || _writeFlusher.isWriting()) {
      long idleTimestamp=getIdleTimestamp();
      long max_idle_time=getMaxIdleTime();
      if (idleTimestamp != 0 && max_idle_time > 0) {
        long idleForMs=now - idleTimestamp;
        if (idleForMs > max_idle_time) {
          notIdle();
          if (_checkForIdle) {
            AsyncConnection connection=_connection;
            if (connection == null)             close();
 else             connection.onIdleExpired(idleForMs);
          }
          TimeoutException timeout=new TimeoutException();
          _readInterest.failed(timeout);
          _writeFlusher.failed(timeout);
        }
      }
    }
  }
}
