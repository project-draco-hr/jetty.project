{
synchronized (this) {
    if (isOutputShutdown() || _readInterest.isInterested() || _writeFlusher.isWriting()) {
      long idleTimestamp=getIdleTimestamp();
      long idleTimeout=getIdleTimeout();
      if (idleTimestamp != 0 && idleTimeout > 0) {
        long idleForMs=now - idleTimestamp;
        if (idleForMs > idleTimeout) {
          if (isOutputShutdown())           close();
          notIdle();
          TimeoutException timeout=new TimeoutException("idle " + idleForMs + "ms");
          _readInterest.failed(timeout);
          _writeFlusher.failed(timeout);
        }
      }
    }
  }
}
