{
synchronized (this) {
    if (isOutputShutdown() || _readInterest.isInterested() || _writeFlusher.isWriting()) {
      long idleTimestamp=getIdleTimestamp();
      long max_idle_time=getMaxIdleTime();
      if (idleTimestamp != 0 && max_idle_time > 0) {
        long idleForMs=now - idleTimestamp;
        if (idleForMs > max_idle_time) {
          if (isOutputShutdown())           close();
          notIdle();
          TimeoutException timeout=new TimeoutException("idle " + idleForMs + "ms");
          _readInterest.failed(timeout);
          _writeFlusher.failed(timeout);
        }
      }
    }
  }
}
