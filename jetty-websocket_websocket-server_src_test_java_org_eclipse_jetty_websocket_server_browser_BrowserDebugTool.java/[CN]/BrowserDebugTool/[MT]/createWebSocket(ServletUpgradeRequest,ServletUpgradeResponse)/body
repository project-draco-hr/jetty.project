{
  LOG.debug("Creating BrowserSocket");
  if (req.getSubProtocols() != null) {
    if (!req.getSubProtocols().isEmpty()) {
      String subProtocol=req.getSubProtocols().get(0);
      resp.setAcceptedSubProtocol(subProtocol);
    }
  }
  String ua=req.getHeader("User-Agent");
  String rexts=req.getHeader("Sec-WebSocket-Extensions");
  LOG.debug("User-Agent: {}",ua);
  LOG.debug("Sec-WebSocket-Extensions (Request) : {}",rexts);
  return new BrowserSocket(ua,rexts);
}
