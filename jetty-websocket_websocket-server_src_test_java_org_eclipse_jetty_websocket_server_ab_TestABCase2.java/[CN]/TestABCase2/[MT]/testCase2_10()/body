{
  int pingCount=10;
  List<WebSocketFrame> send=new ArrayList<>();
  List<WebSocketFrame> expect=new ArrayList<>();
  for (int i=0; i < pingCount; i++) {
    String payload=String.format("ping-%d[%X]",i,i);
    send.add(WebSocketFrame.ping().setPayload(payload));
    expect.add(WebSocketFrame.pong().setPayload(payload));
  }
  send.add(new CloseInfo(StatusCode.NORMAL).asFrame());
  expect.add(new CloseInfo(StatusCode.NORMAL).asFrame());
  Fuzzer fuzzer=new Fuzzer(this);
  try {
    fuzzer.connect();
    fuzzer.setSendMode(Fuzzer.SendMode.BULK);
    fuzzer.send(send);
    fuzzer.expect(expect);
  }
  finally {
    fuzzer.close();
  }
}
