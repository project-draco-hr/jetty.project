{
synchronized (this) {
    generator.getBufferPool().release(buffer);
    if (active == null) {
      return;
    }
    if (active.frame.remaining() <= 0) {
      if (active.callback != null) {
        active.callback.succeeded();
      }
      active=null;
    }
    flushCallback.succeeded();
  }
}
