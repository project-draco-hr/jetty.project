{
  List<Callback> successNotifiers=new ArrayList<>();
synchronized (this) {
    generator.getBufferPool().release(buffer);
    if (active != null) {
      if (active.frame.remaining() <= 0) {
        successNotifiers.add(active.callback);
        active=null;
      }
    }
    for (    FrameEntry entry : past) {
      successNotifiers.add(entry.callback);
    }
    past.clear();
    flushCallback.succeeded();
  }
  for (  Callback successCallback : successNotifiers) {
    try {
      successCallback.succeeded();
    }
 catch (    Throwable t) {
      LOG.warn("Callback failure",t);
    }
  }
}
