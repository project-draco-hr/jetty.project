{
synchronized (this) {
    generator.getBufferPool().release(buffer);
    if (active == null) {
      return;
    }
    if (active.frame.remaining() <= 0) {
      if (active.callback != null) {
        try {
          active.callback.succeeded();
        }
 catch (        Throwable t) {
          LOG.warn("Callback failure",t);
        }
      }
      active=null;
    }
    flushCallback.succeeded();
  }
}
