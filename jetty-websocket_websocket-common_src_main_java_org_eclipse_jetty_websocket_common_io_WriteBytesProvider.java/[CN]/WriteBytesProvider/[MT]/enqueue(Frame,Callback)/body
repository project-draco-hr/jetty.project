{
  Objects.requireNonNull(frame);
  LOG.debug("enqueue({}, {})",frame,callback);
synchronized (this) {
    if (closed.get()) {
      LOG.debug("Write is closed: {} {}",frame,callback);
      if (callback != null) {
        callback.failed(new IOException("Write is closed"));
      }
      return;
    }
    if (failure != null) {
      LOG.debug("Write is in failure: {} {}",frame,callback);
      notifySafeFailure(callback,failure);
      return;
    }
    FrameEntry entry=new FrameEntry(frame,callback);
switch (frame.getType()) {
case PING:
      queue.addFirst(entry);
    break;
case CLOSE:
  closed.set(true);
queue.addLast(entry);
break;
default :
queue.addLast(entry);
}
}
}
