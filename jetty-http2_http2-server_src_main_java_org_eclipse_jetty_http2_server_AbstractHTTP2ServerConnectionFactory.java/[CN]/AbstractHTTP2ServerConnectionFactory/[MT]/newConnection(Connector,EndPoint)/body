{
  ServerSessionListener listener=newSessionListener(connector,endPoint);
  Generator generator=new Generator(connector.getByteBufferPool(),getMaxHeaderTableSize());
  HTTP2ServerSession session=new HTTP2ServerSession(endPoint,generator,listener,new HTTP2FlowControl(getInitialWindowSize()),getMaxConcurrentStreams());
  Parser parser=newServerParser(connector.getByteBufferPool(),session);
  HTTP2Connection connection=new HTTP2ServerConnection(connector.getByteBufferPool(),connector.getExecutor(),endPoint,parser,getInputBufferSize(),listener,session);
  return configure(connection,connector,endPoint);
}
