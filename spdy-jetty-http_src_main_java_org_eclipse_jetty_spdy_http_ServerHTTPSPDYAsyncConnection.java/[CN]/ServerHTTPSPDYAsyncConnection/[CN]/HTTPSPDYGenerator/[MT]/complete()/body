{
  if (_buffer != null && _buffer.length() > 0) {
    ByteBuffer buffer=ByteBuffer.wrap(_buffer.asArray());
    _buffer.clear();
    _state=STATE_END;
    stream.data(new ByteBufferDataInfo(buffer,true));
  }
 else   if (!closed) {
    ByteBuffer buffer=ByteBuffer.allocate(0);
    closed=true;
    _state=STATE_END;
    stream.data(new ByteBufferDataInfo(buffer,true));
  }
}
