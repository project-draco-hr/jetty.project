{
  HttpOutput out=_out;
  if (length == 0) {
    if (_out.isAllContentWritten())     close();
  }
  while (length > 0) {
    _bytes.reset();
    int chars=length > MAX_OUTPUT_CHARS ? MAX_OUTPUT_CHARS : length;
    _converter.write(s,offset,chars);
    _converter.flush();
    _bytes.writeTo(out);
    length-=chars;
    offset+=chars;
  }
}
