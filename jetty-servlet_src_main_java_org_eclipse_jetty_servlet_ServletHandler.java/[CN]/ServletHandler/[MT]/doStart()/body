{
  _servletContext=ContextHandler.getCurrentContext();
  _contextHandler=(ServletContextHandler)(_servletContext == null ? null : _servletContext.getContextHandler());
  if (_contextHandler != null) {
    _securityHandler=(SecurityHandler)_contextHandler.getChildHandlerByClass(SecurityHandler.class);
    if (_securityHandler != null)     _identityService=_securityHandler.getIdentityService();
  }
  updateNameMappings();
  updateMappings();
  if (_filterChainsCached) {
    _chainCache[FilterMapping.REQUEST]=new ConcurrentHashMap<String,FilterChain>();
    _chainCache[FilterMapping.FORWARD]=new ConcurrentHashMap<String,FilterChain>();
    _chainCache[FilterMapping.INCLUDE]=new ConcurrentHashMap<String,FilterChain>();
    _chainCache[FilterMapping.ERROR]=new ConcurrentHashMap<String,FilterChain>();
    _chainCache[FilterMapping.ASYNC]=new ConcurrentHashMap<String,FilterChain>();
    _chainLRU[FilterMapping.REQUEST]=new ConcurrentLinkedQueue<String>();
    _chainLRU[FilterMapping.FORWARD]=new ConcurrentLinkedQueue<String>();
    _chainLRU[FilterMapping.INCLUDE]=new ConcurrentLinkedQueue<String>();
    _chainLRU[FilterMapping.ERROR]=new ConcurrentLinkedQueue<String>();
    _chainLRU[FilterMapping.ASYNC]=new ConcurrentLinkedQueue<String>();
  }
  super.doStart();
  if (_contextHandler == null || !(_contextHandler instanceof ServletContextHandler))   initialize();
}
