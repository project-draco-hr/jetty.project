{
  if (_filterMappings == null) {
    _filterPathMappings=null;
    _filterNameMappings=null;
  }
 else {
    _filterPathMappings=new ArrayList<>();
    _filterNameMappings=new MultiMap();
    for (    FilterMapping filtermapping : _filterMappings) {
      FilterHolder filter_holder=_filterNameMap.get(filtermapping.getFilterName());
      if (filter_holder == null)       throw new IllegalStateException("No filter named " + filtermapping.getFilterName());
      filtermapping.setFilterHolder(filter_holder);
      if (filtermapping.getPathSpecs() != null)       _filterPathMappings.add(filtermapping);
      if (filtermapping.getServletNames() != null) {
        String[] names=filtermapping.getServletNames();
        for (        String name : names) {
          if (name != null)           _filterNameMappings.add(name,filtermapping);
        }
      }
    }
  }
  if (_servletMappings == null || _servletNameMap == null) {
    _servletPathMap=null;
  }
 else {
    PathMap<ServletHolder> pm=new PathMap<>();
    for (    ServletMapping servletmapping : _servletMappings) {
      ServletHolder servlet_holder=_servletNameMap.get(servletmapping.getServletName());
      if (servlet_holder == null)       throw new IllegalStateException("No such servlet: " + servletmapping.getServletName());
 else       if (servlet_holder.isEnabled() && servletmapping.getPathSpecs() != null) {
        String[] pathSpecs=servletmapping.getPathSpecs();
        for (        String pathSpec : pathSpecs)         if (pathSpec != null)         pm.put(pathSpec,servlet_holder);
      }
    }
    _servletPathMap=pm;
  }
  if (_chainCache != null) {
    for (int i=_chainCache.length; i-- > 0; ) {
      if (_chainCache[i] != null)       _chainCache[i].clear();
    }
  }
  if (LOG.isDebugEnabled()) {
    LOG.debug("filterNameMap=" + _filterNameMap);
    LOG.debug("pathFilters=" + _filterPathMappings);
    LOG.debug("servletFilterMap=" + _filterNameMappings);
    LOG.debug("servletPathMap=" + _servletPathMap);
    LOG.debug("servletNameMap=" + _servletNameMap);
  }
  try {
    if (_contextHandler != null && _contextHandler.isStarted() || _contextHandler == null && isStarted())     initialize();
  }
 catch (  Exception e) {
    throw new RuntimeException(e);
  }
}
