{
  int result=0;
  for (int j=0; j < htmlResources.length; ++j) {
    latch.set(new CountDownLatch(cssResources.length + jsResources.length + pngResources.length));
    String primaryPath="/" + j + ".html";
    String referrer="http://localhost:" + connector.getLocalPort() + primaryPath;
    ++result;
    ContentResponse response=httpClient.newRequest("localhost",connector.getLocalPort()).path(primaryPath).send().get(5,TimeUnit.SECONDS);
    Assert.assertEquals(200,response.status());
    for (int i=0; i < cssResources.length; ++i) {
      String path="/" + i + ".css";
      ++result;
      httpClient.newRequest("localhost",connector.getLocalPort()).path(path).header("Referer",referrer).send(new TestListener());
    }
    for (int i=0; i < jsResources.length; ++i) {
      String path="/" + i + ".js";
      ++result;
      httpClient.newRequest("localhost",connector.getLocalPort()).path(path).header("Referer",referrer).send(new TestListener());
    }
    for (int i=0; i < pngResources.length; ++i) {
      String path="/" + i + ".png";
      ++result;
      httpClient.newRequest("localhost",connector.getLocalPort()).path(path).header("Referer",referrer).send(new TestListener());
    }
    Assert.assertTrue(latch.get().await(5,TimeUnit.SECONDS));
  }
  return result;
}
