{
  super.exchangeTerminated(result);
  if (result.isSucceeded()) {
    HttpFields responseHeaders=result.getResponse().getHeaders();
    Enumeration<String> values=responseHeaders.getValues(HttpHeader.CONNECTION.asString(),",");
    if (values != null) {
      while (values.hasMoreElements()) {
        if (HttpHeaderValue.CLOSE.asString().equalsIgnoreCase(values.nextElement())) {
          connection.close();
          return;
        }
      }
    }
    connection.release();
  }
 else {
    connection.close();
  }
}
