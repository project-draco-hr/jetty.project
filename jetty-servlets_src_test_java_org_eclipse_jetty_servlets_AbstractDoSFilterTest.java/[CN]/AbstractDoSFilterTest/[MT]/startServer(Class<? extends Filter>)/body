{
  _tester=new ServletTester();
  HttpURI uri=new HttpURI(_tester.createChannelConnector(true));
  _host=uri.getHost();
  _port=uri.getPort();
  _tester.setContextPath("/ctx");
  _tester.addServlet(TestServlet.class,"/*");
  _dosFilter=_tester.addFilter(filter,"/dos/*",EnumSet.allOf(DispatcherType.class));
  _dosFilter.setInitParameter("maxRequestsPerSec","4");
  _dosFilter.setInitParameter("delayMs","200");
  _dosFilter.setInitParameter("throttledRequests","1");
  _dosFilter.setInitParameter("waitMs","10");
  _dosFilter.setInitParameter("throttleMs","4000");
  _dosFilter.setInitParameter("remotePort","false");
  _dosFilter.setInitParameter("insertHeaders","true");
  _timeoutFilter=_tester.addFilter(filter,"/timeout/*",EnumSet.allOf(DispatcherType.class));
  _timeoutFilter.setInitParameter("maxRequestsPerSec","4");
  _timeoutFilter.setInitParameter("delayMs","200");
  _timeoutFilter.setInitParameter("throttledRequests","1");
  _timeoutFilter.setInitParameter("waitMs","10");
  _timeoutFilter.setInitParameter("throttleMs","4000");
  _timeoutFilter.setInitParameter("remotePort","false");
  _timeoutFilter.setInitParameter("insertHeaders","true");
  _timeoutFilter.setInitParameter("maxRequestMs",_requestMaxTime + "");
  _tester.start();
}
