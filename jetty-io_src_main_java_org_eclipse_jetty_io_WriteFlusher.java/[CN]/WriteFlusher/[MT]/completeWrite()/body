{
  if (!_writing.get())   return false;
  try {
    _writeBuffers=compact(_writeBuffers);
    _endp.flush(_writeBuffers);
    for (    ByteBuffer b : _writeBuffers) {
      if (b.hasRemaining()) {
        scheduleCompleteWrite();
        return true;
      }
    }
    Callback callback=_writeCallback;
    Object context=_writeContext;
    _writeBuffers=null;
    _writeCallback=null;
    _writeContext=null;
    if (!_writing.compareAndSet(true,false))     throw new ConcurrentModificationException();
    callback.completed(context);
  }
 catch (  IOException e) {
    Callback callback=_writeCallback;
    Object context=_writeContext;
    _writeBuffers=null;
    _writeCallback=null;
    if (!_writing.compareAndSet(true,false))     throw new ConcurrentModificationException();
    callback.failed(context,e);
  }
  return true;
}
