{
  if ("bundleresource".equals(url.getProtocol()) || "bundleentry".equals(url.getProtocol())) {
    try {
      URLConnection conn=url.openConnection();
      conn.setDefaultUseCaches(Resource.getDefaultUseCaches());
      if (BUNDLE_URL_CONNECTION_getFileURL == null && conn.getClass().getName().equals("org.eclipse.osgi.framework.internal.core.BundleURLConnection")) {
        BUNDLE_URL_CONNECTION_getFileURL=conn.getClass().getMethod("getFileURL",null);
        BUNDLE_URL_CONNECTION_getFileURL.setAccessible(true);
      }
      if (BUNDLE_URL_CONNECTION_getFileURL != null) {
        return (URL)BUNDLE_URL_CONNECTION_getFileURL.invoke(conn,null);
      }
    }
 catch (    Throwable t) {
      t.printStackTrace();
    }
  }
  return url;
}
