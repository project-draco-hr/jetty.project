{
  MetaData metaData=frame.getMetaData();
  if (!metaData.isRequest()) {
    onBadMessage(400,null);
    return;
  }
  MetaData.Request request=(MetaData.Request)metaData;
  HttpFields fields=request.getFields();
  if (!fields.contains(HttpHeader.ACCEPT_ENCODING,"gzip"))   fields.add(ACCEPT_ENCODING_GZIP);
  if (getHttpConfiguration().getSendServerVersion())   getResponse().getHttpFields().add(SERVER_VERSION);
  if (getHttpConfiguration().getSendXPoweredBy())   getResponse().getHttpFields().add(POWERED_BY);
  onRequest(request);
  if (frame.isEndStream()) {
    onRequestComplete();
  }
  if (LOG.isDebugEnabled()) {
    LOG.debug("HTTP2 Request #{}:{}{} {} {}{}{}",stream.getId(),System.lineSeparator(),request.getMethod(),request.getURI(),request.getHttpVersion(),System.lineSeparator(),fields);
  }
  execute(this);
}
