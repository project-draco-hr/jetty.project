{
  int l=super.fill(buffer);
  if (l < 0) {
    if (!isInputShutdown())     shutdownInput();
    if (isOutputShutdown())     close();
  }
  return l;
}
