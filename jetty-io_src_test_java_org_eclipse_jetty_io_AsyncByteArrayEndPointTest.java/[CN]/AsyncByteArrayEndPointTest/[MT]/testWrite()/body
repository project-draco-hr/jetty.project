{
  AsyncByteArrayEndPoint endp=new AsyncByteArrayEndPoint(_scheduler,5000,(byte[])null,15);
  endp.setGrowOutput(false);
  endp.setOutput(BufferUtil.allocate(10));
  ByteBuffer data=BufferUtil.toBuffer("Data.");
  ByteBuffer more=BufferUtil.toBuffer(" Some more.");
  FutureCallback<String> fcb=new FutureCallback<>();
  endp.write("CTX",fcb,data);
  assertTrue(fcb.isDone());
  assertEquals("CTX",fcb.get());
  assertEquals("Data.",endp.getOutputString());
  fcb=new FutureCallback<>();
  endp.write("CTX",fcb,more);
  assertFalse(fcb.isDone());
  assertEquals("Data. Some",endp.getOutputString());
  assertEquals("Data. Some",endp.takeOutputString());
  assertTrue(fcb.isDone());
  assertEquals("CTX",fcb.get());
  assertEquals(" more.",endp.getOutputString());
}
