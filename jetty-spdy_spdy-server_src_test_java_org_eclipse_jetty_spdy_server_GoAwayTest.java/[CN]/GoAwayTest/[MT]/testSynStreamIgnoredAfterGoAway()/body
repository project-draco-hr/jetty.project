{
  final CountDownLatch latch=new CountDownLatch(1);
  ServerSessionFrameListener serverSessionFrameListener=new ServerSessionFrameListener.Adapter(){
    private final AtomicInteger syns=new AtomicInteger();
    @Override public StreamFrameListener onSyn(    Stream stream,    SynInfo synInfo){
      int synCount=syns.incrementAndGet();
      if (synCount == 1) {
        stream.reply(new ReplyInfo(true),new Callback.Adapter());
        stream.getSession().goAway(new GoAwayInfo(),new FutureCallback());
      }
 else {
        latch.countDown();
      }
      return null;
    }
  }
;
  SessionFrameListener clientSessionFrameListener=new SessionFrameListener.Adapter(){
    @Override public void onGoAway(    Session session,    GoAwayResultInfo goAwayInfo){
      session.syn(new SynInfo(new Fields(),true),null,new FuturePromise<Stream>());
    }
  }
;
  Session session=startClient(startServer(serverSessionFrameListener),clientSessionFrameListener);
  session.syn(new SynInfo(new Fields(),true),null);
  Assert.assertFalse(latch.await(1,TimeUnit.SECONDS));
}
