{
  if (isStarted())   throw new IllegalStateException();
  final ServletHandler handler=ServletContextHandler.this.getServletHandler();
  final FilterHolder holder=handler.newFilterHolder();
  holder.setName(filterName);
  holder.setFilter(filter);
  handler.addFilter(holder);
  return holder.getRegistration();
}
