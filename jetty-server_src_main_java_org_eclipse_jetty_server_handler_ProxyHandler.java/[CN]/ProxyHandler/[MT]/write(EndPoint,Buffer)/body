{
  if (buffer == null)   return;
  int length=buffer.length();
  StringBuilder builder=new StringBuilder();
  int written=endPoint.flush(buffer);
  builder.append(written);
  buffer.compact();
  if (!endPoint.isBlocking()) {
    while (buffer.space() == 0) {
      boolean ready=endPoint.blockWritable(getWriteTimeout());
      if (!ready)       throw new IOException("Write timeout");
      written=endPoint.flush(buffer);
      builder.append("+").append(written);
      buffer.compact();
    }
  }
  logger.info("Written {}/{} bytes " + endPoint,builder,length);
}
