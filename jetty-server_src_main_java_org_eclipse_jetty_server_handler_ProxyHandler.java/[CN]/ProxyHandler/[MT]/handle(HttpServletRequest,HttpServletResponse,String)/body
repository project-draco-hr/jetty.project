{
  boolean proceed=handleAuthentication(request,response,connectURI);
  if (!proceed)   return;
  String host=connectURI;
  int port=80;
  boolean secure=false;
  int colon=connectURI.indexOf(':');
  if (colon > 0) {
    host=connectURI.substring(0,colon);
    port=Integer.parseInt(connectURI.substring(colon + 1));
    secure=isTunnelSecure(host,port);
  }
  setupTunnel(request,response,host,port,secure);
}
