{
  Objects.requireNonNull(e);
  final Lock tailLock=_tailLock;
  final Lock headLock=_headLock;
  boolean notEmpty=false;
  tailLock.lock();
  try {
    int size=_size.get();
    if (size >= _maxCapacity)     return false;
    if (size == _elements.length) {
      headLock.lock();
      try {
        if (!grow())         return false;
      }
  finally {
        headLock.unlock();
      }
    }
    int tail=_indexes[TAIL_OFFSET];
    _elements[tail]=e;
    _indexes[TAIL_OFFSET]=(tail + 1) % _elements.length;
    notEmpty=_size.getAndIncrement() == 0;
  }
  finally {
    tailLock.unlock();
  }
  if (notEmpty) {
    headLock.lock();
    try {
      _notEmpty.signal();
    }
  finally {
      headLock.unlock();
    }
  }
  return true;
}
