{
  String name=file.getName();
  name=Pattern.compile(".mod$",Pattern.CASE_INSENSITIVE).matcher(name).replaceFirst("");
  Pattern xmlPattern=Pattern.compile(".xml$",Pattern.CASE_INSENSITIVE);
  Set<String> parents=new HashSet<>();
  List<String> xmls=new ArrayList<>();
  List<String> libs=new ArrayList<>();
  try (FileReader reader=new FileReader(file)){
    try (BufferedReader buf=new BufferedReader(reader)){
      String line;
      while ((line=buf.readLine()) != null) {
        line=line.trim();
        if (line.length() <= 0) {
          continue;
        }
        if (line.charAt(0) == '#') {
          continue;
        }
        int idx=line.indexOf('=');
        if (idx >= 0) {
          String key=line.substring(0,idx);
          String value=line.substring(idx + 1);
          boolean handled=false;
switch (key.toUpperCase(Locale.ENGLISH)) {
case "DEPEND":
            parents.add(value);
          handled=true;
        break;
case "LIB":
      libs.add(value);
    handled=true;
  break;
}
if (handled) {
continue;
}
}
if (xmlPattern.matcher(line).find()) {
xmls.add(line);
continue;
}
throw new IllegalArgumentException("Unrecognized Module Metadata line [" + line + "] in Module file ["+ file+ "]");
}
}
 }
 return new Module(name,parents,xmls,libs);
}
