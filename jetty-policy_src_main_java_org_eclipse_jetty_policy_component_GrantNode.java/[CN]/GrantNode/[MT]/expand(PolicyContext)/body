{
  signerArray=resolveToCertificates(context.getKeystore(),signers);
  codebase=context.getEvaluator().evaluate(codebase);
  if (principalNodes != null) {
    Set<Principal> principalSet=new HashSet<Principal>();
    for (Iterator<PrincipalNode> i=principalNodes.iterator(); i.hasNext(); ) {
      PrincipalNode node=i.next();
      node.expand(context);
      principalSet.add(node.toPrincipal(context));
    }
    principals=principalSet.toArray(new Principal[principalSet.size()]);
  }
  permissions=new Permissions();
  for (Iterator<PermissionNode> i=permissionNodes.iterator(); i.hasNext(); ) {
    PermissionNode node=i.next();
    node.expand(context);
    permissions.add(node.toPermission());
  }
  setExpanded(true);
}
