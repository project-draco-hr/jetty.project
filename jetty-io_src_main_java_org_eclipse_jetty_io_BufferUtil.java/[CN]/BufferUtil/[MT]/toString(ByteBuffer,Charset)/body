{
  if (buffer == null)   return null;
  byte[] array=buffer.isReadOnly() ? null : buffer.array();
  if (array == null) {
    byte[] to=new byte[buffer.remaining()];
    buffer.slice().get(to);
    return new String(to,0,to.length,charset);
  }
  return new String(array,buffer.position(),buffer.remaining(),charset);
}
