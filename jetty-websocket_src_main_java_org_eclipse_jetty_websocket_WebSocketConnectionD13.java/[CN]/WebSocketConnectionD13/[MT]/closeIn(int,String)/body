{
  LOG.debug("ClosedIn {} {} {}",this,code,message);
  final boolean close;
  final boolean tell_app;
synchronized (this) {
    close=_closedOut;
    _closedIn=true;
    tell_app=_closeCode == 0;
    if (tell_app) {
      _closeCode=code;
      _closeMessage=message;
    }
  }
  try {
    if (tell_app)     _webSocket.onClose(code,message);
  }
  finally {
    try {
      if (close)       _endp.close();
 else       closeOut(code,message);
    }
 catch (    IOException e) {
      LOG.ignore(e);
    }
  }
}
