{
  int type=getFrameType();
  if (type < 0 || type >= bodyParsers.length) {
    BufferUtil.clear(buffer);
    notifyConnectionFailure(ErrorCode.PROTOCOL_ERROR.code,"unknown_frame_type_" + type);
    return false;
  }
  FrameType frameType=FrameType.from(type);
  if (LOG.isDebugEnabled())   LOG.debug("Parsing {} frame",frameType);
  BodyParser bodyParser=bodyParsers[type];
  if (headerParser.getLength() == 0) {
    bodyParser.emptyBody(buffer);
  }
 else {
    if (!bodyParser.parse(buffer))     return false;
  }
  if (LOG.isDebugEnabled())   LOG.debug("Parsed {} frame",frameType);
  reset();
  return true;
}
