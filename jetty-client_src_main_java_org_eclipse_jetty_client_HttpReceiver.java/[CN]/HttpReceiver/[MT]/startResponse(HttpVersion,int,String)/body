{
  if (updateState(State.IDLE,State.RECEIVE)) {
    HttpExchange exchange=connection.getExchange();
    if (exchange != null) {
      HttpConversation conversation=exchange.getConversation();
      HttpResponse response=exchange.getResponse();
      String method=exchange.getRequest().method();
      parser.setHeadResponse(HttpMethod.HEAD.is(method) || HttpMethod.CONNECT.is(method));
      response.version(version).status(status).reason(reason);
      HttpClient client=connection.getHttpClient();
      ProtocolHandler protocolHandler=client.findProtocolHandler(exchange.getRequest(),response);
      Response.Listener handlerListener=null;
      if (protocolHandler != null) {
        handlerListener=protocolHandler.getResponseListener();
        LOG.debug("Found protocol handler {}",protocolHandler);
      }
      exchange.getConversation().updateResponseListeners(handlerListener);
      LOG.debug("Receiving {}",response);
      ResponseNotifier notifier=connection.getDestination().getResponseNotifier();
      notifier.notifyBegin(conversation.getResponseListeners(),response);
    }
  }
  return false;
}
