{
  configureServer(new EchoHandler());
  byte[] bytes=REQUEST2.getBytes();
  for (int i=0; i < bytes.length; i+=3) {
    int[] points=new int[]{i};
    StringBuilder message=new StringBuilder();
    message.append("iteration #").append(i + 1);
    Arrays.sort(points);
    Socket client=newSocket(HOST,_connector.getLocalPort());
    try {
      OutputStream os=client.getOutputStream();
      writeFragments(bytes,points,message,os);
      String response=readResponse(client);
      assertEquals("response for " + i + " "+ message.toString(),RESPONSE2,response);
    }
  finally {
      client.close();
    }
  }
}
