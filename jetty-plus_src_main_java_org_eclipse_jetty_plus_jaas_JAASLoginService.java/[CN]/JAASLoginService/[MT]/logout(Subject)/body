{
  Set<JAASUserPrincipal> userPrincipals=subject.getPrincipals(JAASUserPrincipal.class);
  if (userPrincipals.size() != 1) {
    throw new ServerAuthException("logout implausible, wrong number of user principals: " + userPrincipals);
  }
  LoginContext loginContext=userPrincipals.iterator().next().getLoginContext();
  try {
    loginContext.logout();
  }
 catch (  LoginException e) {
    throw new ServerAuthException("Failed to log out: " + e.getMessage());
  }
}
