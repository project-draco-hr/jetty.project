{
  @SuppressWarnings("unchecked") Map<String,Object> context=(Map<String,Object>)attachment;
  try {
    SPDYClient client=(SPDYClient)context.get(SPDYClientConnectionFactory.SPDY_CLIENT_CONTEXT_KEY);
    return client.getClientConnectionFactory().newConnection(endPoint,context);
  }
 catch (  Throwable x) {
    @SuppressWarnings("unchecked") Promise<Session> promise=(Promise<Session>)context.get(SPDYClientConnectionFactory.SPDY_SESSION_PROMISE_CONTEXT_KEY);
    promise.failed(x);
    throw x;
  }
}
