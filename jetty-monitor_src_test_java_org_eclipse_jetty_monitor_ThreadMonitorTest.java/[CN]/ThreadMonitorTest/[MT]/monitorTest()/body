{
  ThreadMonitor monitor=new ThreadMonitor(1000,50,2){
    @Override protected void dump(    List<ThreadInfo> threads){
      count.incrementAndGet();
      super.dump(threads);
    }
    @Override protected void dumpAll(){
      countDump.incrementAndGet();
      super.dumpAll();
    }
  }
;
  monitor.enableDumpAll(2000,1);
  monitor.start();
  Spinner spinner=new Spinner();
  Thread runner=new Thread(spinner);
  runner.start();
  Thread.sleep(DURATION);
  spinner.setDone();
  monitor.stop();
  assertTrue(count.get() >= 2);
  assertTrue(countDump.get() >= 1);
}
