{
  while (true) {
    State state=_state.get();
switch (state) {
case PRODUCING:
      if (!_state.compareAndSet(state,State.PENDING))       continue;
    return true;
case PRODUCING_PENDING:
  if (!_state.compareAndSet(state,State.PENDING))   continue;
return false;
default :
throw new IllegalStateException();
}
}
}
