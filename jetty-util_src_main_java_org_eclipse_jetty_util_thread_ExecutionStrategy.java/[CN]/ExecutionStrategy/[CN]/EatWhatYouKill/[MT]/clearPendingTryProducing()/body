{
  while (true) {
    State state=_state.get();
switch (state) {
case IDLE:
      return false;
case PENDING:
    if (!_state.compareAndSet(state,State.PRODUCING))     continue;
  return true;
case PRODUCING_PENDING:
if (!_state.compareAndSet(state,State.PRODUCING)) continue;
return false;
case PRODUCING:
return false;
}
}
}
