{
  byte buf[]=toByteArray("0x02 0x07 0x01 0x81","Hello","0x80 0x06"," world");
  LinkedList<WebSocketFrame> frames=asFrames(buf);
  Assert.assertThat("Frame count",frames.size(),is(2));
  MuxEventCapture capture=parseMuxFrames(frames);
  capture.assertFrameCount(2);
  MuxedFrame mux;
  mux=capture.getFrames().get(0);
  String prefix="MuxFrame[0]";
  Assert.assertThat(prefix + ".channelId",mux.getChannelId(),is(1L));
  Assert.assertThat(prefix + ".rsv1",mux.isRsv1(),is(false));
  Assert.assertThat(prefix + ".rsv2",mux.isRsv2(),is(false));
  Assert.assertThat(prefix + ".rsv3",mux.isRsv3(),is(false));
  Assert.assertThat(prefix + ".masked",mux.isMasked(),is(false));
  Assert.assertThat(prefix + ".opcode",mux.getOpCode(),is(OpCode.TEXT));
  String payload=mux.getPayloadAsUTF8();
  Assert.assertThat(prefix + ".payload/text",payload,is("Hello"));
  mux=capture.getFrames().get(1);
  prefix="MuxFrame[1]";
  Assert.assertThat(prefix + ".rsv1",mux.isRsv1(),is(false));
  Assert.assertThat(prefix + ".rsv2",mux.isRsv2(),is(false));
  Assert.assertThat(prefix + ".rsv3",mux.isRsv3(),is(false));
  Assert.assertThat(prefix + ".masked",mux.isMasked(),is(false));
  payload=mux.getPayloadAsUTF8();
  Assert.assertThat(prefix + ".payload/text",payload,is(" world"));
}
