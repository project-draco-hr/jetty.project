{
  String threadName=Thread.currentThread().getName();
  LOG.info("Starting thread {}",threadName);
  try {
    while (ok.get()) {
      byte[] content=new byte[1024];
      new Random().nextBytes(content);
      ContentResponse response=client.newRequest(host,port).method(HttpMethod.POST).content(new BytesContentProvider(content)).timeout(5,TimeUnit.SECONDS).send();
      if (response.getStatus() != 200) {
        LOG.warn("Got response <{}>, expecting <{}>",response.getStatus(),200);
        ok.set(false);
      }
    }
  }
 catch (  InterruptedException|TimeoutException|ExecutionException e) {
    LOG.warn("Error processing request",e);
    ok.set(false);
  }
 finally {
    LOG.info("Shutting down thread {}",threadName);
    active.countDown();
  }
}
