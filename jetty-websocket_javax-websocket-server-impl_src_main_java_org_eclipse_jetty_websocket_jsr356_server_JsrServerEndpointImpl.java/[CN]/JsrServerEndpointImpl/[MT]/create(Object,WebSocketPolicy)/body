{
  if (!(websocket instanceof EndpointInstance)) {
    throw new IllegalStateException(String.format("Websocket %s must be an %s",websocket.getClass().getName(),EndpointInstance.class.getName()));
  }
  EndpointInstance ei=(EndpointInstance)websocket;
  AnnotatedServerEndpointMetadata metadata=(AnnotatedServerEndpointMetadata)ei.getMetadata();
  JsrEvents events=new JsrEvents(metadata);
  return new JsrAnnotatedEventDriver(policy,ei,events);
}
