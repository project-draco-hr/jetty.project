{
  if (ua == null)   return false;
  if (_excludedAgentPatterns != null) {
    if (_uaCache.contains(ua))     return true;
    for (    Pattern pattern : _excludedAgentPatterns) {
      if (pattern.matcher(ua).matches()) {
        if (_uaCache.size() > _uaCacheSize)         _uaCache.clear();
        _uaCache.add(ua);
        return true;
      }
    }
  }
  return false;
}
