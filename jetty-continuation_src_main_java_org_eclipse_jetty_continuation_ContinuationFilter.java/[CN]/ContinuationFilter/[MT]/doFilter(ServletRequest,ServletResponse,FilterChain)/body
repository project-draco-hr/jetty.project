{
  if (_faux) {
    final FauxContinuation fc=new FauxContinuation(request);
    request.setAttribute(Continuation.ATTRIBUTE,fc);
    boolean complete=false;
    while (!complete) {
      try {
        chain.doFilter(request,response);
      }
 catch (      ContinuationThrowable e) {
        debug("faux",e);
      }
 finally {
        complete=fc.handleSuspension();
      }
    }
    fc.onComplete();
  }
 else   if (_partial) {
    Continuation c=(Continuation)request.getAttribute(Continuation.ATTRIBUTE);
    try {
      if (c == null || !(c instanceof PartialContinuation) || ((PartialContinuation)c).enter())       chain.doFilter(request,response);
    }
  finally {
      if (c == null)       c=(Continuation)request.getAttribute(Continuation.ATTRIBUTE);
      if (c != null && c instanceof PartialContinuation)       ((PartialContinuation)c).exit();
    }
  }
 else {
    try {
      chain.doFilter(request,response);
    }
 catch (    ContinuationThrowable e) {
      debug("caught",e);
    }
  }
}
