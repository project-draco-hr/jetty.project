{
  Throwable failure;
synchronized (lock) {
    failure=this.failure;
    if (failure == null) {
      int index=0;
      int size=queue.size();
      while (index < size) {
        StandardSession.FrameBytes element=queue.getUnsafe(index);
        if (element.compareTo(frameBytes) <= 0)         break;
        ++index;
      }
      queue.add(index,frameBytes);
    }
  }
  if (failure == null)   flush();
 else   frameBytes.failed(new SPDYException(failure));
}
