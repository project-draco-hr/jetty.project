{
  Class<?> websocketClass=websocket.getClass();
  ClientEndpoint wsclient=websocketClass.getAnnotation(ClientEndpoint.class);
  if (wsclient == null) {
    throw new InvalidWebSocketException("Cannot handle @ClientEndpoint annotations here");
  }
  JsrAnnotatedMetadata metadata=cache.get(websocketClass);
  if (metadata == null) {
    JsrAnnotatedClientScanner scanner=new JsrAnnotatedClientScanner(websocketClass);
    metadata=scanner.scan();
    cache.put(websocketClass,metadata);
  }
  return new JsrAnnotatedClientEventDriver(policy,websocket,metadata);
}
