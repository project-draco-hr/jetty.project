{
  HttpServletRequest base_request=(HttpServletRequest)request;
  if (base_request.getUserPrincipal() != null)   return 2;
 else {
    HttpSession session=base_request.getSession(false);
    if (session != null && !session.isNew())     return 1;
 else     return 0;
  }
}
