{
  List<MessageHandlerMetadata> ret=new ArrayList<>();
  boolean partial=false;
  if (MessageHandler.Partial.class.isAssignableFrom(handler)) {
    LOG.debug("supports Partial: {}",handler);
    partial=true;
    Class<?> onMessageClass=ReflectUtils.findGenericClassFor(handler,MessageHandler.Partial.class);
    LOG.debug("Partial message class: {}",onMessageClass);
    MessageType onMessageType=identifyMessageType(onMessageClass);
    LOG.debug("Partial message type: {}",onMessageType);
    ret.add(new MessageHandlerMetadata(handler,onMessageType,onMessageClass,partial));
  }
  if (MessageHandler.Whole.class.isAssignableFrom(handler)) {
    LOG.debug("supports Whole: {}",handler.getName());
    partial=false;
    Class<?> onMessageClass=ReflectUtils.findGenericClassFor(handler,MessageHandler.Whole.class);
    LOG.debug("Whole message class: {}",onMessageClass);
    MessageType onMessageType=identifyMessageType(onMessageClass);
    LOG.debug("Whole message type: {}",onMessageType);
    MessageHandlerMetadata metadata=new MessageHandlerMetadata(handler,onMessageType,onMessageClass,partial);
    ret.add(metadata);
  }
  return ret;
}
