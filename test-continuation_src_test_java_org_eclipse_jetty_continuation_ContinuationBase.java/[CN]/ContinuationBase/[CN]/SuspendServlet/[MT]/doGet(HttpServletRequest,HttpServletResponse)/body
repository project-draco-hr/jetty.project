{
  final Continuation continuation=ContinuationSupport.getContinuation(request,response);
  response.addHeader("history",continuation.getClass().toString());
  int read_before=0;
  long sleep_for=-1;
  long suspend_for=-1;
  long resume_after=-1;
  long complete_after=-1;
  if (request.getParameter("read") != null)   read_before=Integer.parseInt(request.getParameter("read"));
  if (request.getParameter("sleep") != null)   sleep_for=Integer.parseInt(request.getParameter("sleep"));
  if (request.getParameter("suspend") != null)   suspend_for=Integer.parseInt(request.getParameter("suspend"));
  if (request.getParameter("resume") != null)   resume_after=Integer.parseInt(request.getParameter("resume"));
  if (request.getParameter("complete") != null)   complete_after=Integer.parseInt(request.getParameter("complete"));
  if (continuation.isInitial()) {
    if (read_before > 0) {
      byte[] buf=new byte[read_before];
      request.getInputStream().read(buf);
    }
 else     if (read_before < 0) {
      InputStream in=request.getInputStream();
      int b=in.read();
      while (b != -1)       b=in.read();
    }
    if (suspend_for >= 0) {
      if (suspend_for > 0)       continuation.setTimeout(suspend_for);
      continuation.addContinuationListener(__listener);
      continuation.suspend();
      if (complete_after > 0) {
        TimerTask complete=new TimerTask(){
          public void run(){
            try {
              response.setStatus(200);
              response.getOutputStream().println("COMPLETED\n");
              continuation.complete();
            }
 catch (            Exception e) {
              e.printStackTrace();
            }
          }
        }
;
synchronized (_timer) {
          _timer.schedule(complete,complete_after);
        }
      }
 else       if (complete_after == 0) {
        response.setStatus(200);
        response.getOutputStream().println("COMPLETED\n");
        continuation.complete();
      }
 else       if (resume_after > 0) {
        TimerTask resume=new TimerTask(){
          public void run(){
            continuation.resume();
          }
        }
;
synchronized (_timer) {
          _timer.schedule(resume,resume_after);
        }
      }
 else       if (resume_after == 0) {
        continuation.resume();
      }
    }
 else     if (sleep_for >= 0) {
      try {
        Thread.sleep(sleep_for);
      }
 catch (      InterruptedException e) {
        e.printStackTrace();
      }
      response.setStatus(200);
      response.getOutputStream().println("SLEPT\n");
    }
 else {
      response.setStatus(200);
      response.getOutputStream().println("NORMAL\n");
    }
  }
 else   if (continuation.isExpired()) {
    response.setStatus(200);
    response.getOutputStream().println("TIMEOUT\n");
  }
 else   if (continuation.isResumed()) {
    response.setStatus(200);
    response.getOutputStream().println("RESUMED\n");
  }
 else {
    response.setStatus(200);
    response.getOutputStream().println("unknown???\n");
  }
}
