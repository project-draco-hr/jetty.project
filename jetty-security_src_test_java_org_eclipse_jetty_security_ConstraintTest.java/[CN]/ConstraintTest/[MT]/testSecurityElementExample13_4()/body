{
  HttpConstraintElement httpConstraintElement=new HttpConstraintElement(TransportGuarantee.NONE,"R1");
  ServletSecurityElement element=new ServletSecurityElement(httpConstraintElement);
  List<ConstraintMapping> mappings=ConstraintSecurityHandler.createConstraintsWithMappingsForPath("foo","/foo/*",element);
  assertTrue(!mappings.isEmpty());
  assertEquals(1,mappings.size());
  ConstraintMapping mapping=mappings.get(0);
  assertTrue(mapping.getConstraint().getAuthenticate());
  assertTrue(mapping.getConstraint().getRoles() != null);
  assertEquals(1,mapping.getConstraint().getRoles().length);
  assertEquals("R1",mapping.getConstraint().getRoles()[0]);
  assertEquals(0,mapping.getConstraint().getDataConstraint());
}
