{
  _security.setAuthenticator(new BasicAuthenticator());
  _server.start();
  String response;
  response=_connector.getResponses("GET /ctx/noauth/info HTTP/1.0\r\n\r\n");
  assertThat(response,startsWith("HTTP/1.1 200 OK"));
  response=_connector.getResponses("GET /ctx/forbid/info HTTP/1.0\r\n\r\n");
  assertThat(response,startsWith("HTTP/1.1 403 Forbidden"));
  response=_connector.getResponses("GET /ctx/auth/info HTTP/1.0\r\n\r\n");
  assertThat(response,startsWith("HTTP/1.1 401 Unauthorized"));
  assertThat(response,containsString("WWW-Authenticate: basic realm=\"TestRealm\""));
  response=_connector.getResponses("GET /ctx/auth/info HTTP/1.0\r\n" + "Authorization: Basic " + B64Code.encode("user:wrong") + "\r\n"+ "\r\n");
  assertThat(response,startsWith("HTTP/1.1 401 Unauthorized"));
  assertThat(response,containsString("WWW-Authenticate: basic realm=\"TestRealm\""));
  response=_connector.getResponses("GET /ctx/auth/info HTTP/1.0\r\n" + "Authorization: Basic " + B64Code.encode("user3:password") + "\r\n"+ "\r\n");
  assertThat(response,startsWith("HTTP/1.1 403"));
  response=_connector.getResponses("GET /ctx/auth/info HTTP/1.0\r\n" + "Authorization: Basic " + B64Code.encode("user2:password") + "\r\n"+ "\r\n");
  assertThat(response,startsWith("HTTP/1.1 200 OK"));
  response=_connector.getResponses("GET /ctx/admin/info HTTP/1.0\r\n\r\n");
  assertThat(response,startsWith("HTTP/1.1 401 Unauthorized"));
  assertThat(response,containsString("WWW-Authenticate: basic realm=\"TestRealm\""));
  response=_connector.getResponses("GET /ctx/admin/info HTTP/1.0\r\n" + "Authorization: Basic " + B64Code.encode("admin:wrong") + "\r\n"+ "\r\n");
  assertThat(response,startsWith("HTTP/1.1 401 Unauthorized"));
  assertThat(response,containsString("WWW-Authenticate: basic realm=\"TestRealm\""));
  response=_connector.getResponses("GET /ctx/admin/info HTTP/1.0\r\n" + "Authorization: Basic " + B64Code.encode("user:password") + "\r\n"+ "\r\n");
  assertThat(response,startsWith("HTTP/1.1 403 "));
  assertThat(response,containsString("!role"));
  response=_connector.getResponses("GET /ctx/admin/info HTTP/1.0\r\n" + "Authorization: Basic " + B64Code.encode("admin:password") + "\r\n"+ "\r\n");
  assertThat(response,startsWith("HTTP/1.1 200 OK"));
  response=_connector.getResponses("GET /ctx/admin/relax/info HTTP/1.0\r\n\r\n");
  assertThat(response,startsWith("HTTP/1.1 200 OK"));
}
