{
  RoleCheckHandler check=new RoleCheckHandler();
  _security.setHandler(check);
  _security.setAuthenticator(new BasicAuthenticator());
  _security.setStrict(false);
  _server.start();
  System.out.println(_server.dump());
  String response;
  response=_connector.getResponses("GET /ctx/noauth/info HTTP/1.0\r\n\r\n",100000,TimeUnit.MILLISECONDS);
  assertThat(response,startsWith("HTTP/1.1 200 OK"));
  response=_connector.getResponses("GET /ctx/auth/info HTTP/1.0\r\n" + "Authorization: Basic " + B64Code.encode("user2:password") + "\r\n"+ "\r\n",100000,TimeUnit.MILLISECONDS);
  assertThat(response,startsWith("HTTP/1.1 500 "));
  _server.stop();
  _connector=new LocalConnector(_server);
  _server.setConnectors(new Connector[]{_connector});
  ContextHandler _context=new ContextHandler();
  SessionHandler _session=new SessionHandler();
  _context.setContextPath("/ctx");
  _server.setHandler(_context);
  _context.setHandler(_session);
  _security=new ConstraintSecurityHandler();
  _session.setHandler(_security);
  RequestHandler _handler=new RequestHandler();
  _security.setHandler(_handler);
  RoleRefHandler roleref=new RoleRefHandler();
  _security.setHandler(roleref);
  roleref.setHandler(check);
  _security.setConstraintMappings(getConstraintMappings(),getKnownRoles());
  _server.start();
  System.out.println(_server.dump());
  response=_connector.getResponses("GET /ctx/auth/info HTTP/1.0\r\n" + "Authorization: Basic " + B64Code.encode("user2:password") + "\r\n"+ "\r\n",100000,TimeUnit.MILLISECONDS);
  assertThat(response,startsWith("HTTP/1.1 200 OK"));
}
