{
  _security.setAuthenticator(new BasicAuthenticator());
  _server.start();
  String response;
  response=_connector.getResponses("GET /ctx/data/info HTTP/1.0\r\n\r\n");
  assertTrue(response.startsWith("HTTP/1.1 403"));
  _connector.setConfidentialPort(8443);
  _connector.setConfidentialScheme("https");
  response=_connector.getResponses("GET /ctx/data/info HTTP/1.0\r\n\r\n");
  assertTrue(response.startsWith("HTTP/1.1 302 Found"));
  assertTrue(response.indexOf("Location") > 0);
  assertTrue(response.indexOf(":8443/ctx/data/info") > 0);
  _connector.setConfidentialPort(443);
  response=_connector.getResponses("GET /ctx/data/info HTTP/1.0\r\n\r\n");
  assertTrue(response.startsWith("HTTP/1.1 302 Found"));
  assertTrue(response.indexOf("Location") > 0);
  assertTrue(response.indexOf(":443/ctx/data/info") < 0);
  _connector.setConfidentialPort(8443);
  response=_connector.getResponses("GET /ctx/data/info HTTP/1.0\r\nHost: wobble.com\r\n\r\n");
  assertTrue(response.startsWith("HTTP/1.1 302 Found"));
  assertTrue(response.indexOf("Location") > 0);
  assertTrue(response.indexOf("https://wobble.com:8443/ctx/data/info") > 0);
  _connector.setConfidentialPort(443);
  response=_connector.getResponses("GET /ctx/data/info HTTP/1.0\r\nHost: wobble.com\r\n\r\n");
  System.err.println(response);
  assertTrue(response.startsWith("HTTP/1.1 302 Found"));
  assertTrue(response.indexOf("Location") > 0);
  assertTrue(response.indexOf(":443") < 0);
  assertTrue(response.indexOf("https://wobble.com/ctx/data/info") > 0);
}
