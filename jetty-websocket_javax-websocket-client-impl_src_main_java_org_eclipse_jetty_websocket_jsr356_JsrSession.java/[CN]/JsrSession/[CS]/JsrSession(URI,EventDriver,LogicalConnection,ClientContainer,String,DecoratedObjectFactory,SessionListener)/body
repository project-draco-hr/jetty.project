{
  super(requestURI,websocket,connection,sessionListeners);
  if (!(websocket instanceof AbstractJsrEventDriver)) {
    throw new IllegalArgumentException("Cannot use, not a JSR WebSocket: " + websocket);
  }
  AbstractJsrEventDriver jsr=(AbstractJsrEventDriver)websocket;
  this.config=jsr.getConfig();
  this.metadata=jsr.getMetadata();
  this.container=container;
  this.id=id;
  this.decoderFactory=new DecoderFactory(metadata.getDecoders(),container.getDecoderFactory(),objectFactory);
  this.encoderFactory=new EncoderFactory(metadata.getEncoders(),container.getEncoderFactory(),objectFactory);
  this.messageHandlerFactory=new MessageHandlerFactory();
  this.wrappers=new MessageHandlerWrapper[MessageType.values().length];
  this.messageHandlerSet=new HashSet<>();
}
