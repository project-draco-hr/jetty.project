{
  WebSocketClientFactory factory=new WebSocketClientFactory();
  SimpleEchoSocket socket=new SimpleEchoSocket();
  try {
    factory.start();
    WebSocketClient client=factory.newWebSocketClient(socket);
    URI echoUri=new URI("ws://echo.websocket.org");
    System.out.printf("Connecting to : %s%n",echoUri);
    client.connect(echoUri);
    socket.awaitClose(5,TimeUnit.SECONDS);
  }
 catch (  Throwable t) {
    t.printStackTrace();
  }
 finally {
    try {
      factory.stop();
    }
 catch (    Exception e) {
      e.printStackTrace();
    }
  }
}
