{
  if (content.getContentType() != null && response.getContentType() == null)   response.setContentType(content.getContentType().toString());
  if (response instanceof Response) {
    Response r=(Response)response;
    HttpFields fields=r.getHttpFields();
    if (content.getLastModified() != null)     fields.put(HttpHeader.LAST_MODIFIED,content.getLastModified());
 else     if (content.getResource() != null) {
      long lml=content.getResource().lastModified();
      if (lml != -1)       fields.putDateField(HttpHeader.LAST_MODIFIED,lml);
    }
    if (count != -1)     r.setLongContentLength(count);
    writeOptionHeaders(fields);
  }
 else {
    long lml=content.getResource().lastModified();
    if (lml >= 0)     response.setDateHeader(HttpHeader.LAST_MODIFIED.asString(),lml);
    if (count != -1) {
      if (count < Integer.MAX_VALUE)       response.setContentLength((int)count);
 else       response.setHeader(HttpHeader.CONTENT_LENGTH.asString(),Long.toString(count));
    }
    writeOptionHeaders(response);
  }
}
