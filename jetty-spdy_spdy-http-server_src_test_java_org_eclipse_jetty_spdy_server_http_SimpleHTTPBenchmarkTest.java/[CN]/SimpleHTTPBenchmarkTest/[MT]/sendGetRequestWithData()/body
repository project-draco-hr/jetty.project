{
  final CountDownLatch replyLatch=new CountDownLatch(1);
  final CountDownLatch dataLatch=new CountDownLatch(1);
  final String path="/foo";
  Fields headers=SPDYTestUtils.createHeaders("localhost",connector.getLocalPort(),version,"GET",path);
  session.syn(new SynInfo(headers,true),new StreamFrameListener.Adapter(){
    @Override public void onReply(    Stream stream,    ReplyInfo replyInfo){
      Fields replyHeaders=replyInfo.getHeaders();
      assertThat(replyHeaders.get(HTTPSPDYHeader.STATUS.name(version)).getValue().contains("200"),CoreMatchers.is(true));
      assertThat(replyHeaders.get(HttpHeader.SERVER.asString()),CoreMatchers.is(notNullValue()));
      assertThat(replyHeaders.get(HttpHeader.X_POWERED_BY.asString()),CoreMatchers.is(notNullValue()));
      replyLatch.countDown();
    }
    @Override public void onData(    Stream stream,    DataInfo dataInfo){
      dataInfo.consume(dataInfo.available());
      if (dataInfo.isClose())       dataLatch.countDown();
    }
  }
);
  assertThat("reply has been received",replyLatch.await(5,TimeUnit.SECONDS),is(true));
  assertThat("data has been received",dataLatch.await(5,TimeUnit.SECONDS),is(true));
}
