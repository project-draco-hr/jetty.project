{
  WebSocketPolicy policy=WebSocketPolicy.newServerPolicy();
  FrameCompressionExtension ext=new FrameCompressionExtension();
  ext.setBufferPool(new MappedByteBufferPool());
  ext.setPolicy(policy);
  ExtensionConfig config=ExtensionConfig.parse("x-webkit-deflate-frame");
  ext.setConfig(config);
  ByteBufferPool bufferPool=new MappedByteBufferPool();
  boolean validating=true;
  Generator generator=new Generator(policy,bufferPool,validating);
  generator.configureFromExtensions(Collections.singletonList(ext));
  OutgoingNetworkBytesCapture capture=new OutgoingNetworkBytesCapture(generator);
  ext.setNextOutgoingFrames(capture);
  ext.outgoingFrame(WebSocketFrame.text("Hello"),null);
  ext.outgoingFrame(WebSocketFrame.text("There"),null);
  capture.assertBytes(0,"c107f248cdc9c90700");
  capture.assertBytes(1,"c1070ac9482d4a0500");
}
