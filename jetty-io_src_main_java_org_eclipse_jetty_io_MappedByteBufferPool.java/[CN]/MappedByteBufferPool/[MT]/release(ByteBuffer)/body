{
  if (LOG.isDebugEnabled()) {
    LOG.debug("release({})",BufferUtil.toDetailString(buffer));
  }
  if (buffer == null)   return;
  if (buffer.capacity() < factor)   return;
  int bucket=bucketFor(buffer.capacity());
  ConcurrentMap<Integer,Queue<ByteBuffer>> buffers=buffersFor(buffer.isDirect());
  Queue<ByteBuffer> byteBuffers=buffers.get(bucket);
  if (byteBuffers == null) {
    byteBuffers=new ConcurrentLinkedQueue<>();
    Queue<ByteBuffer> existing=buffers.putIfAbsent(bucket,byteBuffers);
    if (existing != null)     byteBuffers=existing;
  }
  BufferUtil.clear(buffer);
  byteBuffers.offer(buffer);
}
