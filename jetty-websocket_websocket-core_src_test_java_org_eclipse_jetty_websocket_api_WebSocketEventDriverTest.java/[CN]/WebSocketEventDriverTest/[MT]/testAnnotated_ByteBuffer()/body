{
  AnnotatedBasicSocket socket=new AnnotatedBasicSocket();
  WebSocketEventDriver driver=newDriver(socket);
  LocalWebSocketConnection conn=new LocalWebSocketConnection(testname);
  driver.setConnection(conn);
  driver.onConnect();
  driver.onFrame(new BinaryFrame("Hello World".getBytes(StringUtil.__UTF8_CHARSET)));
  driver.onFrame(new CloseFrame(StatusCode.NORMAL));
  socket.capture.assertEventCount(3);
  socket.capture.assertEventStartsWith(0,"onConnect");
  socket.capture.assertEvent(1,"onBinary(java.nio.HeapByteBuffer[pos=0 lim=11 cap=11])");
  socket.capture.assertEventStartsWith(2,"onClose(1000,");
}
