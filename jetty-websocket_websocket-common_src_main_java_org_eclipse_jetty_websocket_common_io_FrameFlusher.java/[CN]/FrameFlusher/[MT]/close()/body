{
synchronized (lock) {
    if (!closed) {
      closed=true;
      EOFException eof=new EOFException("Connection has been disconnected");
      flusherCB.failed(eof);
      for (      FrameEntry frame : queue)       frame.notifyFailed(eof);
      queue.clear();
    }
  }
}
