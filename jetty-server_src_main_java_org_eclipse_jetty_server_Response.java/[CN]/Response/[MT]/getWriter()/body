{
  if (_outputState == OutputState.STREAM)   throw new IllegalStateException("STREAM");
  if (_writer == null) {
    String encoding=_characterEncoding;
    if (encoding == null) {
      encoding=MimeTypes.inferCharsetFromContentType(_contentType);
      if (encoding == null)       encoding=StringUtil.__ISO_8859_1;
      setCharacterEncoding(encoding);
    }
    _writer=_channel.getPrintWriter(encoding);
  }
  _outputState=OutputState.WRITER;
  return _writer;
}
