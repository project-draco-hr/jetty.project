{
  if (isCommitted() || _connection.isIncluding())   return;
  if (contentType == null) {
    if (_locale == null)     _characterEncoding=null;
    _mimeType=null;
    _contentType=null;
    _fields.remove(HttpHeader.CONTENT_TYPE);
  }
 else {
    _contentType=contentType;
    _mimeType=MimeTypes.CACHE.get(contentType);
    String charset=_mimeType == null ? MimeTypes.getCharsetFromContentType(contentType) : _mimeType.getCharset().toString();
    if (charset != null)     _characterEncoding=charset;
 else     if (_characterEncoding != null) {
      _contentType=contentType + ";charset=" + _characterEncoding;
      _mimeType=null;
    }
    _fields.put(HttpHeader.CONTENT_TYPE,_contentType);
  }
}
