{
  resetBuffer();
  fwdReset();
  _status=200;
  _reason=null;
  HttpFields response_fields=_connection.getResponseFields();
  response_fields.clear();
  String connection=_connection.getRequestFields().getStringField(HttpHeader.CONNECTION);
  if (connection != null) {
    String[] values=connection.split(",");
    for (int i=0; values != null && i < values.length; i++) {
      CachedBuffer cb=HttpHeaderValue.CACHE.get(values[0].trim());
      if (cb != null) {
switch (cb.getOrdinal()) {
case HttpHeaderValue.CLOSE_ORDINAL:
          response_fields.put(HttpHeader.CONNECTION,HttpHeaderValue.CLOSE);
        break;
case HttpHeaderValue.KEEP_ALIVE_ORDINAL:
      if (HttpVersion.HTTP_1_0.equalsIgnoreCase(_connection.getRequest().getProtocol()))       response_fields.put(HttpHeader.CONNECTION,HttpHeaderValue.KEEP_ALIVE);
    break;
case HttpHeaderValue.TE_ORDINAL:
  response_fields.put(HttpHeader.CONNECTION,HttpHeaderValue.TE);
break;
}
}
}
}
}
