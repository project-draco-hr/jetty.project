{
  resetBuffer();
  fwdReset();
  _status=200;
  _reason=null;
  _contentLength=-1;
  HttpFields response_fields=_fields;
  response_fields.clear();
  String connection=_channel.getRequestFields().getStringField(HttpHeader.CONNECTION);
  if (connection != null) {
    String[] values=connection.split(",");
    for (int i=0; values != null && i < values.length; i++) {
      HttpHeaderValue cb=HttpHeaderValue.CACHE.get(values[0].trim());
      if (cb != null) {
switch (cb) {
case CLOSE:
          response_fields.put(HttpHeader.CONNECTION,HttpHeaderValue.CLOSE.toString());
        break;
case KEEP_ALIVE:
      if (HttpVersion.HTTP_1_0.is(_channel.getRequest().getProtocol()))       response_fields.put(HttpHeader.CONNECTION,HttpHeaderValue.KEEP_ALIVE.toString());
    break;
case TE:
  response_fields.put(HttpHeader.CONNECTION,HttpHeaderValue.TE.toString());
break;
}
}
}
}
}
