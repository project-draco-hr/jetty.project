{
  if (URIUtil.hasScheme(url)) {
    HttpURI uri=new HttpURI(url);
    Request request=_connection.getRequest();
    int port=uri.getPort();
    if (port < 0)     port=HttpSchemes.HTTPS.equalsIgnoreCase(uri.getScheme()) ? 443 : 80;
    if (request.getServerName().equalsIgnoreCase(uri.getHost()) && request.getServerPort() == port && uri.getPath().startsWith(request.getContextPath()))     return encodeURL(url);
    return url;
  }
  return encodeURL(url);
}
