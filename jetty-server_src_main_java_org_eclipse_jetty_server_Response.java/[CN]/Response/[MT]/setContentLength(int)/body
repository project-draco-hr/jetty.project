{
  if (isCommitted() || _channel.isIncluding())   return;
  _contentLength=len;
  if (len >= 0) {
    _fields.putLongField(HttpHeader.CONTENT_LENGTH.toString(),(long)len);
    if (_transport.isAllContentWritten()) {
switch (_outputState) {
case WRITER:
        _writer.close();
      break;
case STREAM:
    try {
      getOutputStream().close();
    }
 catch (    IOException e) {
      throw new RuntimeException(e);
    }
}
}
}
}
