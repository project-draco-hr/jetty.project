{
  logger.debug("Processing {}, {} data bytes",frame,data.remaining());
  if (goAwaySent.get()) {
    logger.debug("Skipped processing of {}",frame);
    return;
  }
  int streamId=frame.getStreamId();
  final IStream stream=streams.get(streamId);
  if (stream == null) {
    RstInfo rstInfo=new RstInfo(streamId,StreamStatus.INVALID_STREAM);
    logger.debug("Unknown stream {}",rstInfo);
    rst(rstInfo);
  }
 else {
    stream.post(new Runnable(){
      @Override public void run(){
        stream.handle(frame,data);
        if (stream.isClosed()) {
          updateLastStreamId(stream);
          removeStream(stream);
        }
      }
    }
);
  }
}
