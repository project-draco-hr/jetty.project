{
  final IStream stream=new StandardStream(this,frame);
  logger.debug("Opening {}",stream);
  int streamId=frame.getStreamId();
  IStream existing=streams.putIfAbsent(streamId,stream);
  if (existing != null) {
    RstInfo rstInfo=new RstInfo(streamId,StreamStatus.PROTOCOL_ERROR);
    logger.debug("Duplicate stream, {}",rstInfo);
    rst(rstInfo);
  }
 else {
    stream.post(new Runnable(){
      @Override public void run(){
        stream.handle(frame);
        SynInfo synInfo=new SynInfo(frame.getHeaders(),frame.isClose(),frame.isUnidirectional(),frame.getAssociatedStreamId(),frame.getPriority());
        StreamFrameListener listener=notifyOnSyn(stream,synInfo);
        stream.setStreamFrameListener(listener);
        flush();
        if (stream.isClosed())         removeStream(stream);
      }
    }
);
  }
}
