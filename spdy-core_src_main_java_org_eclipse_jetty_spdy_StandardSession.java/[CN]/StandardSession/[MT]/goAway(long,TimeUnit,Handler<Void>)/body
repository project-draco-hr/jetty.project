{
  if (goAwaySent.compareAndSet(false,true)) {
    if (!goAwayReceived.get()) {
      GoAwayFrame frame=new GoAwayFrame(version,lastStreamId.get(),SessionStatus.OK.getCode());
      control(null,frame,timeout,unit,handler,null);
      return;
    }
  }
  notifyHandlerCompleted(handler,null);
}
