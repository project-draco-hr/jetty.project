{
  CachedHttpContent content=null;
  if (resource == null || !resource.exists())   return null;
  if (!resource.isDirectory() && isCacheable(resource)) {
    content=new CachedHttpContent(pathInContext,resource);
    shrinkCache();
    CachedHttpContent added=_cache.putIfAbsent(pathInContext,content);
    if (added != null) {
      content.invalidate();
      content=added;
    }
    return content;
  }
  return new ResourceHttpContent(resource,_mimeTypes.getMimeByExtension(resource.toString()),getMaxCachedFileSize(),_etagSupported);
}
