{
  server=new Server();
  connector=new SelectChannelConnector(){
    @Override protected AsyncConnection newConnection(    SocketChannel channel,    AsyncEndPoint endpoint){
      return new AsyncHttpConnection(this,endpoint,getServer()){
        @Override public Connection handle() throws IOException {
          handles.incrementAndGet();
          return super.handle();
        }
      }
;
    }
  }
;
  server.addConnector(connector);
  connector.setPort(0);
  server.setHandler(handler);
  server.start();
}
