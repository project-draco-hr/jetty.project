{
  String string="Hell\uFF4f Medium W\uFF4Frld ";
  for (int i=0; i < 4; i++)   string=string + string;
  string+=". The end.";
  byte[] bytes=string.getBytes(StringUtil.__UTF8);
  _in.putUnmasked((byte)0x81);
  _in.putUnmasked((byte)(0x80 | 0x7E));
  _in.putUnmasked((byte)(bytes.length >> 8));
  _in.putUnmasked((byte)(bytes.length & 0xff));
  _in.sendMask();
  _in.put(bytes);
  int progress=_parser.parseNext();
  assertTrue(progress > 0);
  assertEquals(string,_handler._data.get(0));
  assertEquals(0x8,_handler._flags);
  assertEquals(0x1,_handler._opcode);
  _parser.returnBuffer();
  assertTrue(_parser.isBufferEmpty());
  assertTrue(_parser.getBuffer() == null);
}
