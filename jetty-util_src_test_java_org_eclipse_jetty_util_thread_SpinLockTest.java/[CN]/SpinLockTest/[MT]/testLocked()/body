{
  SpinLock lock=new SpinLock();
  assertFalse(lock.isLocked());
  try (SpinLock.Lock l=lock.lock()){
    assertTrue(lock.isLocked());
  }
  finally {
    assertFalse(lock.isLocked());
  }
  assertFalse(lock.isLocked());
}
