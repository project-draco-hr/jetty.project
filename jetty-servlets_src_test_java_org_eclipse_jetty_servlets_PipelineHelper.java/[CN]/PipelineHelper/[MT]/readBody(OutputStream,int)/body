{
  int left=size;
  while (left > 0) {
    int val=inputStream.read();
    if (val == (-1)) {
      Assert.fail(String.format("Encountered an early EOL (expected another %,d bytes)",left));
    }
    stream.write(val);
    left--;
  }
  return size - left;
}
