{
  final Throwable error;
  final ReadListener listener;
  final boolean eof;
synchronized (_inputQ) {
    if (!_unready || _listener == null)     return;
    listener=_listener;
    error=_state instanceof ErrorState ? ((ErrorState)_state).getError() : null;
    eof=isFinished();
    _unready=false;
  }
  try {
    if (error != null)     listener.onError(error);
 else     if (eof)     listener.onAllDataRead();
 else {
      listener.onDataAvailable();
      if (isFinished())       listener.onAllDataRead();
    }
  }
 catch (  Throwable e) {
    LOG.warn(e.toString());
    LOG.debug(e);
    listener.onError(e);
  }
}
