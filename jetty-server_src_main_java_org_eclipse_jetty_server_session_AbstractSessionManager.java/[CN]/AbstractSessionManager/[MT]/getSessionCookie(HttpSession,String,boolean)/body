{
  if (isUsingCookies()) {
    String id=getNodeId(session);
    Cookie cookie=new Cookie(_sessionCookie,id);
    cookie.setHttpOnly(getHttpOnly());
    cookie.setPath((contextPath == null || contextPath.length() == 0) ? "/" : contextPath);
    cookie.setMaxAge(getMaxCookieAge());
    cookie.setSecure(requestIsSecure && getSecureCookies());
    if (_sessionDomain != null)     cookie.setDomain(_sessionDomain);
    if (_sessionPath != null)     cookie.setPath(_sessionPath);
    return cookie;
  }
  return null;
}
