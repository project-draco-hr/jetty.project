{
  LOG.debug("Payload Length: " + len);
  if (len > Integer.MAX_VALUE) {
    throw new MessageTooLargeException("[int-sane!] cannot handle payload lengths larger than " + Integer.MAX_VALUE);
  }
  policy.assertValidPayloadLength((int)len);
  if (frame.getOpCode().isControlFrame()) {
    if (payloadLength > WebSocketFrame.MAX_CONTROL_PAYLOAD) {
      throw new ProtocolException("Invalid Control Frame payload length, [" + payloadLength + "] cannot exceed ["+ WebSocketFrame.MAX_CONTROL_PAYLOAD+ "]");
    }
  }
}
