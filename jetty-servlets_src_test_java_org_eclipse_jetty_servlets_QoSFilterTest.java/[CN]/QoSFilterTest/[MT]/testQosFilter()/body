{
  FilterHolder holder=new FilterHolder(QoSFilter2.class);
  holder.setAsyncSupported(true);
  holder.setInitParameter(QoSFilter.MAX_REQUESTS_INIT_PARAM,String.valueOf(MAX_QOS));
  _tester.getContext().getServletHandler().addFilterWithMapping(holder,"/*",EnumSet.of(DispatcherType.REQUEST,DispatcherType.ASYNC));
  for (int i=0; i < NUM_CONNECTIONS; ++i) {
    new Thread(new Worker2(i)).start();
  }
  _doneRequests.await(20,TimeUnit.SECONDS);
  if (TestServlet.__maxSleepers < MAX_QOS)   LOG.warn("TEST WAS NOT PARALLEL ENOUGH!");
 else   Assert.assertEquals(TestServlet.__maxSleepers,MAX_QOS);
}
