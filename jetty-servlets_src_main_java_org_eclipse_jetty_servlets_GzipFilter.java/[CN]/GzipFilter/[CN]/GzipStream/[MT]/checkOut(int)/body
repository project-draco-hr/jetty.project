{
  if (_closed)   throw new IOException("CLOSED");
  if (_out == null) {
    if (_response.isCommitted() || (_contentLength >= 0 && _contentLength < _minGzipSize))     doNotGzip();
 else     if (length > _minGzipSize)     doGzip();
 else     _out=_bOut=new ByteArrayOutputStream2(_bufferSize);
  }
 else   if (_bOut != null) {
    if (_response.isCommitted() || (_contentLength >= 0 && _contentLength < _minGzipSize))     doNotGzip();
 else     if (length >= (_bOut.getBuf().length - _bOut.getCount()))     doGzip();
  }
}
