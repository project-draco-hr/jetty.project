{
  if (_closed) {
    new Throwable().printStackTrace();
    throw new IOException("CLOSED");
  }
  if (_out == null) {
    if (_response.isCommitted() || (_contentLength >= 0 && _contentLength < _minGzipSize))     doNotGzip();
 else     if (length > _minGzipSize)     doGzip();
 else     _out=_bOut=new ByteArrayOutputStream2(_bufferSize);
  }
 else   if (_bOut != null) {
    if (_response.isCommitted() || (_contentLength >= 0 && _contentLength < _minGzipSize))     doNotGzip();
 else     if (length >= (_bOut.size() - _bOut.getCount()))     doGzip();
  }
}
