{
  DeflateFrameExtension ext=new DeflateFrameExtension();
  ext.setBufferPool(new MappedByteBufferPool());
  ext.setPolicy(WebSocketPolicy.newServerPolicy());
  ExtensionConfig config=ExtensionConfig.parse("x-deflate-frame;minLength=8");
  ext.setConfig(config);
  StringBuilder quote=new StringBuilder();
  quote.append("No amount of experimentation can ever prove me right;\n");
  quote.append("a single experiment can prove me wrong.\n");
  quote.append("-- Albert Einstein");
  Assert.assertThat("Small Payload Length",quote.length(),lessThan(0x7E));
  String expected=quote.toString();
  ByteBuffer orig=BufferUtil.toBuffer(expected,StringUtil.__UTF8_CHARSET);
  ByteBuffer compressed=ext.deflate(orig);
  ByteBuffer decompressed=ext.inflate(compressed);
  String actual=BufferUtil.toUTF8String(decompressed);
  Assert.assertEquals(expected,actual);
}
