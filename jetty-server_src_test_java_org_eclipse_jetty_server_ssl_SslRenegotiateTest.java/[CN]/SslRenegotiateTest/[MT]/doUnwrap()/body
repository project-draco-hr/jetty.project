{
  _inPacketB.clear();
  int l=_socket.read(_inPacketB);
  if (l < 0)   throw new IOException("EOF");
  _inPacketB.flip();
  SSLEngineResult result;
  do {
    result=_engine.unwrap(_inPacketB,_inAppB);
  }
 while (result.bytesConsumed() > 0 && _inPacketB.remaining() > 0 && (_engine.getHandshakeStatus() == HandshakeStatus.NEED_UNWRAP || _engine.getHandshakeStatus() == HandshakeStatus.NOT_HANDSHAKING));
}
