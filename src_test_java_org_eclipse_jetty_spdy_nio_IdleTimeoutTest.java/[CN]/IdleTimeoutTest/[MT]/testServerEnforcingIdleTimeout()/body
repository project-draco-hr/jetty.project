{
  server=new Server();
  connector=newSPDYServerConnector(new ServerSessionFrameListener.Adapter(){
    @Override public Stream.FrameListener onSyn(    Stream stream,    SynInfo synInfo){
      stream.reply(new ReplyInfo(true));
      return null;
    }
  }
);
  server.addConnector(connector);
  int maxIdleTime=1000;
  connector.setMaxIdleTime(maxIdleTime);
  server.start();
  final CountDownLatch latch=new CountDownLatch(1);
  Session session=startClient(new InetSocketAddress("localhost",connector.getLocalPort()),new Session.FrameListener.Adapter(){
    @Override public void onGoAway(    Session session,    GoAwayInfo goAwayInfo){
      latch.countDown();
    }
  }
);
  session.syn(SPDY.V2,new SynInfo(true),null);
  Assert.assertTrue(latch.await(2 * maxIdleTime,TimeUnit.MILLISECONDS));
}
