{
  if (!(resource instanceof PathResource))   return false;
  PathResource pathResource=(PathResource)resource;
  try {
    Path path=pathResource.getPath();
    Path alias=pathResource.getAliasPath();
    if (Files.isSymbolicLink(path)) {
      alias=path.getParent().resolve(alias);
      if (LOG.isDebugEnabled()) {
        LOG.debug("path ={}",path);
        LOG.debug("alias={}",alias);
      }
      if (Files.isSameFile(path,alias)) {
        if (LOG.isDebugEnabled())         LOG.debug("Allow symlink {} --> {}",resource,pathResource.getAliasPath());
        return true;
      }
    }
    Path d=path.getRoot();
    for (    Path e : path) {
      d=d.resolve(e);
      while (Files.exists(d) && Files.isSymbolicLink(d)) {
        Path link=Files.readSymbolicLink(d);
        if (!link.isAbsolute())         link=d.resolve(link);
        d=link;
      }
    }
    if (pathResource.getAliasPath().equals(d)) {
      if (LOG.isDebugEnabled())       LOG.debug("Allow path symlink {} --> {}",resource,d);
      return true;
    }
  }
 catch (  Exception e) {
    LOG.ignore(e);
  }
  return false;
}
