{
  super(connector,endp,connector.getServer(),new NestedParser(),new NestedGenerator(connector.getResponseBuffers(),endp,response,nestedIn),new NestedRequest());
  ((NestedRequest)_request).setConnection(this);
  _request.setScheme(request.getScheme());
  _request.setMethod(request.getMethod());
  String uri=request.getQueryString() == null ? request.getRequestURI() : (request.getRequestURI() + "?" + request.getQueryString());
  _request.setUri(new HttpURI(uri));
  _request.setPathInfo(request.getRequestURI());
  _request.setQueryString(request.getQueryString());
  _request.setProtocol(request.getProtocol());
  HttpFields fields=getRequestFields();
  for (Enumeration<String> e=request.getHeaderNames(); e.hasMoreElements(); ) {
    String header=e.nextElement();
    String value=request.getHeader(header);
    fields.add(header,value);
  }
  _request.setCookies(request.getCookies());
}
