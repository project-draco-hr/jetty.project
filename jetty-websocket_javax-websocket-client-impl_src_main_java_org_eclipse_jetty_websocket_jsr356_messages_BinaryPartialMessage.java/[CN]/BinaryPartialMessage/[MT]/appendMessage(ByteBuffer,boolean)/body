{
  if (msgWrapper.isMessageType(ByteBuffer.class)) {
    partialHandler.onMessage(payload.slice(),isLast);
    return;
  }
  if (msgWrapper.isMessageType(byte[].class)) {
    partialHandler.onMessage(BufferUtil.toArray(payload),isLast);
    return;
  }
  StringBuilder err=new StringBuilder();
  err.append(msgWrapper.getHandler().getClass());
  err.append(" does not implement an expected ");
  err.append(MessageHandler.Partial.class.getName());
  err.append(" of type ");
  err.append(ByteBuffer.class.getName());
  err.append(" or byte[]");
  throw new IllegalStateException(err.toString());
}
