{
  File homeDir=MavenTestingUtils.getTestResourceDir("usecases/home");
  File baseDir=testdir.getEmptyDir();
  String cmdLine[]=new String[]{"jetty.version=TEST"};
  CommandLineConfigSource cmdLineSource=new CommandLineConfigSource(cmdLine);
  ConfigSources config=new ConfigSources();
  config.add(cmdLineSource);
  config.add(new JettyHomeConfigSource(homeDir.toPath()));
  config.add(new JettyBaseConfigSource(baseDir.toPath()));
  BaseHome basehome=new BaseHome(config);
  StartArgs args=new StartArgs();
  args.parse(config);
  Modules modules=new Modules();
  modules.registerAll(basehome,args);
  List<String> moduleNames=new ArrayList<>();
  for (  Module mod : modules) {
    if (mod.getName().equals("npn-boot")) {
      continue;
    }
    moduleNames.add(mod.getName());
  }
  String expected[]={"jmx","client","stats","spdy","deploy","debug","security","npn","ext","websocket","rewrite","ipaccess","xinetd","proxy","webapp","jndi","lowresources","https","plus","requestlog","jsp","monitor","xml","servlet","jaas","http","base","server","annotations"};
  Assert.assertThat("Module count: " + moduleNames,moduleNames.size(),is(expected.length));
}
