{
  File homeDir=MavenTestingUtils.getTestResourceDir("usecases/home");
  File baseDir=testdir.getEmptyDir();
  String cmdLine[]=new String[]{"jetty.version=TEST","java.version=1.7.0_60"};
  CommandLineConfigSource cmdLineSource=new CommandLineConfigSource(cmdLine);
  ConfigSources config=new ConfigSources();
  config.add(cmdLineSource);
  config.add(new JettyHomeConfigSource(homeDir.toPath()));
  config.add(new JettyBaseConfigSource(baseDir.toPath()));
  BaseHome basehome=new BaseHome(config);
  StartArgs args=new StartArgs();
  args.parse(config);
  Modules modules=new Modules(basehome,args);
  modules.registerAll();
  modules.enable("[sj]{1}.*",TEST_SOURCE);
  modules.buildGraph();
  List<String> expected=new ArrayList<>();
  expected.add("jmx");
  expected.add("stats");
  expected.add("spdy");
  expected.add("security");
  expected.add("jndi");
  expected.add("jsp");
  expected.add("servlet");
  expected.add("jaas");
  expected.add("server");
  expected.add("base");
  expected.add("ssl");
  expected.add("protonego");
  expected.add("protonego-boot");
  expected.add("protonego-impl");
  expected.add("xml");
  expected.add("jsp-impl");
  List<String> resolved=new ArrayList<>();
  for (  Module module : modules.resolveEnabled()) {
    resolved.add(module.getName());
  }
  ConfigurationAssert.assertContainsUnordered("Enabled Modules",expected,resolved);
}
