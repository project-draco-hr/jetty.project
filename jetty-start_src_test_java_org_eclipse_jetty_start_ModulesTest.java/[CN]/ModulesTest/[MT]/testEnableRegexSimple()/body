{
  File homeDir=MavenTestingUtils.getTestResourceDir("dist-home");
  File baseDir=testdir.getEmptyPathDir().toFile();
  String cmdLine[]=new String[]{"jetty.version=TEST","java.version=1.8.0_31"};
  CommandLineConfigSource cmdLineSource=new CommandLineConfigSource(cmdLine);
  ConfigSources config=new ConfigSources();
  config.add(cmdLineSource);
  config.add(new JettyHomeConfigSource(homeDir.toPath()));
  config.add(new JettyBaseConfigSource(baseDir.toPath()));
  BaseHome basehome=new BaseHome(config);
  StartArgs args=new StartArgs();
  args.parse(config);
  Modules modules=new Modules(basehome,args);
  modules.registerAll();
  Predicate sjPredicate=new RegexNamePredicate("[sj]{1}.*");
  modules.selectNode(sjPredicate,new Selection(TEST_SOURCE));
  modules.buildGraph();
  List<String> expected=new ArrayList<>();
  expected.add("jmx");
  expected.add("stats");
  expected.add("security");
  expected.add("jndi");
  expected.add("jsp");
  expected.add("servlet");
  expected.add("servlets");
  expected.add("jaas");
  expected.add("server");
  expected.add("setuid");
  expected.add("spring");
  expected.add("jaspi");
  expected.add("jminix");
  expected.add("jolokia");
  expected.add("jamon");
  expected.add("jstl");
  expected.add("jmx-remote");
  expected.add("jvm");
  expected.add("ssl");
  expected.add("apache-jsp");
  expected.add("apache-jstl");
  expected.add("webapp");
  expected.add("deploy");
  expected.add("plus");
  expected.add("annotations");
  expected.add("jdbc-sessions");
  List<String> resolved=new ArrayList<>();
  for (  Module module : modules.getSelected()) {
    resolved.add(module.getName());
  }
  ConfigurationAssert.assertContainsUnordered("Enabled Modules",expected,resolved);
}
