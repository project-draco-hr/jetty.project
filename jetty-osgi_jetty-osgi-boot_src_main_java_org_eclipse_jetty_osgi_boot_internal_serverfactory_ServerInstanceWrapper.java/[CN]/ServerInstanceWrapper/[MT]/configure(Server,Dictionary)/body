{
  String jettyConfigurationUrls=(String)props.get(OSGiServerConstants.MANAGED_JETTY_XML_CONFIG_URLS);
  List<URL> jettyConfigurations=jettyConfigurationUrls != null ? extractResources(jettyConfigurationUrls) : null;
  if (jettyConfigurations == null || jettyConfigurations.isEmpty()) {
    return;
  }
  Map<String,Object> id_map=new HashMap<String,Object>();
  id_map.put("Server",server);
  Map<String,String> properties=new HashMap<String,String>();
  Enumeration<Object> en=props.keys();
  while (en.hasMoreElements()) {
    Object key=en.nextElement();
    Object value=props.get(key);
    properties.put(String.valueOf(key),String.valueOf(value));
  }
  for (  URL jettyConfiguration : jettyConfigurations) {
    InputStream is=null;
    try {
      is=jettyConfiguration.openStream();
      XmlConfiguration config=new XmlConfiguration(is);
      config.getIdMap().putAll(id_map);
      String urlPath=jettyConfiguration.toString();
      int lastSlash=urlPath.lastIndexOf('/');
      if (lastSlash > 4) {
        urlPath=urlPath.substring(0,lastSlash);
        Map<String,String> properties2=new HashMap<String,String>(properties);
        properties2.put(PROPERTY_THIS_JETTY_XML_FOLDER_URL,urlPath);
        config.getProperties().putAll(properties2);
      }
 else {
        config.getProperties().putAll(properties);
      }
      config.configure();
      id_map=config.getIdMap();
    }
 catch (    SAXParseException saxparse) {
      __logger.warn("Unable to configure the jetty/etc file " + jettyConfiguration,saxparse);
      throw saxparse;
    }
 finally {
      IO.close(is);
    }
  }
}
