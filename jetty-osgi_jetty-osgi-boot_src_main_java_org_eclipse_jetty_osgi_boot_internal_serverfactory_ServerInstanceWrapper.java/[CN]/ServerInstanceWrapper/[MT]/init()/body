{
  _ctxtHandler=(ContextHandlerCollection)_server.getChildHandlerByClass(ContextHandlerCollection.class);
  List<DeploymentManager> deployers=_server.getBeans(DeploymentManager.class);
  if (deployers != null && !deployers.isEmpty()) {
    _deploymentManager=deployers.get(0);
    for (    AppProvider provider : _deploymentManager.getAppProviders()) {
      if (provider instanceof BundleWebAppProvider) {
        _provider=(BundleWebAppProvider)provider;
        break;
      }
    }
    if (_provider == null) {
      try {
        _provider=new BundleWebAppProvider(this);
        System.err.println("ADDED NEW BUNDLE WEBAPP PROVIDER");
      }
 catch (      Exception e) {
        LOG.warn(e);
      }
      _deploymentManager.addAppProvider(_provider);
    }
  }
  if (_ctxtHandler == null || _provider == null)   throw new IllegalStateException("ERROR: No ContextHandlerCollection or OSGiAppProvider configured");
}
