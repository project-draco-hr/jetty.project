{
  if (eof) {
    return -1;
  }
  if ((remainingBuffer != null) && (remainingBuffer.remaining() > 0)) {
    return BufferUtil.put(remainingBuffer,buf);
  }
  int len=-1;
  int b;
  while (buf.remaining() > 0) {
    b=in.read();
    if (b == (-1)) {
      eof=true;
      break;
    }
    buf.put((byte)b);
    len++;
  }
  return len;
}
