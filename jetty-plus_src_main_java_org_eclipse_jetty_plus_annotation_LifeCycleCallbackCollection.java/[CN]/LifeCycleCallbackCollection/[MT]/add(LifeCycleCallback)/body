{
  if ((callback == null) || (callback.getTargetClass() == null) || (callback.getTarget() == null))   return;
  if (Log.isDebugEnabled())   Log.debug("Adding callback for class=" + callback.getTargetClass() + " on "+ callback.getTarget());
  Map map=null;
  if (callback instanceof PreDestroyCallback)   map=preDestroyCallbacksMap;
  if (callback instanceof PostConstructCallback)   map=postConstructCallbacksMap;
  if (map == null)   throw new IllegalArgumentException("Unsupported lifecycle callback type: " + callback);
  List callbacks=(List)map.get(callback.getTargetClass());
  if (callbacks == null) {
    callbacks=new ArrayList();
    map.put(callback.getTargetClass(),callbacks);
  }
  if (!callbacks.contains(callback))   callbacks.add(callback);
}
