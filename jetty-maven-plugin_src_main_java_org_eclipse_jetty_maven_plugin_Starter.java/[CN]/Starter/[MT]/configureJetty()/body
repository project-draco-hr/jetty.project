{
  LOG.debug("Starting Jetty Server ...");
  applyJettyXml();
  Connector[] connectors=this.server.getConnectors();
  if (connectors == null || connectors.length == 0) {
    MavenServerConnector httpConnector=new MavenServerConnector();
    httpConnector.setServer(this.server);
    String tmp=System.getProperty(PORT_SYSPROPERTY,MavenServerConnector.DEFAULT_PORT_STR);
    httpConnector.setPort(Integer.parseInt(tmp.trim()));
    connectors=new Connector[]{httpConnector};
    this.server.setConnectors(connectors);
  }
  HandlerCollection handlers=(HandlerCollection)server.getChildHandlerByClass(HandlerCollection.class);
  if (handlers == null) {
    handlers=new HandlerCollection();
    server.setHandler(handlers);
  }
  this.server.configureHandlers();
  webApp=new JettyWebAppContext();
  configureWebApp();
  if (webApp.getTempDirectory() != null) {
    File qs=new File(webApp.getTempDirectory(),"quickstart-web.xml");
    if (qs.exists() && qs.isFile())     webApp.setQuickStartWebDescriptor(Resource.newResource(qs));
  }
  if (contextXml != null) {
    XmlConfiguration xmlConfiguration=new XmlConfiguration(Resource.toURL(contextXml));
    xmlConfiguration.getIdMap().put("Server",server);
    xmlConfiguration.configure(webApp);
  }
  this.server.addWebApplication(webApp);
  System.err.println("STOP PORT=" + stopPort + ", STOP KEY="+ stopKey);
  if (stopPort > 0 && stopKey != null) {
    ShutdownMonitor monitor=ShutdownMonitor.getInstance();
    monitor.setPort(stopPort);
    monitor.setKey(stopKey);
    monitor.setExitVm(true);
  }
}
