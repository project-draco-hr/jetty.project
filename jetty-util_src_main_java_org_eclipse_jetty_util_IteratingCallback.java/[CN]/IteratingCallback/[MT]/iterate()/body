{
  loop:   while (true) {
    State state=_state.get();
switch (state) {
case PENDING:
case CALLED:
      break loop;
case IDLE:
    if (!_state.compareAndSet(State.IDLE,State.PROCESSING))     continue;
  processing();
break loop;
case PROCESSING:
if (!_state.compareAndSet(State.PROCESSING,State.LOCKED)) continue;
_iterate=true;
_state.set(State.PROCESSING);
break loop;
case LOCKED:
Thread.yield();
continue;
default :
throw new IllegalStateException("state=" + state);
}
}
}
