{
  while (true) {
    State current=_state.get();
switch (current) {
case SUCCEEDED:
case FAILED:
      return;
default :
    if (_state.compareAndSet(current,State.FAILED)) {
      onCompleteFailure(x);
      return;
    }
}
}
}
