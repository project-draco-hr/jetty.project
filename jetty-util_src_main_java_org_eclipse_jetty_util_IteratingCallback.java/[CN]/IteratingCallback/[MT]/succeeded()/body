{
  while (true) {
    State current=_state.get();
switch (current) {
case ITERATE_AGAIN:
case ITERATING:
{
        if (_state.compareAndSet(current,State.INACTIVE))         return;
        continue;
      }
case SCHEDULED:
{
      if (_state.compareAndSet(current,State.INACTIVE))       continue;
      continue;
    }
case INACTIVE:
{
    iterate();
    return;
  }
default :
{
  throw new IllegalStateException(toString());
}
}
}
}
