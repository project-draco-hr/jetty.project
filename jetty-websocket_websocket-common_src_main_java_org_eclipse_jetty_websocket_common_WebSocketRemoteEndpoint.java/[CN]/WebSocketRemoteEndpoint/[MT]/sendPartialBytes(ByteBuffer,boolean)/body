{
  boolean first=lockPartialMsg(MsgType.TEXT);
  try {
    if (LOG.isDebugEnabled()) {
      LOG.debug("sendPartialBytes({}, {})",BufferUtil.toDetailString(fragment),isLast);
    }
    DataFrame frame=first ? new BinaryFrame() : new ContinuationFrame();
    frame.setPayload(fragment);
    frame.setFin(isLast);
    blockingWrite(frame);
  }
  finally {
    if (isLast)     unlockMsg();
 else     unlockPartialMsg();
  }
}
