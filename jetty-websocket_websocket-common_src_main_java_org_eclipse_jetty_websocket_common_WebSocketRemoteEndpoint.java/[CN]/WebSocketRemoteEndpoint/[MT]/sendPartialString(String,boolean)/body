{
  boolean first=lockPartialMsg(MsgType.BINARY);
  try {
    if (LOG.isDebugEnabled()) {
      LOG.debug("sendPartialString({}, {})",fragment,isLast);
    }
    DataFrame frame=first ? new TextFrame() : new ContinuationFrame();
    frame.setPayload(BufferUtil.toBuffer(fragment,StandardCharsets.UTF_8));
    frame.setFin(isLast);
    blockingWrite(frame);
  }
  finally {
    if (isLast)     unlockMsg();
 else     unlockPartialMsg();
  }
}
