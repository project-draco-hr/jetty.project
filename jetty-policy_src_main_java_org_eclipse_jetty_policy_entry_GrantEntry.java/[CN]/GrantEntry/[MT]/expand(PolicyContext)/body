{
  if (signers != null) {
    signerArray=resolveToCertificates(context.getKeystore(),signers);
  }
  codebase=context.evaluate(codebase);
  if (principalNodes != null) {
    Set<Principal> principalSet=new HashSet<Principal>();
    for (Iterator<PrincipalEntry> i=principalNodes.iterator(); i.hasNext(); ) {
      PrincipalEntry node=i.next();
      node.expand(context);
      principalSet.add(node.toPrincipal(context));
    }
    principals=principalSet.toArray(new Principal[principalSet.size()]);
  }
  context.setPrincipals(principals);
  permissions=new Permissions();
  for (Iterator<PermissionEntry> i=permissionNodes.iterator(); i.hasNext(); ) {
    PermissionEntry node=i.next();
    node.expand(context);
    permissions.add(node.toPermission());
  }
  context.setPrincipals(null);
  setExpanded(true);
}
