{
  Request request=(Request)req;
  if (request.getDispatcherType() == DispatcherType.ASYNC) {
    response.getOutputStream().print("Dispatched back to AsyncDispatchingServlet");
  }
 else {
    final AsyncContext asyncContext;
    if (request.getParameter("dispatchRequestResponse") != null) {
      asyncContext=request.startAsync(request,response);
    }
 else {
      asyncContext=request.startAsync();
    }
    new Thread(new DispatchingRunnable(asyncContext)).start();
  }
}
