{
  List<String> protocols=_protocols;
  if (protocols == null || protocols.size() == 0) {
    protocols=connector.getProtocols();
    for (Iterator<String> i=protocols.iterator(); i.hasNext(); ) {
      String protocol=i.next();
      if (protocol.startsWith("SSL-") || protocol.equals("NPN"))       i.remove();
    }
  }
  String dft=_defaultProtocol;
  if (dft == null)   dft=_protocols.get(0);
  return configure(new NextProtoNegoServerConnection((DecryptedEndPoint)endPoint,connector,protocols,_defaultProtocol),connector,endPoint);
}
