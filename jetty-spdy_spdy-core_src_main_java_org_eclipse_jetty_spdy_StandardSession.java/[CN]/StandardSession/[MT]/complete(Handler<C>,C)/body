{
  if (handler != null) {
    Integer invocations=handlerInvocations.get();
    if (invocations >= 4) {
      execute(new Runnable(){
        @Override public void run(){
          notifyHandlerCompleted(handler,context);
          flush();
        }
      }
);
    }
 else {
      handlerInvocations.set(invocations + 1);
      try {
        notifyHandlerCompleted(handler,context);
        flush();
      }
  finally {
        handlerInvocations.set(invocations);
      }
    }
  }
}
