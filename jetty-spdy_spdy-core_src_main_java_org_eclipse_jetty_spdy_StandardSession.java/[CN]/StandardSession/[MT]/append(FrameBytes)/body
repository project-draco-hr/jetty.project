{
  boolean fail;
synchronized (queue) {
    fail=failed;
    if (!fail) {
      int index=queue.size();
      while (index > 0) {
        FrameBytes element=queue.get(index - 1);
        if (element.compareTo(frameBytes) >= 0)         break;
        --index;
      }
      queue.add(index,frameBytes);
    }
  }
  if (fail)   frameBytes.fail(new SPDYException("Session failed"));
}
