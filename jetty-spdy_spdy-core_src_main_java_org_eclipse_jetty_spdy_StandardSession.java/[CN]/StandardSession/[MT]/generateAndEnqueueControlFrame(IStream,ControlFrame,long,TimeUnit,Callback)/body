{
  try {
synchronized (this) {
      ByteBuffer buffer=generator.control(frame);
      LOG.debug("Queuing {} on {}",frame,stream);
      ControlFrameBytes frameBytes=new ControlFrameBytes(stream,callback,frame,buffer);
      if (timeout > 0)       frameBytes.task=scheduler.schedule(frameBytes,timeout,unit);
      if (ControlFrameType.PING == frame.getType())       flusher.prepend(frameBytes);
 else       flusher.append(frameBytes);
    }
  }
 catch (  Exception x) {
    notifyCallbackFailed(callback,x);
  }
}
