{
  bufferPool.release(buffer);
  IStream stream=getStream();
  boolean flowControlEnabled=StandardSession.this.flowControlEnabled;
  if (flowControlEnabled)   stream.updateWindowSize(-size);
  if (dataInfo.available() > 0) {
    prepend(this);
    if (!flowControlEnabled)     flush();
  }
 else {
    super.complete();
    stream.updateCloseState(dataInfo.isClose(),true);
    if (stream.isClosed())     removeStream(stream);
  }
}
