{
  if (lastStreamId < 0)   throw new IllegalArgumentException("Invalid last stream id: " + lastStreamId);
  ByteBufferPool.Lease lease=new ByteBufferPool.Lease(byteBufferPool);
  int length=4 + 4 + (payload != null ? payload.length : 0);
  ByteBuffer header=generateHeader(FrameType.GO_AWAY,length,0,0);
  header.putInt(lastStreamId);
  header.putInt(error);
  if (payload != null) {
    header.put(payload);
  }
  BufferUtil.flipToFlush(header,0);
  lease.append(header,true);
  return lease;
}
