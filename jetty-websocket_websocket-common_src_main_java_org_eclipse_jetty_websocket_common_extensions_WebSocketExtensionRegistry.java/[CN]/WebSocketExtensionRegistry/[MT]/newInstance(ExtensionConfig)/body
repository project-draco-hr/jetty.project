{
  if (config == null) {
    return null;
  }
  String name=config.getName();
  if (StringUtil.isBlank(name)) {
    return null;
  }
  Extension registeredExt=getExtension(name);
  if (registeredExt == null) {
    return null;
  }
  Class<? extends Extension> extClass=registeredExt.getClass();
  try {
    Extension ext=extClass.newInstance();
    if (ext instanceof AbstractExtension) {
      AbstractExtension aext=(AbstractExtension)ext;
      aext.setConfig(config);
      aext.setPolicy(policy);
      aext.setBufferPool(bufferPool);
    }
    return ext;
  }
 catch (  InstantiationException|IllegalAccessException e) {
    throw new WebSocketException("Cannot instantiate extension: " + extClass,e);
  }
}
