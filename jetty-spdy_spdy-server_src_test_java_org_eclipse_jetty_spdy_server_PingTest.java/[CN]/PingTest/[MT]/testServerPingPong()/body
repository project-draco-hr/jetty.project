{
  final CountDownLatch pingLatch=new CountDownLatch(1);
  ServerSessionFrameListener serverSessionFrameListener=new ServerSessionFrameListener.Adapter(){
    public volatile int pingId;
    @Override public void onConnect(    Session session){
      session.ping(new PingInfo(),new Promise.Adapter<PingResultInfo>(){
        @Override public void succeeded(        PingResultInfo pingInfo){
          pingId=pingInfo.getPingId();
        }
      }
);
    }
    @Override public void onPing(    Session session,    PingResultInfo pingInfo){
      Assert.assertEquals(0,pingInfo.getPingId() % 2);
      Assert.assertEquals(pingId,pingInfo.getPingId());
      pingLatch.countDown();
    }
  }
;
  startClient(startServer(serverSessionFrameListener),null);
  Assert.assertTrue(pingLatch.await(5,TimeUnit.SECONDS));
}
