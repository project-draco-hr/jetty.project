{
  final AtomicReference<PingResultInfo> ref=new AtomicReference<>();
  final CountDownLatch latch=new CountDownLatch(1);
  SessionFrameListener clientSessionFrameListener=new SessionFrameListener.Adapter(){
    @Override public void onPing(    Session session,    PingResultInfo pingInfo){
      ref.set(pingInfo);
      latch.countDown();
    }
  }
;
  Session session=startClient(startServer(null),clientSessionFrameListener);
  PingResultInfo pingResultInfo=session.ping(new PingInfo(5,TimeUnit.SECONDS));
  Assert.assertEquals(1,pingResultInfo.getPingId() % 2);
  Assert.assertTrue(latch.await(5,TimeUnit.SECONDS));
  PingResultInfo pongInfo=ref.get();
  Assert.assertNotNull(pongInfo);
  Assert.assertEquals(pingResultInfo.getPingId(),pongInfo.getPingId());
}
