{
  String usageResource="org/eclipse/jetty/start/usage.txt";
  InputStream usageStream=getClass().getClassLoader().getResourceAsStream(usageResource);
  if (usageStream == null) {
    System.err.println("ERROR: detailed usage resource unavailable");
    usageExit(EXIT_USAGE);
  }
  BufferedReader buf=null;
  try {
    buf=new BufferedReader(new InputStreamReader(usageStream));
    String line;
    while ((line=buf.readLine()) != null) {
      if (line.endsWith("@") && line.indexOf('@') != line.lastIndexOf('@')) {
        String indent=line.substring(0,line.indexOf("@"));
        String info=line.substring(line.indexOf('@'),line.lastIndexOf('@'));
        if (info.equals("@OPTIONS")) {
          List<String> sortedOptions=new ArrayList<String>();
          sortedOptions.addAll(_config.getSectionIds());
          Collections.sort(sortedOptions);
          for (          String option : sortedOptions) {
            if ("*".equals(option) || option.trim().length() == 0)             continue;
            System.out.print(indent);
            System.out.println(option);
          }
        }
 else         if (info.equals("@CONFIGS")) {
          FileFilter filter=new FileFilter(){
            public boolean accept(            File path){
              if (!path.isFile()) {
                return false;
              }
              String name=path.getName().toLowerCase(Locale.ENGLISH);
              return (name.startsWith("jetty") && name.endsWith(".xml"));
            }
          }
;
          File etc=new File(_config.getJettyHome(),"etc");
          if (!etc.exists() || !etc.isDirectory()) {
            System.out.print(indent);
            System.out.println("Unable to find/list " + etc);
            continue;
          }
          List<File> configFiles=new ArrayList<File>();
          File[] configs=etc.listFiles(filter);
          configFiles.addAll(Arrays.asList(configs));
          if (!_config.getJettyHome().equals(_config.getJettyBase())) {
            etc=new File(_config.getJettyBase(),"etc");
            if (etc.exists() && etc.isDirectory()) {
              configs=etc.listFiles(filter);
              configFiles.addAll(Arrays.asList(configs));
            }
          }
          Collections.sort(configFiles);
          for (          File configFile : configFiles)           System.out.printf("%s%s%n",indent,path(configFile));
        }
 else         if (info.equals("@STARTINI")) {
          for (          File file : _iniFiles) {
            String path=path(file);
            System.out.printf("%s%s:%n",indent,path);
            try (FileReader reader=new FileReader(file);BufferedReader in=new BufferedReader(reader)){
              String arg;
              while ((arg=in.readLine()) != null) {
                arg=arg.trim();
                if (arg.length() == 0 || arg.startsWith("#"))                 continue;
                System.out.printf("%s  %s%n",indent,arg);
              }
            }
           }
        }
      }
 else {
        System.out.println(line);
      }
    }
  }
 catch (  IOException e) {
    usageExit(e,EXIT_USAGE);
  }
 finally {
    close(buf);
  }
  System.exit(EXIT_USAGE);
}
