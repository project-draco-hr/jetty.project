{
  try {
    ByteBuffer byteBuffer=dataInfo.asByteBuffer(false);
    Buffer buffer=byteBuffer.isDirect() ? new DirectNIOBuffer(byteBuffer,false) : new IndirectNIOBuffer(byteBuffer,false);
    generator.addContent(buffer,dataInfo.isClose());
    generator.flush(unit.toMillis(timeout));
    if (dataInfo.isClose())     complete();
    handler.completed(null);
  }
 catch (  IOException x) {
    handler.failed(null,x);
  }
}
