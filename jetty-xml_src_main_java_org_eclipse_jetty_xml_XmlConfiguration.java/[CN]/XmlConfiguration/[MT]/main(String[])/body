{
  AccessController.doPrivileged(new PrivilegedAction(){
    public Object run(){
      try {
        Properties properties=null;
        try {
          Class<?> config=XmlConfiguration.class.getClassLoader().loadClass("org.eclipse.jetty.start.Config");
          properties=(Properties)config.getMethod("getProperties").invoke(null);
          Log.debug("org.eclipse.jetty.start.Config properties = {}",properties);
        }
 catch (        NoClassDefFoundError e) {
          Log.ignore(e);
        }
catch (        ClassNotFoundException e) {
          Log.ignore(e);
        }
catch (        Exception e) {
          Log.warn(e);
        }
        if (properties == null)         properties=new Properties();
        XmlConfiguration last=null;
        Object[] obj=new Object[args.length];
        for (int i=0; i < args.length; i++) {
          if (args[i].toLowerCase().endsWith(".properties")) {
            properties.load(Resource.newResource(args[i]).getInputStream());
          }
 else {
            XmlConfiguration configuration=new XmlConfiguration(Resource.newResource(args[i]).getURL());
            if (last != null)             configuration.getIdMap().putAll(last.getIdMap());
            if (properties.size() > 0) {
              Map<String,String> props=new HashMap<String,String>();
              for (              Object key : properties.keySet())               props.put(key.toString(),String.valueOf(properties.get(key)));
              configuration.setProperties(props);
            }
            obj[i]=configuration.configure();
            last=configuration;
          }
        }
        for (int i=0; i < args.length; i++) {
          if (obj[i] instanceof LifeCycle) {
            LifeCycle lc=(LifeCycle)obj[i];
            if (!lc.isRunning())             lc.start();
          }
        }
      }
 catch (      AccessControlException ace) {
        ace.printStackTrace(System.err);
      }
catch (      Exception e) {
        Log.warn(Log.EXCEPTION,e);
      }
      return null;
    }
  }
);
}
