{
  _connection=connection;
  _te=te;
  hb.setVersion(version);
  hb.setResponse(_code,reason);
  hb.setHead(_head);
  if (_contentType != null)   fields.put(new ByteArrayBuffer("Content-Type"),new ByteArrayBuffer(_contentType));
  if (_contentLength != null)   fields.put(new ByteArrayBuffer("Content-Length"),new ByteArrayBuffer(_contentLength));
  if (_connection != null)   fields.put(new ByteArrayBuffer("Connection"),new ByteArrayBuffer(_connection));
  if (_te != null)   fields.put(new ByteArrayBuffer("Transfer-Encoding"),new ByteArrayBuffer(_te));
  if (_other != null)   fields.put(new ByteArrayBuffer("Other"),new ByteArrayBuffer(_other));
  if (_body != null) {
    int inc=1 + _body.length() / chunks;
    ByteBuffer buf=new ByteArrayBuffer(_body);
    View view=new View(buf);
    for (int i=1; i < chunks; i++) {
      view.setPutIndex(i * inc);
      view.setGetIndex((i - 1) * inc);
      hb.addContent(view,Generator.MORE);
      if (hb.isBufferFull() && hb.isState(AbstractGenerator.STATE_HEADER))       hb.completeHeader(fields,Generator.MORE);
      if (i % 2 == 0) {
        if (hb.isState(AbstractGenerator.STATE_HEADER))         hb.completeHeader(fields,Generator.MORE);
        hb.flushBuffer();
      }
    }
    view.setPutIndex(buf.putIndex());
    view.setGetIndex((chunks - 1) * inc);
    hb.addContent(view,Generator.LAST);
    if (hb.isState(AbstractGenerator.STATE_HEADER))     hb.completeHeader(fields,Generator.LAST);
  }
 else {
    hb.completeHeader(fields,Generator.LAST);
  }
  hb.complete();
  while (!hb.isComplete())   hb.flushBuffer();
}
