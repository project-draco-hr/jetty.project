{
  ExecutorService threadPool=Executors.newCachedThreadPool();
  BlockheadClient client=new BlockheadClient(server.getServerUri());
  try {
    client.connect();
    client.sendStandardRequest();
    client.expectUpgradeResponse();
    int iterations=10000;
    LoadSocket.count.set(0);
    threadPool.execute(new TextGen(client,iterations));
    client.readFrames(iterations,TimeUnit.SECONDS,40);
  }
  finally {
    client.close(StatusCode.NORMAL,"All Done");
  }
}
