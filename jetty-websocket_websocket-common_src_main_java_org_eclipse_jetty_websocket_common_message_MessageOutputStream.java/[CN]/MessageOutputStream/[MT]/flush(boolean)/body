{
  BufferUtil.flipToFlush(buffer,0);
  LOG.debug("flush({}): {}",fin,BufferUtil.toDetailString(buffer));
  frame.setPayload(buffer);
  frame.setFin(fin);
  try {
    outgoing.outgoingFrame(frame,blocker,OutgoingFrames.FlushMode.SEND);
    blocker.block();
    frameCount++;
    frame.setIsContinuation();
    BufferUtil.flipToFill(buffer);
  }
 catch (  IOException e) {
    notifyFailure(e);
    throw e;
  }
}
